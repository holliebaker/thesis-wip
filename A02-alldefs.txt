# All results {-}

::: { .definition #semialgebraic-set }
The semialgebraic subsets of $\R^n$ are the smallest class ${SA}_n$ of subsets of $\R^n$ satisfying the following properties.

1. If $f \in \R[x_1,\ldots,x_n]$, then $\{ \mathbf{x} \in \R^n \mid f(\mathbf{x}) = 0 \}$ and $\{ \mathbf{x} \in \R^n \mid f(\mathbf{x}) > 0 \}$ are elements of ${SA}_n$.
1. If $A, B \in {SA}_n$, then $A \cup B$, $A \cap B$ and $\R^n \setminus A$ are elements of ${SA}_n$.
:::

::: {.definition #graph-def-map }
Let $X \subset \R^n$ and $Y \subset \R^m$ be definable sets. 
Let $f : X \to Y$ be a mapping from $X$ to $Y$. The graph of $f$ is the definable set
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}.
$$
Sometimes, the domain of $f$ is $\R^n$. In this case, we often use the restriction $f\vert_X$ so that only images of $f$ at points in $X$ are considered,
The graph of $f$ on $X$ may be denoted by $f(X)$. 
:::

::: {.definition}
Let $X \subset \R^n$ and $Y \subset \R^m$. A mapping $f : X \to Y$ is called semialgebraic if its graph (see Definition \@ref(def:graph-def-map))
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}
$$
is a semialgebraic set.
:::

::: { .definition #qff }
A quantifier-free Boolean formula is obtained by the following rules:

1. If $f \in \R[x_1\ldots,x_n]$ then $f=0$ and $f>0$ are quantifier-free Boolean formulas,
2. if $F$ and $G$ are quantifier-free Boolean formulas then $F \land G$, $F \lor G$ and $\neg F$ are quantifier-free Boolean formulas.
:::

::: { .definition #first-order-formula }
A first-order Boolean formula is obtained by rules 1 and 2 from Definition \@ref(def:qff) and

3. If $F$ is a first-order Boolean formula and $y$ is a variable ranging over $\R$, then $\exists y\ F$ and $\forall y\ F$ are first-order Boolean formulas.
:::

::: { .theorem #tarski-seinedberg }
[@vdd1988tarski]
Let $S \subset \R^{n+1}$ and $\projop{n} : \R^{n+1} \to \R^n$ be the projection map onto the first $n$ co-ordinates. Then $\projop{n}(S) \subset \R^n$ is a semialgebraic set.
:::

::: { .proposition #bpr-qe }
[@bpr2006, Algorithm 14.21]

Let $y_1 < \ldots < y_k < x_1 < \ldots < x_k$ be an ordered list of variables and $K$ a real closed field. Define a first-order Boolean formula
$$
F := Q_1 (y_1,\ldots,y_{k_1}), Q_2 (y_{k_1 + 1},\ldots,y_{k_1 + k_2}) \ldots Q_\omega (y_{y_1 + \ldots + y_{\omega-1} + 1},\ldots, y_k) G
$$
where $Q_i, 1\le i \le \omega$, is a quantifier $\forall$ or $\exists$, such that $Q_i$ and $Q_{i+1}$ are different and $G$ is a quantifier-free Boolean formula containing $s$ different polynomials of maximum degree $d$ in $K[y_1,\ldots,y_k,x_1,\ldots,x_n]$.
Note that variables $y_1,\ldots,y_k$ are partitioned into $\omega$ "blocks" $Y_1,\ldots,Y_\omega$ such that $Y_i, 1 \le i \le \omega$ contains $k_i$ variables, each of which is bound by the same quantifier $Q_i$.
We say that the formula $F$ contains $\omega$ quantifier alternations.

Let $S \subset \R^n$ be a semialgebraic set defined by $F$. There is a quantifier-free Boolean formula defining $s$ of the form
$$
F' := \lor_{1 \le i \le I} \land_{1 \le j \le J_i} \left( \lor_{1 \le \ell \le L_{i,j}} f_{i,j,\ell}(x_1,\ldots,x_n) \ast_{i,j,\ell} 0 \right)
$$
where each $f_{i,j,n}$ is a polynomial in $K[x_1,\ldots,x_n]$ and $\ast_{i,j,\ell} \in \{<, =, >\}$ determines its sign.
Bounds on this formula are as follows

- $I \le s^{(k_1 + 1)(k_2 + 1) \ldots (k_\omega + 1)(n+1)}d^{O(k_1) O(k_2) \ldots O(k_\omega)}$,
- $J_i \le s^{(k_1 + 1)(k_2 + 1) \ldots (k_\omega + 1)}d^{O(k_1) O(k_2) \ldots O(k_\omega)}$,
- $L_{i,j} \le d^{O(k_1) O(k_2) \ldots O(k_\omega)}$,
- polynomials $f_{i,j,\ell}$ have maximum degree $d^{O(k_1) O(k_2) \ldots O(k_\omega)}$.

There is an algorithm, taking $F$ as input, which computes $F'$ with complexity
$$
s^{(k_1 + 1)(k_2 + 1) \ldots (k_\omega + 1)(n+1)}d^{O(k_1) O(k_2) \ldots O(k_\omega)O(n)}.
$$
:::

::: {.definition #definable-set}
A structure expanding the real closed field $R$ is a collection $$
S := (S^n)_{n \in \N}
$$
where each $S^n$ is a set of subsets of the affine space $R^n$ satisfying the following conditions.

1. All algebraic subsets of $R^n$ are in $S^n$.
2. $S^n$ is a Boolean subalgebra of the powerset of $R^n$.
3. If $A \in S^n$ and $B \in S^m$, then $A \times B \in S^{n+m}$.
4. Let $\proj : R^{n+1} \to R^n$ be the projection onto the first $n$ coordinates. If $X\in R^{n+1}$, then $\proj(X) \in R^n$.

Elements of $S^n$ (satisfying properties 1-4) are called the definable subsets of $R^n$.
If the structure $S$ satisfies properties 1-4 and the following property, it is called an O-minimal structure.


5. The elements of $S^1$ consist of the finite unions of points and open intervals of $R$.


:::

::: {.definition #definable-function}
A map $f : A \to R^m$, where $A \subset R^n$, is called *definable* if its graph $G \subset R^{n+m}$ is a definable set.
:::

::: {.remark}
Since definable sets are closed under projection, it can be easily deduced that $A$ is a definable set.
:::

::: {.remark}
For convenience, we will call a definable map $f : R^n \to R$ a definable function.
:::

::: {.definition}
[@gv04, Definition 2.1]
A Pfaffian chain of order $r \ge 0$ and degree $\alpha \ge 1$ in an open domain $G \subset \R^n$ is a sequence of analytic functions
$$
f_1, \ldots , f_r
$$
in $G$ satisfying the differential equations
$$
{df}_j(\mathbf{x}) = \sum^n_{i=1} g_{ij}(\mathbf{x}, f_1(\mathbf{x}), \ldots, f_j(\mathbf{x})) dx_i
$$
for $1 \le j \le r$, where $g_{ij}(x_1,\ldots,x_n),y_1,\ldots,y_j)$ are polynomials of degree not greater than $\alpha$.

A function $f(\mathbf{x}) = P(\mathbf{x},f_1(\mathbf{x}),\ldots,f_r(\mathbf{x}))$, where $P(\mathbf{x}, f_1(\mathbf{x}), \ldots, f_r(\mathbf{x}))$ is a polynomial of degree not greater than $\beta \ge 1$ is called a Pfaffian function of order $r$ and degree $(\alpha, \beta)$. Note that $f$ is only defined in the domain $G$, where all functions $f_1,\ldots,f_r$ are analytic, even if $f$ itself can be extended as an analytic function in a larger domain.
:::

::: {.definition}
[@gv04, Definition 2.7]
A set $X \subset \R^n$ is called semi-Pfaffian in an open domain
$G \subset \R^n$ if it consists of points in $G$ satisfying a Boolean combination $F$ of some atomic equations and inequalities $f = 0$, $g > 0$, where $f, g$ are Pfaffian functions having a common Pfaffian chain defined in $G$.

$X$ is called restricted in $G$ if $\cl{X}$ is contained in $G$.

$X$ is called basic if the Boolean combination $F$ is a conjunction.
:::

::: {.definition}
[@gv04, Definition 2.8]
A set $X \subset \R^n$ is called sub-Pfaffian in an open domain $G \subset \R^n$ if
$$
X := \projop{n}(Y),
$$
where $Y \subset \R^m$ is a semi-Pfaffian set and $\R^n$ is a subspace of $\R^m$.
:::

::: {.definition}
[@gv04, 2.9]
Let ${\cal I}^k := [-1,1]^k$ be the closed cube in an open domain $G \subset \R^k$.
$X \subset {\cal I}^n$ is called restricted sub-Pfaffian if $X := \projop{n}(Y)$, where $Y \subset {\cal I}^{n+m}$ is a restricted semi-Pfaffian set.
:::

::: {.definition #pfaff-format}
[@gv04, Definition 2.11]

Consider a semi-Pfaffian set
$$
X := \bigcup_{1 \le i \le M} \{ \mathbf{x} \in \R^s \mid f_{i,1} = 0, \ldots, f_{i,I_i} = 0, g_{i,1} > 0, \ldots, g_{i,J_i} > 0 \} \subset G
$$
where $f_{ij}$ and $g_{ij}$ are Pfaffian functions of order $r$ and degree $(\alpha, \beta)$ defined in an open domain $G$
The format of $X$ is a tuple
$$
(r, N, \alpha, \beta, s)
$$
where $N \ge (I_1 + J_1) + \cdots + (I_M + J_M)$.
:::

::: { .definition #affine-coordinate-subspace }
[@bgv15, Definition 2.1]
Let $L_{j,c} := \{ (x_1,\ldots,x_n) \mid x_j = c \}$ for some $1 \le j \le n$ and $c \in \R$.
Each intersection of the kind
$$
S := L_{j_1,c_1} \cap \ldots \cap L_{j_m,c_m}
$$
where $0 \le j \le m$, $1 \le j_1 < \cdots < j_m \le n$ and $c_1,\ldots,c_m \in \R$ is called an affine coordinate subspace of $\R^n$.
:::

::: { .definition #quasi-affine }
[@bgv15, Definition 2.2]
Let $\mathbf{f} = (f_1,\ldots,f_k) : X \to \R^k$ be a bounded continuous map defined on an open, bounded, non-empty subset $X \subset \R^n$ having the graph $Y \subset \R^{n+k}$.

$\mathbf{f}$ is called quasi-affine if, for any coordinate subspace $L \subset \R^{n+k}$, the restriction $\proj_{L}\vert_Y$ is injective if and only if $\proj_{L}(Y)$ is $n$-dimensional.
:::

::: { .definition #monotone-map }
[@bgv15, Definition 2.3]
Let $\mathbf{f} : X \to \R^k$ be a bounded, continuous, quasi-affne map defined on an open, bounded, non-empty subset $X\subset \R^n$ having the graph $Y \subset \R^{n+k}$. $\mathbf{f}$ is called monotone if, for each affine coordinate subspace $S \subset \R^{n+k}$, the intersection $Y \cap S$ is connected.
:::

::: {.definition}
[@bgv15, Notation 2.4]

Let the space $\R^n$ have coordinate functions $x_1,\ldots,x_n$.
Given a subset
$$
I = \{x_{j_1}, \ldots, x_{j_m} \} \subset \{x_1 ,\ldots, x_n \},
$$ let $W$ be the linear subspace of $\R^n$ where all coordinates in $I$ are equal to zero.
We write $\opspan{x_{j_1},\ldots, x_{j_m}}$ to mean the
quotient space $\R^n / W$.
Similarly, for any aﬃne coordinate subspace $L \subset \R^n$ on which all the
functions $x_j \in I$ are constant, we will identify $L$ with its image under the canonical surjection
to $\R^n / W$. We write $\R^k$, where $k \le n$, to mean $\opspan{x_1, \ldots, x_k }$.
:::

::: { .definition #monotone-map-on }
[@bgv15, Definition 2.10]
Let $X \subset \opspan{x_1,\ldots,x_n}$ be a monotone cell and $\mathbf{f} : X \to \opspan{y_1,\ldots,y_k}$ be a continuous map having graph $Y \subset \opspan{x_1,\ldots,x_n,y_1,\ldots,y_k}$. If $Y$ is a monotone cell, then $\mathbf{f}$ is called monotone on $X$.
:::

::: { .definition #monotone-cell }
[@bgv15, Definition 2.5]
$Y \subset \opspan{x_1,\ldots,x_n}$ is called a monotone cell if it is the graph of a monotone map $\mathbf{f} : X \to H$ where $H \subset \opspan{x_1,\ldots,x_n}$ and $X \subset \opspan{x_1,\ldots,x_n} \setminus H$.
:::

::: { .example #monotone-cells }
1. Observe that any quasi-affine map defined on a connected subset and having the graph in $\R^2$ is also monotone. This quasi-affine map will fail to be monotone if the set it is defined on is not connected.

2. Let $\Delta := \{ 0 < x < 1, y > 0, x + y < 1 \} \subset \R^2$ and $\varphi(x,y) = x^2 + y^2$. Let $Y \subset \R^3$ be the graph of function $\phi$ on $\Delta$. Observe that $\phi\vert_Delta$ is a quasi-affine map. However, $y \cap \{ z = 3/4 \}$ is not connected, hence $\phi\vert_\Delta$ is not a monotone function [@bgv15, Example 4.3].
:::

::: { .proposition #monotone-topologically-regular }
[@bgv13, Theorem 1]
Every monotone cell is a topologically regular cell.
:::

::: { .corollary }
[@bgv13, Corollary 7, Theorem 11]
Let $X \subset \R^n$ be a monotone cell, then

1. $X \cap \{ x_i < c \}$, $X \cap \{ x_i = c \}$ and $X \cap \{ x_i > c \}$, for every $1 \le i \le n$ and $c \in \R$, are either empty or monotone cells.
1. Let $Y \subset X$ be a monotone cell such that $\dim(Y) = \dim(X) - 1$ and $\fr{Y} \subset \fr{X}$. Then $X \setminus Y$ is a disjoint union of two monotone cells.
:::

::: { .proposition }
[@bgv13, Theorem 10]
Let $X \subset \R^n$ be a monotone cell. Then $\proj_{L}(X)$, for any affine coordinate subspace $L \subset \R^n$ is also a monotone cell.
:::

::: { .remark #monotone-proj-basis }
[@bgv15, Remark 2.11]
Let $Y \subset \R^n$ be a monotone cell and $L$ be a coordinate subspace such that $\proj_L\vert_Y$ is injective.
Then $Y$ is the graph of a monotone map defined on $\proj_L(Y)$, by [@bgv13, Theorem 7 and Corollary 5].
:::

::: {.definition #big-o }
[@gv2009, Definition 6.1]
Let $f,g,h : \N^\ell \to \N$ be functions and $n \in \N$.

- The expression $f \le O(g)^n$ means that there exists $c \in \N$ such that $f < (cg)^n$ at every point in $\N^\ell$.
- The expression $f \le g^{O(h)}$ means that there exists a $c \in \N$ such that $f \le g^{ch}$ at every point in $\N^\ell$.
:::

::: { .definition #cells }
Cylindrical cells are defined by induction on $n\ge 1$. Each cylindrical cell $C$ is a connected definable subset of $\R^n$ with an *index*
$$
(i_1,\ldots,i_n) \in \{0,1\}^n.
$$

- When $n = 0$, there is a unique cylindrical cell $\mathbf{0} \in \R^0$.

- When $n = 1$, a $(0)$-cell (section cell) is a point $c \in \R$ and a $(1)$-cell (sector cell) is an open interval: $(a,b)$, $(-\infty,b)$, $(a,\infty)$, $(-\infty,\infty)$ where $a,b\in \R$.

- When $n > 1$, suppose that $(i_1,\ldots,i_{n-1})$-cells are already defined and let $C'$ be one of these cells.
An $(i_1,\ldots,i_{n-1},0)$-cell (section cell) is the graph of a continuous definable function $f : C' \to \R$.
An - $(i_1,\ldots,i_{n-1},1)$-cell (sector cell) is a subset of the cylinder $C' \times \R$, either
  $$
\begin{aligned}
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', f(\mathbf{x}) < t < g(\mathbf{x})\},\\
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', -\infty < t < g(\mathbf{x})\},\\
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', f(\mathbf{x}) < t < \infty\},\\
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', t \in \R \}
\end{aligned}
  $$
  where $f,g : C' \to \R$ are continuous definable functions such that $f(\mathbf{x}) < g(\mathbf{x})$ for all $\mathbf{x} \in C'$.
:::

::: {.definition}
Let $S \subset \R^n$ be a definable subset of $\R^n$ and define the *frontier of $S$*
$$
\fr{S} := \cl{S} \setminus S,
$$
where $\cl{S}$ is the closure of $S$ in the Euclidean topology.
:::

::: {.definition #blow-up-point }
[@bgv15, Definition 9.2]

Let $\varphi : W \to \R$ be a continuous function on a semialgebraic set $W \subset \R^n$, and let $\Phi \subset \R^{n+1}$ be its graph.

A point $\mathbf{x} \in \overline{W} \setminus W$ is called a blow-up point of $\Phi$ if $$\proj^{-1}_{\R^n} (\mathbf{x}) \cap \overline{\Phi}$$ contains an open interval.
:::

::: {.remark #blow-up-codimension }
The closure of the graph of a continuous definable function is the graph of a continuous definable function everywhere
except, possibly, over a subset of codimension at least $2$ (see the proof of @bgv15, Lemma 3.14).
:::

::: { .example #top-bottom-not-cylindrical }
In $\R^3$, let $C' := \{ -1 < x < 1, \vert x \vert < y < 1 \}$ and $\phi(x,y) = \vert x / y \vert$ so that $C$ is the graph of $\phi\vert_{C'}$.
Consider $$
C_B := \{ -1 < x < 1, y = \vert x \vert, z = 1 \} \cup \{ (0,0,z) \mid 0 \le x \le 1 \}.
$$
$C_B$ is not the graph of a continuous function due to the blow-up point of $\phi$ at the origin.
:::

::: {.definition}
A cylindrical decomposition is defined by induction on $n \ge 0$.

- When $n = 0$, the unique cylindrical decomposition of $\R^0$ is the unique point in $\R^0$.

- When $n > 0$: Let $\cal D$ be a partition of $\R^n$ into cylindrical cells.
Define $\cal D'$ to be the set of all projections $C' := \projop{n-1}(C)$ for all $C$ in $\cal D$.
$\cal D$ is a cylindrical decomposition of $\R^n$ if $\cal D'$ is a cylindrical decomposition of $\R^{n-1}$. We call $\cal D'$ the decomposition of $\R^{n-1}$ induced by $\cal D$.
:::

::: {.definition}
Let $S \subset \R^n$ be a definable set. A cylindrical decomposition $\cal D$ is compatible with $S$ if every cell $C$ of $\cal D$ is either a subset of $S$ or disjoint from $S$.
:::

::: {.definition}
A cylindrical decomposition $\cal E$ is called a refinement of $\cal D$ if $\cal E$ is compatible with every cell of $\cal D$. in other words, every cell of $\cal D$ is a union of cells in the refinement $\cal E$.
:::

::: { .remark }
[@bgv15, Remark 3.8]
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cylindrical cell of $\cal D$ such that $c := \projop{1}(C)$ is a single point. Then it follows immediately from the definition that $\cal D$ is compatible with the hyperplane $\{ x_1 = c \}$ and the set of all cells of $\cal D$ contained in this hyperplane form a cylindrical decomposition $\cal E$ of $\R^{n-1}$. Moreover, any refinement of $\cal E$ is also a refinement of $\cal D$.
:::

::: {.definition}
Let $S \subset \R^n$ be a definable set. A cylindrical decomposition $\mathcal{D}$ of $\R^n$, compatible with $S$, is called monotone with respect to $S$ if every cell $C \subset S$ of $\cal D$ is monotone.
:::

::: {.definition #frontier-condition}
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cell of $\cal D$. $C$ satisfies the frontier condition in $\cal D$ is $\fr{C}$ is a union of cells of $\cal D$ of smaller dimension. If it is unambiguous that $C$ is a cell of $\cal D$, then we just say that $C$ satisfies the frontier condition.
If every cell in $\cal D$ satisfies the frontier condition, then the cylindrical decomposition $\cal D$ satisfies the frontier condition.
:::

::: {.example #side-wall}
Consider the two cylindrical cells
$$
V := \{ x > y > 0, z > 0, y = xz \}
$$ and $$
W := \{ x > y > 0, z > 0, y = 2xz \}
$$ in $\R^3$.
Any cylindrical decomposition compatible with $V$ and $W$ is also compatible with the two intervals
$$
I_1 = \{ (0,0,z) \mid 0 \le z \le 1/2 \}, I_2 = \{ (0,0,z) \mid 1/2 \le z \le 1 \}
$$
and the point $$v = (0,0,1/2).$$
Observe that $I = \{ (0,0,z) \mid 0 \le z \le 1 \}$ is the only one-dimensional component of the side-wall of $V$ and $I_1$ is the only one-dimensional component of the side-wall of $W$. In order to obtain the strong frontier condition, we need to partition $V$ into (at least) three cylindrical cells $V',V'',V'''$, one of which, say $V''$, will be one-dimensional. $V''$ should have endpoint $v$ (i.e., $\cl{V''} \cap I = v$).
The tangent at the origin of $c := \projop{2}(V'')$ is $1/2$. The pre-image of the projection map $W' := \projop{2}^-1\vert_{\cl{W}}(c)$ would satisfy the condition $\cl{W'} \cap I = v'$, where $v' = (0,0,1/4)$. However, $v'$ must be a zero-dimensional cell of the decomposition, which means we need to perform another refinement of $I$. An infinite sequence of refinements, introducing a new 0-dimensional cell $(0,0,1/2^k), k \in \N_{> 0}$, will take place. Thus, a decomposition in in which the side-walls of $V$ and $W$ are single 1-dimensional cells cannot exist.
:::

::: { .proposition #delete-zero-index }
[@bgv15, Lemma 3.3]
Let $C$ be an $(i_1,\ldots,i_{k-1},0,i_{k+1},\ldots,i_n)$-cell. Then $C' := \projops{x_1,\ldots,x_{k-1},x_{k+1},\ldots,x_n}(C)$ is a cylindrical $(i_1,\ldots,i_{k-1},i_{k+1},\ldots,i_n)$-cell and $C$ is the graph of a monotone map $f : C' \to \opspan{x_k}$.
:::

::: { .proposition }
[@bgv15, Lemma 3.4]
Let $C \subset \R^n$ be a 2-dimensional cylindrical cell which is the graph of a quasi-affine map. Then the side-wall $W \subset \fr{C}$ has exactly two connected components, each of which is either a point or a closed curve interval.
:::

::: {.remark}
It was proved by @pianomovers1983 that a cylindrical decomposition, compatible with a semialgebraic set and satisfying the frontier condition, can be obtained following a linear rotation of coordinates.
@jhd20 prove that a cylindrical decomposition having constant sign on a set of input polynomials will contain topologically regular cells and satisfy the frontier condition, regardless of the method used to construct it, as long as the input polynomials do not blow up anywhere.
Proposition \@ref(prp:monotone-topologically-regular) (@bgv13, Theorem 1) asserts that every monotone cell is topologically regular, so @bgv15, Theorem 3.20 describes the construction of a CAD, compatible with a family $V_1,\ldots,V_k$ of definable subsets of $\R^n$, each having dimension at most $2$, in the potential presence of blow-up points and without the need to make a change of coordinates.
:::

::: {.remark}
A cylindrical algebraic decomposition (CAD) is a cylindrical decomposition in which every cell is a semialgebraic set. While the results of @bgv15 are proved for the wider class of cylindrical decompositions compatible with definable sets, we will restrict ourselves to CADs, allowing us to take advantage of properties of polynomials.
:::

::: {.definition}
Let $\mathbf{F} := (f_1,\ldots,f_s) \subset \Z[x_1,\ldots,x_n]$ be a set of polynomials with integer coefficients. A cylindrical algebraic decomposition $\cal D$ is called sign-invariant with respect to $\mathbf{F}$  (or simply $\mathbf{F}$-invariant) if each polynomial $f \in \mathbf{F}$ has a constant sign (either $< 0$, $= 0$ or $> 0$) on every cylindrical cell $C$ of $\mathcal{D}$.
:::

::: {.remark}
The fundamental theorem of algebra implies that for the coefficients of $\mathbf{F}$, we may choose any ring $K \subset \R$. $\Z$ has been chosen for convenience, but some authors (e.g., @pianomovers1983) choose $\Q$ instead. It is also common to take polynomials with coefficients over $\R$. However, the choice has been made to avoid this so as to work over the algebraic numbers $\mathcal{A}$, whose elements are easily represented in, and manipulated by, computers.
:::

::: {.proposition #coste-polynomial-to-cell }
[@coste2000, Proposition 2.16]
Let $f \in \Z[x_1,\ldots,x_n]$ and, $C' \subset \R^{n-1}$ be a connected semialgebraic set and $k \le d \in \N$ such that, for every point $\mathbf{x} \in C'$, the univariate polynomial $f(\mathbf{x},x_n) \in \A[x_n]$ has degree $d$ and exactly $k$ distinct (complex) roots in $C'$.
Then there are $\ell \le k$ distinct semialgebraic functions
$$\psi_1,\ldots,\psi_\ell : C' \to \R
$$
such that, for every $\mathbf{x} \in C'$, the set of real roots of $f(\mathbf{x},x_n)$ is exactly
$$\{ \psi_1(\mathbf{x}, \ldots, \psi_\ell(\mathbf{x}) \}.$$
Moreover, the multiplicity of each of these roots is constant.
:::

::: {.proof}
The argument relies on the "continuity of roots":

> Fix $\mathbf{c} \in C'$ and let $z_1,\ldots,z_k$ be the distinct roots of $f(\mathbf{c},x_n)$ with multiplicities $m_1,\ldots,m_k$.
Choose $\varepsilon > 0$ small enough that the open discs $D(z_i,\varepsilon) z_i \in \mathbb{C}$ (center $z_i$, radius $\varepsilon$) are disjoint. If $\mathbf{b} \in C'$ is sufficiently close to $\mathbf{c}$, then the polynomial $f(\mathbf{b}, x_n)$ has exactly $m_i$ roots, counted with multiplicities, in $D(z_i,\varepsilon)$ for $1\le i \le k$.

Since $f(\mathbf{b},x_n)$ has $k$ distinct complex roots, and $d = m_1+ \ldots + m_k$ complex roots counted with multiplicities, it follows that each $D(z_i,\varepsilon)$ contains exactly one root, denoted $\zeta_i$, of $f(\mathbf{b},x_n)$ with multiplicity $m_i$.
If $z_i$ is real, then $\zeta_i$ is real, otherwise the complex conjugate of $\zeta_i$ would be another root of $f(\mathbf{b},x_n)$ in the disc $D(z_i,\varepsilon)$.
If $z_i$ is complex then $\zeta_i$ is also complex, since the conjugation of every point in $D(z_i, \varepsilon)$ lies outside $D(z_i, \varepsilon)$, forming another disc $D(\overline{z_i}, \varepsilon)$.
It follows that, if $\mathbf{b} \in C'$ is close enough to $\mathbf{c}$, then $f(\mathbf{c},x_n)$ has the same number of real roots as $f(\mathbf{b},x_n)$. Since $C'$ is connected, $f(\mathbf{x},x_n)$ has the same number of real roots at every point $\mathbf{x} \in C'$, say $\ell$.
Define $\psi_i(\mathbf{x}) : C' \to \R$ to be the continuous (by making $\varepsilon$ small enough) semialgebraic function sending $\mathbf{x} \in C'$ to the $i$-th (in ascending order) real root of $f(\mathbf{x},x_n)$. It follows from the connectedness of $C'$ that each $\psi_i$ has constant multiplicity.
Observe that the graph of each $\psi_i$ can be expressed by a first-order Boolean formula, using existential quantifiers to express each of the $\ell$ roots of $f(\mathbf{x},x_n)$ and an equality condition to pick out the $i$-th root.
It follows that the graph of each functin $\psi_i$ is a semialgebraic set.
:::

::: {.proposition}
[@coste2000, Proposition 2.18]
Let $f,g \in \Z[x_1,\ldots,x_n]$, $C' \subset \R^{n-1}$ such that, for all $\mathbf{x} \in C'$, the degree and number of roots of $f(\mathbf{x},x_n)$ and $g(\mathbf{x},x_n)$ is constant and the degree of the GCD of $f(\mathbf{x},x_n)$ and $g(\mathbf{x},x_n)$ is constant.
Let $\phi,\psi : C' \to \R$ be continuous semialgebraic functions such that $f(\mathbf{x},\phi(\mathbf{x})) = 0$ and $g(\mathbf{x},\psi(\mathbf{x})) = 0$ for all $\mathbf{x} in C'$.
If there exists $\mathbf{c} \in C'$ such that $\phi(\mathbf{c}) = \psi(\mathbf{c})$, then $\phi(\mathbf{x}) = \psi(\mathbf{x})$ for all $\mathbf{x} \in C'$.
:::

::: {.proof}
We use the same method of proof as in the previous proposition.
For an arbitrary element $\mathbf{c} \in C'$, let $z_1 = \phi(\mathbf{c}) = \psi(\mathbf{c}), \ldots, z_k$ be the distinct roots in $\mathbb{C}$ of the product
$$
f(\mathbf{c},x_n) g(\mathbf{c},x_n)
$$
(recall that $fg = 0$ if either $f=0$ or $g=0$).
Let $m_i$ (resp $p_i$) be the multiplicity of $z_i$ as a root of $f(\mathbf{x},x_n)$ (resp. $g(\mathbf{x}, x_n)$) where multiplicity zero indicates that $z_i$ is not a root.
The degree of $\gcd(f(\mathbf{x}, x_n), g(\mathbf{x}, x_n))$ is $\min(m_1,p_1) + \cdots + \min(m_k,p_k)$ and each $z_i$ has multiplicity $\min(m_i,p_i)$ as a root of this GCD.
Choose $\varepsilon > 0$ small enough that the discs $D(z_i,\varepsilon)$ are disjoint.
For each $\mathbf{b} \in C'$ close enough to $\mathbf{c}$, each disc contains a root of multiplicity $m_i$ of $f(\mathbf{b}, x_n)$ and a root of multiplicity $p_i$ of $g(\mathbf{b}, x_n)$. Since the degree of the GCD of $f$ and $g$ (evaluated at any $\mathbf{x} \in C'$) is equal to $\min(m_1,p_1) + \cdots + \min(m_k,p_k)$, this GCD must have one root of multiplicity $\min(m_i,p_i)$ in each disc $D(z_i,\varepsilon)$ such that $\min(m_i,p_i) > 0$.
In  particular, it follows that $\phi(\mathbf{b}) = \psi(\mathbf{b})$. Since $C'$ is connected, this equality holds for all $\mathbf{x} \in C'$.
:::

::: {.definition}
Let $f,g \in \Z[x_1,\ldots,x_{n-1}][x_n]$ be polynomials, with degrees $d$ and $e$ respectively, such that
\begin{align*}
f(x_n) &= a_d x_n^d + \cdots + a_1 x_n + a_0 \\
g(x_n) &= b_e x_n^e + \cdots + b_1 x_n + b_0. \\
\end{align*}
Then the Sylvester matrix associated to $f$ and $g$ is the $(d + e) \times (d + e)$-matrix defined as follows.
$$
S_{f,g}(f,g) =
\begin{pmatrix}a_{d} & \ldots & a_{0} & 0 & \ldots & \ldots & 0\\
0 & a_{d} & \ldots & a_{0} & 0 & \ldots & 0\\
\ldots & 0 & a_{d} & \ldots & a_{0} & \ldots & 0\\
b_{e} & \ldots & b_{0} & 0 & \ldots & \ldots & 0\\
0 & b_{e} & \ldots & b_{0} & 0 & \ldots & 0\\
\ldots & 0 & b_{e} & \ldots & b_{0} & \ldots & 0
\end{pmatrix}.
$$
:::

::: {.definition}
Let $f,g \in \Z[x_1,\ldots,x_{n-1}][x_n]$ be polynomials with degrees $d$ and $e$ respectively. The principal subresultant coefficient of order $j$ of $f$ and $g$, denoted $\psrc_j(f,g)$, is the determinant of the $(m + n - 2j) \times (m + n - 2j)$-matrix obtained from the Sylvester matrix associated to $f$ and $g$ by deleting the  first and last $j$ rows and columns.
:::

::: {.definition}
Consider $f \in \Z[x_1,\ldots,x_n]$ as a univariate polynomial in $x_n$. I.e.,
$$
f(x_n) = a_d x_n^d + \cdots + a_1 x_n + a_0
$$
where $a_d,\ldots,a_0 \in \Z[x_1,\ldots,x_{n-1}]$.
Let $\lc{f} = a_d$ denote the leading coefficient of $f$ and $\red(f) = a_{d-1}x_n^{d-1} + \cdots + a_1 x_n^1 + a_0$ be the reductum of $f$.

Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$. We define the projection operator, $\proj(\mathbf{F})$ as follows:

- Let $d := \deg(f_i)$. If $d > 1$, then $\proj(f_1,\ldots,f_i,\ldots,f_s)$ contains
$$
\psrc_k(f_i, \partial f_i / \partial x_n)
$$
for all $1\le k \le d$.

- Let $d := \min(\deg(f_i), \deg(f_j))$. If $d > 0$, then $\proj(f_1,\ldots,f_i,\ldots,f_j,\ldots,f_s)$ contains
$$
\psrc_k(f_i, f_j)
$$
for all $1 \le k \le d$.

- If $\deg(f_i) > 0$ and $\lc(f_i)$ is non-constant, then $\proj(f_1,\ldots,f_i,\ldots,f_s)$ contains
$$
\lc(f_i) \text{ and } \proj(f_1,\ldots,\red(f_i),\ldots,f_n).
$$
:::

::: {.theorem #cad-lift}
[@coste2000, Theorem 2.19]
Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$ be a family of polynomials and let $C'$ be a connected $\proj(\mathbf{F})$-invariant semialgebraic subset of $\R^{n-1}$ -- an $(i_1,\ldots,i_{n-1})$-cell.
Then there exist continuous definable functions
$$
\psi_1,\ldots, psi_\ell : C' \to \R
$$
such that for all $\mathbf{x} \in C'$, the set $\{ \psi_i(\mathbf{x}), \ldots, \psi_k(\mathbf{x}) \}$ coincides with the real roots of polynomials in $\mathbf{F}$, defining the $(i_1,\ldots,i_{n-1},0)$-cells in the cylinder $C' \times \R$ and $\{ -\infty < t < \psi_1(\mathbf{x}), \ldots, \psi_i(\mathbf{x}) < t < \psi_{i+1}(\mathbf{x}), \ldots, \psi_k(\mathbf{x}) < t < \infty \}$ are the $(i_1,\ldots, i_{n-1},1)$-cells in the cylinder $C' \times \R$.
:::

::: { .proposition #collins }
[@bpr2006, Algorithm 11.2]
Let $\mathbf{F} := f_1,\ldots,f_s$ be set of polynomials in $\Z[x_1, \ldots ,x_n]$ with maximum degree $d$.
There is an algorithm, taking $\mathbf{F}$ as input, which produces an $\mathbf{F}$-invariant CAD $\cal D$ of $\R^n$.
The complexity of the algorithm is
$$(sd)^{O(1)^{n}}.
$$
This is also an upper bound on the number of cells in $\cal D$, number of polynomials defining cells and their degrees.
:::

::: { .corollary #collins-sets}
Let $S_1,\ldots,S_k$ be a finite collection of semialgebraic subsets of $\R^n$ defined by quantifier-free Boolean formulas $F_1,\ldots,F_k$ respectively. Together, these formulas include $s$ different polynomials in $\Z[x_1,\ldots,x_n]$ with maximum degree $d$.
There is an algorithm, taking $\{F_1,\ldots,F_k\}$ as input, which produces a cylindrical decomposition $\mathcal E$ of $\R^n$ compatible with each set $S_i, 1 \le i \le k$.
Complexity, number of cells, number of polynomials and degrees are the same as in Proposition \@ref(prp:collins) but, in practice, more efficient algorithms exist (see e.g., @collins1991 and @bradford2014).
:::

::: { .proof }
This construction follows immediately from Proposition \@ref(prp:collins), where truth values of $F_1,\ldots,F_k$ associated to each cell.
The complexity upper bound (and bounds on number of cell, polynomials and degrees) is the same as in Proposition \@ref(prp:collins).
:::

::: { .corollary #collins-set }
Let $S\subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula $F$ containing $s$ different polynomials in $\R[x_1,\ldots,x_n]$, having maximum degree $d$.
There is an algorithm, taking $F$ as input, which produces a cylindrical decomposition $\mathcal E$ of $\R^n$ compatible with $S$.
Complexity, number of cells, number of polynomials and degrees are the same as in Proposition \@ref(prp:collins).
:::

::: { .proof }
Immediate, by applying Corollary \@ref(cor:collins-set) to $\{ F \}$.
:::

::: {.definition}
[@mccallum1998, 6.1]
Let $\mathbf{F} \subset \Z[x_1, \ldots, x_n]$ be a set of polynomials and denote by $\prim(\mathbf{F})$ the set of all primitive parts of $\mathbf{F}$
$\mathbf{F}$ is called well-oriented if, when $n > 1$,

- for each element $f \in \prim(A)$, $f(\mathbf{x},y) = 0$ for all $y\in \R$ on a finite number of points $\mathbf{x} \in \R^{n-1}$. [@mccallum1998, condition WO1]

- $\proj(\mathbf{F})$ is well-oriented. [@mccallum1998, condition WO2]
:::

::: {.definition #analytic-submanifold}
$S \subset \R^n$ such that $\dim(S) = k$ is an analytic submanifold if, for every point $\mathbf{x} \in S$, there is an analytic coordinate system about $\mathbf{x}$ with respect to which $S$ is locally the intersection of $n-k$ coordinate hyperplanes.
:::

::: {.proposition #mc-smooth}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula constructed from the set of polynomials $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$, such that $\mathbf{F}$ is well-oriented.
Then a CAD $\cal D$ of $\R^n$ compatible with $S$ and such that every cell $C$ of $\cal D$ is an analytic submanifold of $\R^n$ can be obtained by constructing an $\mathbf{F}$-invariant CAD of $\R^n$ using the McCallum projection operator.
:::

::: {.proposition #lz-smooth}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula constructed from the set of polynomials $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$.
Then a CAD $\cal D$ of $\R^n$ compatible with $S$ and such that every cell $C$ of $\cal D$ is an analytic submanifold of $\R^n$ can be obtained by constructing an $\mathbf{F}$-invariant CAD of $\R^n$ using the McCallum projection operator.
:::

::: {.definition}
Let $C_1$ and $C_2$ be distinct cells in a CAD $\cal D$ of $\R^n$. Each cell $C$ is assigned a truth value $T_C \in \{\tt{True}, \tt{False}, \tt{undet}\}$ and a list $S_C = (S_1,\ldots,S_k)$ where $S_i = (s_{i,1},\ldots,s_{i,s_i}, 1\le i \le k$ is the list of signs of level-$i$ (factorised) projection polynomials $f_1,\ldots,f_{i_s} \in \Z[x_1,\ldots,x_i]$, with $s_{i,j} \in \{-1,0,1\}$.
$(C_1, C_2)$ is called a conflicting pair in $\cal D$ if $T_{C_1}, T_{C_2} \in \{\tt{True}, \tt{False}\}$ and $T_{C_1} = T_{C_2}$ and $S_{C_1} = S_{C_2}$ (equality determined component-wise).
:::

::: {.definition}
[@gv04, Definition 6.2]
A weak stratification of a semi-Pfaffian set $X \subset \R^n$ is a partition of $X$ into a finite number of non-singular manifolds $X_k, 0 \le k \le n$ called strata. Strata need not be connected (or even have a finite number of connected components) and may be empty.

The stratification is called basic if all strata are basic semi-Pfaffian sets which are effectively nonsingular.
I.e., the system of equations and inequalities defining each stratum $X_k$ of codimension $k$ includes a set of $k$ Pfaffian functions
$$
h_{i_1}, \ldots , h_{i_k}
$$ such that the restriction $h_{i_j}\vert_{X_i} = 0$ and $d h_{i_j} \ne 0$ at every point $\mathbf{x} \in X_k$, for each $1 \le j \le k$.
:::

::: {.definition #pdo }
[@gv1995, Definition 2]
Let $f \in \Z[x_1,\ldots,x_n]$ be a polynomial and let $(m_1,\ldots,m_n) \subset \Z_{\ge 0}^n$ be a multi-index associated to one of its partial derivatives.
I.e., we write
$$
\partial f^{(m_1,\ldots,m_n)} =
\dfrac{\partial^{m_1} f}{\partial x_1} \cdots \dfrac{\partial^{m_n} f}{\partial x_n}.
$$
:::

::: {.definition}
[@gv1995, Definition 2]
We define the partial differential operator $\partial_{\mathbf{h}, \mathbf{i}, j} f$ (where the argument $f$ is a polynomial) as the determinant
$$
\det\begin{pmatrix}\dfrac{\partial h_{1}}{\partial x_{i_{1}}} & \cdots & \dfrac{\partial h_{1}}{\partial x_{i_{k}}} & \dfrac{\partial h_{1}}{\partial x_{j}}\\
 & \vdots\\
\dfrac{\partial h_{k}}{\partial x_{i_{1}}} & \cdots & \dfrac{\partial h_{k}}{\partial x_{i_{k}}} & \dfrac{\partial h_{k}}{\partial x_{j}}\\
\dfrac{\partial f}{\partial x_{i_{1}}} & \cdots & \dfrac{\partial f}{\partial x_{i_{k}}} & \dfrac{\partial f}{\partial x_{j}}
\end{pmatrix}.
$$
We write $\partial^m_{\mathbf{h}, \mathbf{i}, j}$ to mean the $m$-th iteration of $\partial_{\mathbf{h}, \mathbf{i}, j}$.
:::

::: {.theorem #strat }
Let
$$
X := \{ \mathbf{x} \in \R^n \mid f_1 = 0, \ldots, f_k = 0, g_1 > 0, \ldots, g_\ell > 0 \},
$$
be a semialgebraic set defined by $s = k + \ell$ different polynomials of maximum degree $d$.
Then there is an algorithm, without oracle, which partitions $X$ into a family
$$
{\cal X} = (X_0, \ldots, X_n)
$$
such that, if $X$ is nonsingular, $X_0 = X$ and all other sets are empty.
Otherwise, $X_0 = \emptyset$ and each $X_k, 1 \le k \le n$ is a possibly empty, effectively nonsingular stratum of codimension $k$.
This algorithm has complexity
$$
3^{s}\left(s(d+1)\right)^{O(n)^{2}}.
$$
The number of strata does not exceed $s^{n} (d + 1)^2$, and each stratum is defined by at most $s (d + 1)^2$ polynomial equations and inequalities of maximum degree $(d + 1)^2$.
:::

::: {.algorithm data-latex="Smooth Stratification"}
$${\cal X} := \rm{Stratify}(k, F, \mathbf{h}, \mathbf{i}, G)$$

**Input:**

  - $0 \le k \le n$,
  - $F = (f_1,\ldots,f_s) \in \Z[x_1,\ldots,z_n]$ is a list of polynomials,
  - $\mathbf{h} = (h_k, \ldots,h_1, h_0) \in \Z[x_1,\ldots,x_n]$ such that $h_0 = 0$,
  - $\mathbf{i} = (i_k, \ldots, i_1,i_0) \in \Z_{\ge 0}$ such that $i_0 = 0$,
  - $G = \{g_1,\ldots,g_t\} \subset \Z[x_1,\ldots,x_n]$.

**Output:**
$$
{\cal X} = (X_{k+1}, \ldots, X_n)
$$
$X_i, k+1 \le i \le n$ is a possibly empty, effectively nonsingular stratum of codimension $i$.
Note that ${\cal X}_{n+1} = ()$.

Proceed by induction on $i_k$.

- Base case: $i_k = n$.

  - Return ${\cal X}_{x+1} = (\emptyset, \ldots, \emptyset)$.

- Otherwise

  - Initialise

    - $X' := X = \{ f_1 = 0,\ldots,f_s = 0, g_1 > 0, \ldots, g_t > 0 \}$,

    - ${\cal F} := \{ ((0,\ldots,0,1), f_1), \ldots, ((0,\ldots,0,s), f_s) \}$
      (the set of input polynomials equipped with initial indices),

    - $X_{k+1} = \emptyset$ be the initial set of strata of codimension $k+1$.

  - For indices $\mathbf{i},\mathbf{j} \in \Z_{\ge 0}^n$,
    - let $\mathbf{i} \prec \mathbf{j}$ mean that $\mathbf{i}$ is lexicographically less than $\mathbf{j}$
    - and $\mathbf{i} \preceq \mathbf{j}$ denote $\mathbf{i}\prec \mathbf{j}$ or $\mathbf{i} = \mathbf{j}$.

  - We will iterate over each index $\mathbf{m} = (i_n,\ldots,i_{k+1},j) \in \Z_{\ge 0}^{n-k+1}$ in ascending lexicographical order, beginning with $(0,\ldots,0,1)$.

  - Partial derivatives $\partial^{(0,\ldots,0,i_{k+1},\ldots,i_n)}$ of functions $f$ in ${\cal F}$ will be computed.

  - For each $f\in {\cal F}$, maximal index $$M := (\deg_n(f), \ldots, \deg_{k+1}(f)).$$

  - Each index $(i_n,\ldots,i_{k+1},j)$ has the property that
  $$
  (0,\ldots,1) \preceq (i_n,\ldots,i_{k+1}) \preceq M_j.
  $$

    - Let $\mathbf{m} = (0,\ldots,0,i_\ell,\ldots,i_{k+1},j)$ be one of these indices and define
    $$
    \mathbf{j} = (0, \ldots, 0, i_{\ell} - 1, i_{\ell - 1}, \ldots, i_{k+1},j).
    $$

    - Let
    $$
    s_{k+1} := \partial_{(h_{1,},\ldots,,h_{k}),(i_{1},\ldots,i_{k}),\ell}^{i_{\ell}}\ldots\partial_{(h_{1,},\ldots,,h_{k}),(i_{1},\ldots,i_{k}),i_{k}+1}^{i_{i}+1}f_{j}
    $$
    where $f_j$ is the polynomial in $\cal F$ with index $(0,\ldots,0,j)$, i.e., the $j$-th input polynomial.

    - In practice, let $h_{k+1}$ be the polynomial in $\cal F$ with index $\mathbf{i}$ and compute
    $$
    s_{k+1} := \partial_{(h_1,\ldots,h_k), (i_1,\ldots,i_k), i_\ell} h_{k+1}.
    $$

    - Define the sets

      - $Y_{k+1} := \{ \mathbf{x} \in X' \mid s_{k+1}(\mathbf{x}) \ne 0 \}$ and

      - $U_{k+1} := \{ \mathbf{x} \in \R^n \mid h_{k+1}(\mathbf{x}) = 0, s_{k+1}(\mathbf{x}) \ne 0, g_1(\mathbf{x}) > 0 , \ldots, g_t(\mathbf{x}) > 0 \}$.

      - Note

        - Clearly $Y_{k+1} \subset X'$ and $Y_{k+1} \subset U_{k+1}$
        - $h_{k+1}(\mathbf{x}) = 0$ for all $\mathbf{x} \in Y_{k+1}$.
        - $U_{k+1}$ is a nonsingular subset of $\R^n$ having codimension $k+1$.

      - If $Y_{k+1}$ is an open subset of $U_{k+1}$, then $Y_{k+1}$ is smooth and has codimension $k+1$.

        - Let $X_{k+1} := X_{k+1} \cup Y$,

      - Otherwise, proceed by induction.

        - Compute
        $$(X^{\mathbf{m}}_{k+2},\ldots,X^{\mathbf{m}}_n) := {\rm Stratify}(k+1, F, (s,:\mathbf{h}), (i_\ell:\mathbf{i}), G)$$
        where $x:L$ denotes the `cons` operator. I.g., add $x$ to the beginning of list $L$.

      - Let $\rm{Empty}(X,s)$ be a subroutine returning *true* if $s \in \Z[x_1,\ldots,x_n]$ is identically zero on the set $X \subset \R^n$.

      - If $\rm{Empty}(X,s)$, we are finished.

        - Return
        $${\cal X}_{k+1} = (X_{k+1}, X_{k+1}, \ldots, X_n).$$
        where $X_i, k+2\le i \le n$ is the union of all strata $X^{\mathbf{m}}_i$ computed in the recursive calls.

      - Otherwise,

        - Let

          - $X' := \{ \mathbf{x} \in \R^n \mid s(\mathbf{x}) = 0 \}$,

          - ${\cal F} := {\cal F} \cup \{ ((0,\ldots,0,i_\ell,\ldots,i_{k+1},j), s) \}$,

        - $F := F:s$ (i.e., append $s$ to the end of list $F$).

      - Then proceed to the index immediately after $\mathbf{m}$ with respect to $\prec$.

      - The algorithm terminates when maximal index $M_j$ for every polynomial $f_j \in F$ has been considered.
:::

::: {.example}
Consider the semialgebraic set
$$
S := \{ (x_1,x_2) \in \R^2 \mid x_1 x_2 = 0 \}
$$
Apply the algorithm.
\begin{align*}
k=0,X':=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid f_{1}:=x_{1}x_{2}=0\right\} \\\left(0,1,1\right)h_{1}=&f_{1}=x_{1}x_{2}\\s_{1}=\partial f_{1}/\partial x_{1}=&x_{2}\\Y_{1}:=&\left\{ \mathbf{x}\in X'\mid y\ne0\right\} \\U_{1}:=&\left\{ \mathbf{x}\in \mathbb{R}^2\mid x_{1}x_{2}=0,x_{2}\ne0\right\} \\&\text{Proceed by induction}\\
k=1,h_{1}=f_{1},i_{1}=1,X'':=&Y_{1},F_{1}=\left\{ f_{1}\right\} \\\left(1,1\right),h_{2}=&f_{1}\\s_{2}=&\begin{pmatrix}\partial f_{1}/\partial x_{1} & \partial f_{1}/\partial x_{2}\\
\partial f_{2}/\partial x_{1} & \partial f_{1}/\partial x_{2}
\end{pmatrix}=0\\&\text{since both columns are equal.}\\\text{Return. }Y_{1}&\text{ is smooth.}\\
\end{align*}

Observe that the formula for $Y_1$ contains one equation, $h_1 = f_1$. Hence $Y_1$ is a smooth stratum in basic representation and we can conclude that it has codimension $1$.

For the next nonzero derivative, with index $(1,0,1)$, we get
\begin{align*}
k=0,X':=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{1}x_{2}=0,y=0\right\} \\\left(1,0,1\right)\ h_{1}=&f_{1}=x_{1}x_{2}\\s_{1}=\partial f_{1}/\partial x_{2}=&x_{1}\\Y_{1}:=&\left\{ \mathbf{x}\in X'\mid x_{1}\ne0\right\} \\U_{1}:=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{1}x_{2}=0,x_{1}\ne0\right\} \\&\text{Proceed by indection.}\\k=1,h_{1}=f_{1},i_{1}=2,X'':=&Y_{1}\ldots\\&\text{No partial derivatives can be computed.}\\\text{Return. }Y_{1}&\text{ is smooth.}
\end{align*}

Notice that the inductive step returns immediately. This is because $i_1=2$, so it is not possible to take further partial derivatives with respect to $j > i_1$. In the formula for
$$
Y_1 := \{ \mathbf{x} \in \R^2 \mid f_1 := x_1 x_2 = 0, h_1 := x_2 = 0, x_1 \ne 0 \},
$$
two different equations, $f_1$ and $h_1$ appear. However, $Y_1$ is not in basic representation. Indeed, the equation $f_1=0$ is redundant, since $f_1$ is equal to zero for all points at which $h_1$ is equal to zero. Thus $f_1$ can be discarded, and we see that only one equation, $h_1$, is required to represent $Y_1$ in basic form. We can conclude that $Y_1$ is smooth and has codimension $1$.

Finally, consider the derivative with index $(1,1,1)$.
\begin{align*}
k=0,X':=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{1}x_{2}=0,x_{2}=0,x_{1}=0\right\} \\\left(1,1,1\right)\ h_{1}=&s_{1}^{\left(0,1,1\right)}=x_{2}\\s_{1}=\partial f_{1}/\partial x_{2}=&1\\Y_{1}:=&\left\{ \mathbf{x}\in X'\mid1\ne0\right\} \\U_{1}:=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{2}=0,1\ne0\right\}
\end{align*}
Again, the inductive step returns immediately because $i_1=2$, but this time we can see that $Y_1$ is not an open subset of $U_1$. As mentioned above, the algorithm is unable to determine this without solving a quantifier elimination problem. Instead, we may be able to determine the codimension by looking at the basic representation of $$
Y_1 := \{ (x_1,x_2) \in \mathbb{R}^2 \mid x_1 x_2 = 0, x_1 = 0, x_2 = 0 \}.
$$
(Note that the constraint $1 \ne 0$ is dropped since it is trivial and adds no information.)
We see that three equations appear in the definition of $Y_1$, but the first one, $f_1 := x_1 y_2$ is redundant again. Thus, the two equations $x_2 = 0, x_1 = 0$ define $Y_1$ and we can conclude that $Y_1$ is smooth and has codimension $2$.
:::

::: {.proposition #bgv-quasi }
[@bgv15, Theorem 3.19]

Let $V_1,\ldots,V_k$ be bounded deﬁnable subsets in $\R^n$ with $\dim (V_i) \le 2$ for each
$1 \le i \le k$.
Then there is a cylindrical cell decomposition of $\R^n$, compatible with each $V_i$ such that every cylindrical cell contained in $V := V_1\cup\ldots\cup V_k$ is the graph of a quasi-affine map.
:::

::: { .theorem #bgv-quasi-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas containing $s$ different polynomials $\mathbf{F} = \{ f_1,\ldots, f_s \} \subset \Z[x_1,\ldots,x_n]$, having maximum degree $d$, such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.

Then there is an algorithm, taking $F_1,\ldots,F_k$ as input, which constructs an $\mathbf{F}$-invariant CAD $\mathcal{D}$ of $\R^n$ such that each cell $C \subset V_1\cup\ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map. $\mathcal{D}$ is obviously compatible with each $V_1,\ldots,V_K$. 
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{2^{O(n)}},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.algorithm data-latex="Quasi-Affine CAD"}
**Input:**
$$(F_1,\ldots,F_k)$$

  - $F_1,\ldots,F_k$: a quantifier-free Boolean formula defining
  $$
  V = V_1 \cup \ldots \cup V_k
  $$
  where $V \subset \R^n$ and $\dim(V_i) \le 2, 1 \le i \le k$.

**Output:**
$$
({\cal D})
$$
  - $\cal D$: an $\mathbf{F'}$-invariant CAD of $\R^n$ compatible with each $V_1,\ldots,V_k$ such that each cell $C \subset V$ is the graph of a quasi-affine map, where $\mathbf{F'}  \subset \Z[x_1,\ldots,x_n]$ contains all polynomials from formulas $F_1,\ldots,F_k$ and, possibly, some additional polynomials which are zero at singular points of $V_1\cup \ldots, \cup V_k$ and the critical points of projections of $Y_1 \cup \ldots \cup V_k$ onto one- and two- dimensional coordinate subspaces.

- Let $$
\mathbf{F} \subset \Z[x_1,\ldots,x_n]
$$
be the set of polynomials appearing in the formulas $F_1,\ldots,F_k$.

- Compute $\cal E$, an $\mathbf{F}$-invariant CAD of $\R^n$ (obviously compatible with each $V_1,\ldots,V_k$) using the McCallum projection operator.

- Let ${\cal A} = ({\cal A}_1,\ldots,{\cal A}_{n})$ be the family of projection polynomials for $\cal E$, where each ${\cal A}_k \subset \Z[x_1,\ldots,x_k]$.

- For each cell $C_k \subset V$ with index $(i_1,\ldots,i_n) \in \{0,1\}^n$, such that $i_{j_1} = \ldots = i_{j_k} = 1$ while all other elements of the index are equal to $0$ (since $\dim(V) \le 2$, $k \le 2$ and $\dim(C_k) = k$):

  - Let $f_1,\ldots,f_{n-k}$ be a set of projection polynomials, where $f_i \in \mathcal{A}_i$, which are equal to $0$ on the cell $C_k$.

  - For each $i \in \{1,\ldots,n\} \setminus \{j_1,\ldots,j_k\}$, find a polynomial in ${\cal A}_i$ which is $0$ at every point $\mathbf{x} \in C_k$. This can be done by checking the set of signs of projection factors.

- For each $2$-dimensional cell $C_2 \subset V$ and pair $1 \le i_1 < i_2 \le n$:

  - Find the set of polynomials $f_1,\ldots,f_{n-2}$ defining $C_2$ as described above.

  - Let $\mathbf{m} = \{j_1,\ldots,j_{n-2}\} = \{1\ldots,n\} \setminus \{i_1,i_2\}$.

  - Define
    \begin{equation}
    J_{C_2,\mathbf{m}} :=
\begin{pmatrix}\partial f_{1}/\partial x_{j_{1}} & \ldots & \partial f_{1}/\partial x_{j_{n-2}}\\
\vdots &  & \vdots\\
\partial f_{n-2}/\partial x_{j_{1}} & \ldots & \partial f_{n-2}/\partial x_{j_{n-2}}
\end{pmatrix},
(\#eq:jacobi-two)
    \end{equation}
    an $((n-2)\times (n-2))$ Jacobi matrix.

    $\det(J_{C_2,\mathbf{m}}) = 0$ at the critical points of $\projops{i_1,i_2}$.

- For each $1$-dimensional cell $C_1 \subset V$ and each $1 \le i \le n$:

  - Find the set of polynomials $f_1,\ldots,f_{n-1}$ defining $C_1$.

  - Let $\mathbf{m} = \{j_1,\ldots,j_{n-1}\} = \{1\ldots,n\} \setminus \{i\}$.

  - Define
  \begin{equation}
  J_{C_1,\mathbf{m}} :=
\begin{pmatrix}\partial f_{1}/\partial x_{j_{1}} & \ldots & \partial f_{1}/\partial x_{j_{n-1}}\\
\vdots &  & \vdots\\
\partial f_{n-1}/\partial x_{j_{1}} & \ldots & \partial f_{n-1}/\partial x_{j_{n-1}}
\end{pmatrix},
(\#eq:jacobi-one)
  \end{equation}
  an $((n-1)\times (n-1))$ Jacobi matrix.

  $\det(J_{C_1,\mathbf{m}}) = 0$ at the critical points of $\projops{i}$.

  - Return the CAD $\cal D$, which is sign invariant on
    \begin{align*}
    \mathbf{F}' =\ & & \mathbf{F}\\
    \cup\ & \bigcup_{C_2 \subset V,\dim(C_2) = 2,\mathbf{m} = \{1,\ldots,n\} \setminus \{i_1,i_2\}, 1 \le i_1 < i_2 \le n} & \det\left(J_{C_2,\mathbf{m}}\right)\\
    \cup\ & \bigcup_{C_1 \subset V,\dim(C_1) = 1,\mathbf{m} = \{1,\ldots,n\} \setminus \{i\}, 1 \le i \le n} & \det\left(J_{C_1,\mathbf{m}}\right).\\
    \end{align*}
:::

::: {.example #monotone-cells}
[@bgv15, Example 3.2]

Let
$$
\Delta := \{ (x,y) \in \R^2 \mid 0 < x < 1, y > 0, x + y < 1 \} \subset \R^2
$$ and
$$
\varphi(x,y) = x^2 + y^2.
$$
Let $Y \subset \R^3$ be the graph of function $\phi$ on $\Delta$. Observe that $Y$ is a cylindrical cell and $\varphi\vert_\Delta$ is a quasi-affine map, since it is strictly increasing in both $x$ and $y$.
However, $y \cap \{ z = 3/4 \}$ is not connected, hence $\phi\vert_\Delta$ is not a monotone function and $Y$ is not a monotone cell.
:::

::: {.definition #sub-cad}
Let $\cal D$ be a CAD of $\R^n$ and suppose that $\mathbf{c} = (c_1,\ldots,c_k)$ is a $0$-dimensional section cell in the decomposition induced by $\cal D$ on $\R^k$.
By [@bgv15 Remark 3.8], the set of all cells of $\cal D$ contained in the affine coordinate subspace
$$
\{ x_1=c_1,\dots,x_k=c_k \}
$$
forms a cylindrical decomposition of $\R^{n-k}$. This decomposition will be called the *sub-decomposition* of $\cal D$ above $c$, and $\mathbf{c}$ the *base cell* of the sub-decomposition (or sub-CAD).
:::

::: {.proposition #bgv-monotone}
[@bgv15, Lemma 3.18]

Let $X \subset \R^2$ be an open, bounded set and $f : X \to \R$ be a quasi-affine function.
Then there is a cylindrical decomposition of $\R^2$ compatible with $X$, obtained by intersecting $X$ with straight lines $$\{x_1 = c\}$$ and half-planes $$\{x_1 < c\},\{x_1 > c\}$$ such that the restriction $f\vert_B$ for every cell $B \subset X$ is a monotone function.
:::

::: { .theorem #bgv-monotone-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.
Let $\mathbf{F} = \{f_1,\ldots,f_s\}$ be a set of polynomials in $\Z[x_1,\ldots,x_n]$ of maximum degree $d$ and $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ compatible with each $V_1,\ldots,V_k$ and such that each cell $C \subset V_1\cup\ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map.

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ monotone with respect to each $V_1, \ldots, V_k$.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{{O(1)^n}},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.proof}
Since $C$ is the graph of a quasi-affine map from $X \to \opspan{x_2,\ldots,x_{\alpha - 1}}$, it follows that the projection map $\projops{x_1,x_\alpha}\vert_C$ is injective. This proves the first claim. The second claim follows by iteratively applying the projection defined in @bgv15, Lemma 3.3 to obtain the $2$-dimensional cylindrical sector cell $X$.
By definition, $$
X := \{ (x_1,t) \in \R^2 \mid x_1 \in X', \varphi(x_1) < t < \psi(x_1) \}
$$
where $\varphi,\psi : X' \to \R$ are continuous definable functions such that $\varphi(x_1) < \psi(x_1)$ for all $x_1 \in X'$.
Note that $X$ may not be bounded from below (resp. above). In this case, we take $\varphi(x_1) = -\infty$ (resp. $\psi(x_1) = \infty$) for all $\mathbf{x} \in X'$. Functions $\varphi$ and $\psi$ are either infinite or finite at every point in $X'$, otherwise, new one-dimensional section cells would exist whose projections onto $\R^1$ form a proper subset of $X'$. This would contradict the cylindrical property.
It is clear from this definition that ${\cal I}(c)$ contains a single open interval $(\varphi(c), \psi(c))$, proving the third claim. It follows that $\gamma$, which consists of the endpoints of intervals in ${\cal I}(c)$, consists of one-dimensional curve intervals which are the graphs of $\varphi$ and $\psi$ (if finite).

The proof of the final claim is completed by defining the functions $\varphi$ and $\psi$.

Since $C' := \projop{\alpha - 1}(C)$ is a $(1,\ldots,0,0)$-cell, it is the graph of a continuous definable map $\mathbf{h} = (h_1,\ldots,h_{\alpha - 2}) : X' \to \R^{\alpha - 2}$ and $$
C = \{ (\mathbf{x},t) \mid \mathbf{x} \in C', f(\mathbf{x}) < t < g(\mathbf{x})\}
$$
where $f,g : \R^{\alpha - 1} \to \R$ are continuous definable functions such that $f(\mathbf{x}) < g(\mathbf{x})$ for all $\mathbf{x} \in C'$.
Again, if not bounded from above (resp. below), $f$ (resp. $g$) are taken to be $-\infty$ (resp. $\infty$) at every point.
Observe that the graph of $f$ (if finite) is the bottom of $C$ and the graph of $g$ (if finite) is the top of $C$.

Writing $C$ in terms of $x_1 \in X'$, $f$, $g$ and $\mathbf{h}$, we obtain the functions
\begin{align}
\varphi &:\> C'' \to \R & \psi &:\> C'' \to \R\\
\varphi(x_1) &= f(x_1,\mathbf{h}(x_1)) & \psi(x_1) &= g(x_1,\mathbf{h}(x_1))
(\#eq:phi-psi)
\end{align}
:::

::: {.proposition #lagrange-multipliers}
Let $f : \R^n \to \R$ and $g_1,\ldots,g_k : \R^n \to \R$ be continuous functions with continuous first partial derivatives.
Local maxima and minima of $f$, subject to the constraints $g_1=0,\ldots,g_k=0$ can be found by computing the critical points of the function
$$
\mathcal{L}(\mathbf{x}, \lambda_1,\ldots,\lambda_k) = f(\mathbf{x}) - \lambda_1 g_1(\mathbf{x}) - \cdots - \lambda_k g_k(\mathbf{x}),
$$
where $\mathbf{x} \in \R^n$ and $(\lambda_1,\ldots,\lambda_k) \in \R^k$ are new variables.

Critical points can be found by solving the system of equations
\begin{equation}
\dfrac{\partial f}{\partial x_i} - \lambda_1 \dfrac{\partial g_1}{\partial x_i} - \cdots - \lambda_k \dfrac{\partial g_k}{\partial x_i}= 0,
(\#eq:lagrange)
\end{equation}
where $1\le i \le n-1$,

for $\lambda_1,\ldots,\lambda_k$.
:::

::: {.remark #lagrange-solve}
Using variables $(x_1,\ldots,x_{\alpha-1})$, constraints $g_2,\ldots,g_{\alpha - 1}$ and function $h$ from Equation \@ref(eq:c-alpha-top), the system from Equation \@ref(eq:lagrange) can be written in matrix form as follows.
$$
\begin{pmatrix}\dfrac{\partial g_{2}}{\partial x_{1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{1}}\\
\vdots &  & \vdots\\
\dfrac{\partial g_{2}}{\partial x_{\alpha-1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{\alpha-1}}
\end{pmatrix}\begin{pmatrix}\lambda_{1}\\
\vdots\\
\lambda_{\alpha-2}
\end{pmatrix}=\begin{pmatrix}\dfrac{\partial h}{\partial x_{1}}\\
\vdots\\
\dfrac{\partial h}{\partial x_{\alpha-1}}
\end{pmatrix}
$$

It is clear that, if a solution exists, then the last column
$\left(\tfrac{\partial h}{\partial x_{1}},\ldots, \tfrac{\partial h}{\partial x_{\alpha-1}}\right)^T$
will be a linear combination of the first $\alpha - 1$ columns (in $g_2,\ldots,g_{\alpha - 1}$).
Hence, optimal values for $(x_1,\ldots,x_{\alpha-1})$ exist and satisfy the equation
\begin{equation}
\det\begin{pmatrix}\dfrac{\partial g_{2}}{\partial x_{1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{1}} & \dfrac{\partial h}{\partial x_{1}}\\
\vdots &  &  & \vdots\\
\dfrac{\partial g_{2}}{\partial x_{\alpha-1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{\alpha-1}} & \dfrac{\partial h}{\partial x_{\alpha-1}}
\end{pmatrix}=0.
(\#eq:jacobi-det)
\end{equation}
:::

::: {.proposition #monotone-sector-algorithm }
Let $\mathcal{D}$ be a sign-invariant CAD of $\R^n$ compatible with each set $V_1,\ldots,V_k \subset \R^n$ with $\dim(V_i) \le 2$ and such that each cell $C \subset V_i$ is the graph of a quasi-affine map, for $1\le i \le k$. Let
$$
{\cal A} = ({\cal A}_1,\ldots,{\cal A}_n),
$$
where ${\cal A}_k \subset \Z[x_1,\ldots,x_k], 1 \le k \le n$, be the projection polynomials defining $\cal D$.
Let $C$ be a $(1,0,\ldots,0,1)$-cell of the decomposition induced by $\cal D$ on $\R^{\alpha}$ such that $\projop{\alpha}^{-1}(C)$ is a cell of $\mathcal{D}$ contained in $V_1,\ldots,V_k$.

Then there is an algorithm, taking $\mathcal{D}$ and $\mathcal{A}$ as input, which produces a set of algebraic numbers $(c_1,\ldots,c_t)$ such that $C \cap \{ c_i < x_1 < c_{i+1} \}$ is monotone. Each $c_i, 1 \le i < t$ is represented by a pair $(m_i, J_i) \in \Z[x_1] \times \Q$ (see Equation \@ref(eq:algebraic-number).
:::

::: {.remark}
Let $f \in \Q[x_1,\ldots,x_n]$ be a polynomial such that
$$
f(x_1,\ldots,x_n) = \dfrac{a_1}{b_1} m_1 + \cdots + \dfrac{a_k}{b_k} m_k
$$
where $m_i = x_1^{d_{i,1}} \cdots x_n^{d_{i,n}}$ for $1 \le i \le k$ is a monomial in $x_1,\ldots,x_n$.

Let $M := \lcm(b_1, \ldots, b_k)$ be the least common multiple of denominators and construct
$$
g(x_1,\ldots,x_n) = M f(x_1,\ldots,x_n) = \dfrac{M a_1}{b_1} m_1 + \cdots + \dfrac{M a_k}{b_k} m_k.
$$
Each coefficient in $g$ will be an integer number since $M$ is divisible by all $b_1,\ldots,b_k$ and polynomials $f$ and $g$ have the same roots.
:::

::: {.definition #norm}
Let $K$ be a field and $L$ a finite (algebraic) extension of $K$.
The field $L$ can be thought of as a finite dimensional vector space over $K$.

Consider $f$ and $m$ be polynomials in $L[x_1,\ldots,x_n]$, viewed as polynomials in $K[x_1,\ldots,x_n,x_\alpha]$.
The norm, in $L[x_1,\ldots,x_n]$ of $f$ can be found by computing the resultant of $f$ and $m$.
:::

::: {.remark}
Let $f \in \A[x_1,\ldots,x_n]$ be a polynomial such that
$$
f(x_1,\ldots,x_n) = a_1 m_1 + \cdots + a_k m_k
$$
where $m_i = x_1^{d_{i,1}} \cdots x_n^{d_{i,n}}$ is a monomial in variables $x_1,\ldots,x_n$ and $a_i$ is an element of the algebraic extension of the rational numbers $\Q(\alpha)$ for $1 \le i \le k$.

Let $m \in \Z[\alpha]$ be the minimal polynomial for $\Q(\alpha)$. $f$ can be written as a polynomial in $\Q[x_1,\ldots,x_n,x_\alpha]$ and $m$ can be viewed as a polynomial in $\Q[x_1,\ldots,x_n,x_\alpha]$ which is independent of all $x_1,\ldots,x_n$. Compute
$$
g := \res_\alpha (f,m)
$$
to obtain a polynomial in $\Q[x_1,\ldots,x_n]$. The property that $f(\mathbf{x}) = 0$ if and only if $g(\mathbf{x}) = 0$ follows from a property of resultants:

> Let $I = \langle f, m \rangle$ be the ideal generated by polynomials $f, m \in K[x_1,\ldots,x_n][\alpha]$, where $K$ is an algebraically closed field.
If at least one of $f$ and $m$ is monic, then
>$$
\res_\alpha (f,m) \in I \cap R.
$$

It follows that $\mathbf{x} \in K^n$ is a common zero of the elements of $I \cap R$ if and only if it is a zero of $\res_\alpha(f,m)$.

<!-- TODO this property came from the wiki page on resultants. does it need proving? -->
:::

::: {.lemma #one-dim-qa-is-monotone}
Let $Y \subset \R^n$ be the graph of a quasi-affine map
$$
\mathbf{f} : (a,b) \to \R^{n-1}
$$
such that $(a,b) \subset \R$. Then $Y$ is a monotone cell.
:::

::: {.proof}
Consider a quasi-affine component $f_j : (a,b) \to \R$ of the map $\mathbf{f}$. By definition, $f_j$ is either strictly increasing in, strictly decreasing in, or independent of $x_i$. Assume for contradiction that $Y$ is not monotone and the intersection $Z := Y \cap \{ x_i = c \}, c \in \R$ is not connected. Since $Y$ itself is connected, $Z$ would consist of two isolated points. It is clear that the projection map $\projops{x_i}\vert_Y$ is not injective and its image would be one-dimensional (if not, $f_j$ would be constant and equal to $c$ and Z would have one connected component).

The proof is completed by applying this argument to each component of the map $\mathbf{f}$.
:::

::: {.proposition #monotone-section-algorithm}
Let $\mathcal{D}$ be a CAD of $\R^n$ compatible with each set $V_1,\ldots,V_k \subset \R^n$ with $\dim(V_i) \le 2$ and such that each cell $C \subset V_i$ is the graph of a quasi-affine map, for $1\le i \le k$. Let
$$
{\cal A} = ({\cal A}_1,\ldots,{\cal A}_n),
$$
where ${\cal A}_k \subset \Z[x_1,\ldots,x_k], 1 \le k \le n$, be the projection polynomials defining $\cal D$.
Let $C$ be a $2$-dimensional section cell of the decomposition induced by $\cal D$ on $\R^{j}$ such that $\projop{j}^{-1}(C)$ is a cell of $\mathcal{D}$ contained in $V_1,\ldots,V_k$ and $\projop{j-1}(C)$ is monotone.

Then there is an algorithm, taking $\mathcal{D}$ and $\mathcal{A}$ as input, which produces a set of algebraic numbers $(c_1,\ldots,c_r)$ such that $C \cap \{ c_i < x_1 < c_{i+1} \}$ is monotone. Each $c_i, 1 \le i \le r$ is represented by a pair $(m_i, J_i) \in \Z[x_1] \times \Q$ (see Equation \@ref(eq:algebraic-number).
:::

::: {.Remark #monotone-sub-cad }
propositions \@ref(prp:monotone-sector-algorithm) and \@ref(prp:monotone-section-algorithm) can also be applied to two-dimensional $(0,\ldots,0,1,i_{k+1},\ldots,i_n)$-cells by working in a sub-cad of $\R^{n-k+1}$ above a zero-cell, as described in Section \@ref(sec:sub-cad).
:::

::: {.algorithm data-latex="Monotone CAD"}
**Input:**
$$({\cal E}, {\cal A})$$

  - $\cal E$: a cylindrical algebraic decomposition of $\R^{k+n}$, such that each cell is the graph of a quasi-affine map. Each cell $C$ of $\cal E$ has a truth-value (*true* or *false* attached.

  - ${\cal A} = {\cal A}_1,\ldots,{\cal A}_{k+n}$ is the family of projection polynomials where each ${\cal A}_i \subset \Z[x_1,\ldots,x_i]$.

**Output:**
$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} = \{ c_1,\ldots,c_t \} \subset \A \mid \mathbf{b} \in \R^{k-1} \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^k \}
$$
such that, for each ${\cal R}_\mathbf{b}$, intersecting the sub-cad $\cal D$ above $\mathbf{b}$ with straight lines and half-planes of the kind $\{x_1 < c_i \}, \{x_1 = c_i \}, \{x_1 > c_i\}, 1 \le i \le t$ results in a refinement of $\cal D$ such that each true cell of $\cal D$ with dimension at most $2$ is monotone.

First, define a subroutine
$${\rm sub}_{\mathbf{y}} (g) \mid g \in \Z[y_1,\ldots,y_m,x_1,\ldots,x_n], \mathbf{y} \in \A^m, n > 0,$$
which computes $h := g(\mathbf{y}) \in \A[x_{1},\ldots,x_m]$ and returns the normalised polynomial of $h$, in $\Z[x_{m+1},\ldots,x_n]$ (see Section \@ref(sec:sub-cad)).

It will be convenient to overload this operator and write ${\rm sub}_{\mathbf{y}} (L)$, where $L$ is a set (or list) of polynomials to mean $\{ {\rm sub}_{\mathbf{y}} (g) \mid g \in L \}$.

Now define a structure to store refinement polynomials
$$
{\cal F} := \{ {\cal F}_{\mathbf{b}} := \emptyset \mid \mathbf{b} \in \R^{k-1}, k > 0 \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^{k-1} \}
$$
and a similar structure to store refinement points
$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} := \emptyset \mid \mathbf{b} \in \R^{k-1}, k > 0 \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^{k-1} \}
$$
*(Note: for each $(0,\ldots,0)$-cell $\mathbf{b}$, ${\cal F}_\mathbf{b}$ is a set of univariate polynomials, ${\cal R}_{\mathbf{b}}$ is the set of roots of polynomials ${\cal F}_\mathbf{b}$. When $k=1$, then the CAD of $\R^0$ consisting of the unique point of $\R^0$ is used -- practically speaking, we work directly with the CAD $\cal E$.)*

Let $\mathbf{b}$ be a $(0,\ldots,0)$-cell of the decomposition induced by $\cal E$ on $\R^{k-1}, k > 0$. Let $\cal D$ be the sub-decomposition of $\R^n$ of $\cal E$ above $\mathbf{b}$.

Consider each cell $C$ of $\cal D$ with truth value *true*. Let $C$ have index
$$
(0,\ldots,0,1,i_{k+1},\ldots,i_{k+n})
$$
in $\cal E$. If $i_{k+1} + \cdots + i_n > 2$, then $\dim(C) > 2$ and the algorithm will fail. Otherwise, let $\alpha$ be the smallest among $x+1,\ldots,k+n$ such that $i_{k+1} = \ldots = i_{\alpha - 1} = 0$ and $i_\alpha = 1$.
Then:

- Let

  - $\mathbf{b} := \projop{k-1}(C)$,

    *(Note: observe that $\mathbf{b} \in A^{k-1}$. If $k = 1$, then $\mathbf{b}$ is the unique cell, $\mathbf{0}$, in the CAD of $\R^0$. In this case, it is clear that ${\rm sub}_\mathbf{0} (g) \equiv g$.)*

  - $C'' \subset \A := \projop{k}(C)$ ($(1)$-cell), and let $(C''_B, C''_T)$ be $(0)$-cells which are the endpoints of $C''$,

  - ${\cal G} := {\rm sub}_{\mathbf{b}} \{ g_i \mid k+1 \le i \le \alpha - 1, g_i \in {\cal A}_i, g_i(\mathbf{x}) = 0 \ \forall \mathbf{x} \in \projop{\alpha-1}(C) \}$,

  - $C' := \projop{\alpha}(C)$.

- $C'_T$ and $C'_B$ be the top and bottom, respectively, $C'$.

(*Note: If $C'$ is not bounded from above (resp. below) by a continuous definable function, i.e., there is no section above (resp. below) $C'$, then let $C'_T := \emptyset$ (resp $C'_B$) and skip any computations involving $C'_T$ (resp $C'_B$).)*

- Let $j = \alpha$ and do:

  - **(*)** For $\delta \in \{B, T\}$, if $C_\delta$ is not empty, do:

    - Let $\rm{sub}_{\mathbf{b}} (g_j) \in \Z[x_{k+1,\ldots,x_j}]$ be such that $g_\alpha(\mathbf{x}) = 0$ for all $\mathbf{x} \in C'_\delta$.

    - Compute
    $$
f_\delta := \det\begin{pmatrix}\dfrac{\partial g_{k+1}}{\partial x_{k}} & \cdots & \dfrac{\partial g_{j-1}}{\partial x_{k}} & \dfrac{\partial g_{j}}{\partial x_{k}}\\
\vdots &  &  & \vdots\\
\dfrac{\partial g_{k+1}}{\partial x_{j-1}} & \cdots & \dfrac{\partial g_{j-1}}{\partial x_{j-1}} & \dfrac{\partial g_{j}}{\partial x_{j-1}}
\end{pmatrix},
    $$
from Equation \@ref(eq:jacobi-det), using constraints $g_{k+1},\ldots,g_{\alpha+1}$, and discarding denominators $\partial g_\alpha / \partial x_\alpha$ of the total derivatives in the last column.

  - Let $${\cal H} := \{ g_{k+1},\ldots,g_{j-1}, f_B, f_T \}$$
be a set of polynomials and compute
$$
{\cal F}_{\mathbf{b}} := {\cal F}_{\mathbf{b}} \cup \projop{1}({\cal H}) \subset \Z[x_k].
$$

  - If $j < n$, then

    - Add $g_j$ to $\cal G$, i.e., let
      $$
      {\cal G} := {\cal G} \cup \{ g_j \}.
      $$

    - Let $j := j+1$.

    - Let
      $$
      C' := \projop{j}(C)
      $$
      $C'$ is a section cell, and its top and bottom may not be graphs of continuous functions. Use QE to compute
      $$
      ...
      $$

- For each $(0,\ldots,0)$-cell $\mathbf{b} \in \A^k$, consider
$$
{\cal F}_{\mathbf{b}} \in {\cal F} \in \Z[k],
$$
compute
$$
{\cal R}_{\mathbf{b}} := (c_1,\ldots,c_t)
$$
by isolating the real roots of polynomials in ${\cal F}_{\mathbf{b}}$.

- Return the family ${\cal R}$ of refinement points.
:::

::: { .example #whitney-jhd }
[@jhd20, Example 2.1]

Let $f := y^2 - x^2 z$ and observe that $f(0,0,z) = 0, z \in \R$, i.e., $f$ "blows up" above the origin. Let $\Delta := \{(x,y) \in \R^2 \mid 0 < x < 1, -x < y < x \} \subset \R^2$ and let
$$
W := \{ (x,y,z) \in \R^3 \mid (x,y) \in \Delta, f(x,y,z) = 0 \}.
$$
Consider $\fr{W}$, which can be expressed as the disjoint union of four basic semialgebraic sets:
\begin{align}
\fr{W} =&\ \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y = x, z = 1 \} \\
\cup&\ \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y = -x, z = 1 \} \\
\cup&\ \{ (x,y,z) \in \R^3 \mid x = 1, -1 < y < 1, z = y^2 \} \\
\cup&\ \{ (0,0,z) \in \R^3 \mid 0 \le z \le 1 \}.
(\#eq:jhd-whitney-blow-up)
\end{align}
Due to the blow-up point above the origin, $\fr{W}$ contains the subset $B := \{ (0,0,z) \in \R^3 \mid 0 \le z \le 1 \}$ (from Equation \@ref(eq:jhd-whitney-blow-up)).

A CAD having constant sign on the polynomials
$$
\{ x, x - 1, x + y, x - y, y^2 - x^2 z \}
$$ defining $W$ will not contain the blow-up subset $B$, because two additional polynomials, $z$ and $z-1$, are needed to define it.
:::

::: {.lemma #frontier}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula $F$
containing $s$ different polynomials in $\R [x_1, \ldots ,x_n]$ having maximum degree $d$.
There is an algorithm, taking $F$ as input, which represents the semialgebraic set $\fr{ S }$ by a quantifier-free Boolean formula $F'$ with complexity
$$(sd)^{O(n^2)}.
$$
This is also an upper bound on the number of polynomials in $F'$ and their degrees.
:::

::: { .theorem #lazard-rn }
Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$ be a set of $s$ polynomials with maximum degree $d$.
Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$, compatible with some bounded definable semialgebraic sets $V_1,\ldots,V_k$, which $\dim(V_i) \le 2$ and such that each cell $C \subset V_i$ is monotone.

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ such that each cell $C \subset V_1\cup\ldots\cup V_k$ of $\mathcal{D'}$ satisfies the frontier condition.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{2^{O(n)}},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.definition #laz-properties }
[@lazard10, Definition 2.7]

1. A cylindrical cell $C$ is boundary smooth if the intersection with $C$ of every small open ball centred on the boundary of $C$ is connected
2. A $k$-dimensional cylindrical cell is well-bordered if $\fr{C}$ is the closure of some $k-1$-dimensional cylindrical cells.
3. A cylindrical cell $C$ is boundary coherent if $\fr{C}$ is a union of cells.
:::

::: {.remark}
[@lazard10, Definition 2.7]

These properties can be extended from cells to the whole CAD. I.e., a CAD $\mathcal{D}$ is called well-bordered (resp. boundary coherent, boundary smooth) if every cell in $\mathcal{D}$ is well-bordered (resp. boundary coherent, boundary smooth).
:::

::: {.remark}
If a cylindrical cell satisfies Property 2 of Definition \@ref(def:laz-properties) (boundary smooth) then it is a topologically regular cell.

Property 3 of Definition \@ref(def:laz-properties) (boundary coherent) is the frontier condition (see Definition \@ref(def:frontier-condition)).
@jhd20 call this property closure finiteness.
:::

::: {.definition}
[@lazard10, Definition 2.7]

A CAD is called "strong" if every cell is boundary smooth, well-bordered and boundary coherent.
:::

::: {.definition}
[@lazard10, Definition 4.1]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ and $\mathcal{D'}$ be the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$. A cell $C'$ of $\mathcal{D'}$ is called "bad" if there is a polynomial $f \in \mathbf{F} \subset \Q[x_1,\ldots,x_n]$ such that $f$ is primitive and has positive degree in $x_n$ and $f(\mathbf{x})$, for all $\mathbf{x} \in C'$ vanishes over an open interval. Every point $\mathbf{x}$ in the bad cell $C'$ is a blow-up point of the polynomial $f$ (see Definition \@ref(def:blow-up-point)).
:::

::: {.corollary #lazard-5-4}
[@lazard10, Corollary 5.4]

Every $\mathbf{F}$-invariant CAD of $\R^n, n \le 3$ is well-bordered.
:::

::: {.lemma #lazard-5-2}
[@lazard10, Proposition 5,2]

Let $\cal D$ be a CAD of $\R^n$ and $\cal D'$ the decomposition induced by $\cal D$ on $\R^{n-1}$. Let $C$ be a cell of $\cal D$ and $C' := \projop{n-1} (C)$ such that $C'$ is well-bordered.
If $p \in \fr{C'}$, then $I := (p \times \R) \cap \fr{C}$ is connected.
$I$ is therefore a point or a closed segment, either bounded or unbounded.
Furthermore, if $C$ is a sector cell, then the set of points of $I$ which do not belong to the boundaries of the section cells delineating $C$ is either empty or an open interval.
:::

::: { .lemma #only-bad-zero-cells }
[@lazard10, Lemma 4.3]

A sign-invariant CAD of $\R^2$ contains no bad cells.

For an $\mathbf{F} \subset \Q[x_1,x_2,x_3]$-invariant CAD $\mathcal{D}$ of $\R^3$, if the decomposition induced by $\mathcal{D}$ on $\R^2$ contains a bad cell, then it is a $(0,0)$-cell.
:::

::: { .lemma #no-blow-up }
[@lazard10, Theorem 4.4]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$ with $C' := \proj_{\R^{n-1}}(C)$. If the decomposition induced by $\cal D$ on $\R^{n-1}$ is strong and none of $C'$ and any cell $D'$ such that $D' \cap \fr{C'} \ne \emptyset$ is bad, $C$ is well-bordered, boundary smooth and $\fr{C}$ is a union of some cells of $\mathcal{D}$.
:::

::: {.proof}
This result follows from the following fact about roots of multivariate polynomials: given a polynomial $f  \in \Q[x_1,\ldots,x_{n-1}][x_n]$, i.e., considered as a univariate polynomial with polynomial coefficients, its complex roots depend continuously on the parameters in the region of the parameter space where the polynomial does not vanish identically. In fact, this is only true in the projective closure of $\mathbb{C}$ as some roots may pass through the point at infinity if the leading coefficient is zero.

First suppose that $C$ is a section cell. I.e., it is a root of some polynomial $f$ and $\fr{C}$ is defined as the limit of this root over the boundary of $C'$. Thus $\projop{n-1}$ is a continuous, injective map from $\fr{C}$ to $\fr{C'}$. This follows from the assumption that the decomposition induced by $\cal D$ on $\R^{n-1}$ is strong and that if the root defining the section $C$ is infinite over some cell $C'' \subset \fr{C'}$, then it is also infinite over $\fr{C''}$.

Now suppose that $C$ is a sector cell. If nonempty, the top $C_T$ and bottom $C_B$ of $C$ are section cells. We complete the proof by describing $W := \fr{C} \setminus (C_T \cup C_B)$.
We will only consider the case where $C \cap \{ \mathbf{x} \times \R \}$ is an open interval bounded from below by a point in $C_B$ and above by a point in $C_T$.

Let $\dim(C) = d + 1$. $\fr{C}$ consists of

- the cells in $\fr{C_B}$ and $\fr{C_T}$, which have dimension $< d$ and are contained in $\fr{C'} \times \R$,
- the intervals (which may be empty) bounded by the points in $\fr{C_B}$ and $\fr{C_T}$, contained in $C' \times \R$. Since $C_B$ and $C_T$ are section cells, they are roots of polynomials $f$ and $g$ and, if finite, the points in $\fr{C_B}$ and $\fr{C_T}$ are also roots of $f$ and $g$ (respectively). Therefore, these intervals are contained in some cells of $\cal D$. More precisely, the cells with dimension $d$ contained in $\fr{C'} \times \R$ are exactly those lying over a cell $C'' \subset \fr{C'}$ with dimension $d-1$.

A cell of dimension $< d$ either belongs to $\fr{C_B}$ or $\fr{C_T}$, or is a sector over a cell $D \subset \fr{C'}$ having dimension less than $d-1$.
As $C'$ is well-bordered, $D$ belongs to the boundary of some cell $E \subset \fr{C'}$ having dimension $d-1$.
Thus, the sector above $D$ is contained in the boundary of the sector above $E$, which has dimension $d$

This proves that, if the decomposition induced by $D$ on $\R^{n-1}$ is strong, then $C$ is well-bordered and also satisfies the frontier condition. In addition, this proves that $C$ is a topologically regular cell as $C$ and $\fr{C}$ are either homeomorphic to $C'$ and $\fr{C'}$, if $C$ is a sector cell, or to an open cylinder, either bounded or unbounded, and its boundary. It is clear that an open cylinder contained in $C' \times \R$, where $C'$ is topologically regular, is also topologically regular.

The other cases are deduced by omitting the cells defined from $C_B$ and $C_T$ as appropriate.
:::

::: {.lemma #lazard-5-13}
[@lazard10 Proposition 5.13]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^3$ and $C$ be a well-bordered, boundary smooth cell of $\mathcal{D}$.
Suppose that $D$ is a cell of $\mathcal{D}$ such that $B := D \cap \fr{ C } \neq \emptyset$ and $B \neq D$. Then either

  1. $C$ is a $1$-dimensional section cell whose endpoint, $B$, projects on a bad cell, or
  2. there exists a cell $E$ of $\mathcal{D}$ such that $\dim(E) < \dim(C)$ and $\emptyset \neq D \cap \fr{ E } \neq D$.
:::

::: {.proof}
By the proof of @lazard10, Theorem 4.4, $D$ will always be a $(0,0,1)$-cell in the cylinder above a bad cell $D'$.

Consider each case for $C$ by cell index.

- $(1,1,1)$-cell: since $C$ is well-bordered, its boundary is the closure of some 2-dimensional cells of $\cal D$ and $B$ is contained in the union of the boundaries of the 2-cells. Thus, case 2 applies and we can choose an appropriate 2-dimensional cell in $\fr{C}$ for $E$.

- $(1,0,1)$- or $(0,1,1)$-cell, we write $(i,j,1)$-cell where $i+j=1$: observe that $C$ (if bounded) is delineated by some $(i,j,0)$-cells (one-dimensional curve intervals). Take $B$ to be the one-dimensional interval delineated by the endpoints of these cells. Since $B \neq C$, at least one of these endpoints is not a $(0,0,0)$-cell of $\cal D$. Case 2 applies, taking as $E$ the delineating $(i,j,0)$-cell.

- $(1,0,0)$- or $(0,1,0)$-cells: consider the previous case, letting $C = E$.

- $(1,1,0)$-cell: these are necessarily the root of a polynomial $f \in \Q[x_1,x_2,x_3]$ which vanishes identically on $D'$, a $(0,0)$ cell in the decomposition induced by $\cal D$ on $\R^2$.
Let $V_r$ be a small neighbourhood (with radius $r > 0$) centred around $D'$ and consider $V_r'$, the cylinder above the boundary of $V_r$. Since $C$ is a monotone cell, the maximum and minimum values of $x_3$ in this intersection are reached on the boundary of $C$, for sufficiently small $r$. The limits, as $r$ tends to $0$, of this maximum and minimum clearly belong to the boundary of $B$, if these limits do not tend to infinity. Note that both the maximum and minimum cannot be infinite, since this would imply that either $B$ is empty, or coincides with $D$. Therefore, the non-infinite limits are the endpoints of some $1$-dimensional cell belonging to the boundary of $C$. Case 2 applies, taking $E$ to be this $1$-dimensional cell.

- $(0,0,1)$- or $(0,0,0)$-cells: don't satisfy the hypothesis, there is nothing to do.
:::

::: { .proposition #lazard-5-14 }
[@lazard10, Proposition 5.14]
Let $f \in \Q[x_1,x_2,x_3]$ be an irreducible polynomial of the kind
$$f = g_dx_3^d + \ldots + g_1x_3 + g_0$$
with each $g_i \in \Q[x_1,x_2]$, and
$$\mathbf{p} = (p_1,p_2)$$
be a common root of $g_d,\ldots,g_1,g_0$.
Let $g\in \Q[x_1,x_2]$ be an irreducible polynomial having $\mathbf{p}$ as a root.
The limits of the common roots of $f$ and $g$ as $(x_1, x_2) \to \mathbf{p}, (x_1, x_2) \ne \mathbf{p}$ may be computed as solutions of a zero-dimensional
polynomial system.
:::

::: {.proof}
Since $f$ is irreducible, it has at least two coefficients, $g_i,g_j \in \Q[x_1,x_2]$, whose GCD is a constant.
Therefore, any ideal generated by these coefficients has dimension zero. Any ideal containing these coefficients also contains another element, $h$, which is not a multiple of $g$.

The saturation by $h$ of the ideal $\langle f,g \rangle$ is defined as the ideal
$$
S := \langle f, g, 1 - zh \rangle \cap \Q[x_1,x_2,x_3].
$$
The irreducible components of the zero set of $S$ are those of the zero set of $\langle f,g \rangle$ at which $h$ is not identically zero. It follows that the vertical line $\{ x_1 = p_1, x_2 = p_2 \}$ which is part of the zero set of $f$ ,$g$ and $h$, is not contained in the zero set of $S$. Meanwhile, the zero set of $S$ contains the limit points we are interested in finding.

Therefore, the ideal generated by $S$ and the coefficients $g_0,\ldots,g_d$ of $f$ is zero-dimensional and the limits of $\{ f=0,g=0 \}$ as $(x_1,x_2) \to \mathbf{p}$ can be computed as the zeros of $S$.
:::

::: {.proposition #cox-zariski}
[@cox2013 p203, part of Theorem 10]
Let $I,J \subset K[x_1,\ldots,x_n]$ be ideals, then
$\cl{ V(I) \setminus V(J) } \subset V(I : J^\infty)$,
:::

::: {.proof}
We claim that $I \subset I:J \subset I:J^\infty \subset I(V(i0) \setminus V(J))$. We have $I \subset I:J \subset I:J^2 \subset \cdots \subset I:J^\infty$ by the ascending chain condition.
Suppose that $f \in I:J\infty$ and $a \in V(I) \setminus V(J)$. Then $fg^N \in I$ for all $g \in J$ and a suitable (large enough) $N\ge 0$. Since $a \in V(I)$, $f(a)g^N(a) = 0$ (for all $g\in J$ and large enough $N$). Since $a \not \in V(J)$, there exists $f \in J$ and $N \ge 0$ such that $g(a) \ne 0$. Hence $f(a) = 0$ for all $a \in V(I) \setminus V(J)$. We have $f \in I(V(I) \setminus V(J))$. Transitivity of $\subset$ proves the claim. Since $V$ reverses inclusion, we have $= \cl{ V(i) \setminus V(J) } = V(I(V(i) \setminus V(J))) \subset V(I:J^\infty)$.
:::

::: {.algorithm data-latex="Lazard Lifting With Bad Points in $\R^3$"}
[@lazard10, Algorithm 5.15]

**Input:**
$$({\cal A}, {\cal D})$$

  - ${\cal A} = {\cal A}_1,{\cal A}_2,{\cal A}_3$ is the family of projection polynomials, each $\mathcal{A}_k \subset \Q[x_1,\ldots,x_k]$,

  - $\cal D$: is an $\mathcal{A}$-invariant CAD of $\R^3$ such that every cell of $\mathcal{D}$ is a topologically regular cell.

**Output:**

$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} = \{ c_1,\ldots,c_t \} \subset \A \mid \mathbf{b} \in \R^{2} \text{ is a } (0,0) \text{-cell in the decomposition induced by } {\cal D} \text{ on } \R^2 \}
$$

A set of refinement points, as described in Section \@ref(sec:monotone-algorithm).

- Let ${\cal R} = \emptyset$.

- Let $\cal D'$ be the decomposition induced by $\cal D$ on $\R^2$.

- For each $(0,0)$-cell $\mathbf{b}$ of $\cal D'$, determine whether it is a bad cell.

  $\mathbf{b}$ is a bad cell if there exists a polynomial $f \in {\cal A}_3$ such that $f$ has constant sign on a $(0,0,1)$-cell $C$ of $\cal D$ such that $\mathbf{b} = \projop{2}(C)$.

  (Note: this is an easy check -- simply look at the signs of polynomials in $\mathcal{A}_3$ on $C$. This is part of the information stored about $C$.)

- If $\mathbf{b}$ is bad:

  - Let $g_1 \in {\cal A}_1, g_2 \in {\cal A}_2$ such that $g_1(\mathbf{b}) = 0$ and $g_2(\mathbf{b}) = 0$ (find $g_1$ and $g_2$ using signs of projection polynomials on $\mathbf{b}$).

  - Let ${\cal A'} := {\cal A}_1 \cup {\cal A}_2$.

  - For each $g \in {\cal A'}$, do

    - If $g \in \Q[x_1]$, then $h := g_2$. Otherwise, $g \in \Q[x_1,x_2]$ and $h := g_1$.

    - Define the saturation
    $$
    I := \langle f, g, 1 - z h \rangle \cap \Q[x_1,x_2,x_3],
    $$
    where $z$ is a new variable.

    - Compute a generator system $S$, i.e., a Groebner basis for the ideal $I$.

    - Compute
    $$
    L := \{ {\mathrm{sub}}_{\mathbf{b}}(f') \in \Q[x_3] \mid f' \in S \}
    $$
    and find the real roots
    $$
    (c_1,\ldots,c_t)
    $$
    of $L$.

    - Let
    $$
    {\cal R} := {\cal R} \cup \{ {\cal R}_{\mathbf{b}} = (c_1,\ldots,c_t) \}.
    $$

- return $\cal R$.
:::

::: {.definition #strong-about-c }
Let $\mathcal{D}$ be a CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$. $\mathcal{D}$ will be called strong about $C$ if $C$ is well-bordered, boundary coherent and every cell contained in $\cl(C)$ is boundary smooth.
:::

::: {.theorem #lazard-5-3}
[@lazard10, Theorem 5.3]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^3$ such that the decomposition induced by $\mathcal{D}$ on $\R^2$ is strong. Then every cell $C$ of $\mathcal{D}$ is well-bordered.
:::

::: {.proof}
If $\dim(C) < 2$, then $C$ is well-bordered by @lazard10, Lemma 5.1.

If $\dim(C) = 2$ and $C$ is a $(1,1,0)$-cell, then its boundary consists of some section cells which project onto one-dimensional cells in $\mathcal{D}$ and which are contained in $\fr{C'}$ and points or intervals projecting on some $0$-cells in $\fr{C'}$ by Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2).
We need to prove that these points belong to the boundary of some of the $1$-cells contained in $\fr{C}$.
Let $\mathbf{c}$ be a $0$-cell of $\mathcal{D'}$ contained in $\fr{C'}$ such that $\mathbf{c}$ is the projection of exactly one point, $\mathbf{p}$, in $\fr{C}$.
Since $C'$ is well-bordered (as $\mathcal{D'}$ is strong), there is a $1$-dimensional cell $C'_1 \subset \fr{C'}$ such that $\mathbf{c}$ is an endpoint.
If $C'_1$ is the projection of a $1$-dimensional cell contained in $\fr{C}$, we are done -- the boundary of this one-dimensional cell consists of some isolated points including $\mathbf{p}$.
$C'_1$ is not the projection of a section cell, then the limits of the sequences of points in $C$, whose projections tend to $C'_1$, tend to $-\infty$ or $\infty$. Therefore $\mathbf{p}$ is either $-\infty$ or $\infty$, being an endpoint of the interval $I$ associated to $C$ by Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2). This contradicts the assumption that $\projop{2}^{-1}(\mathbf{c}) \cap \fr{C}$ contains only $\mathbf{p}$.

If $\dim(C) = 2$ and it is a sector ($(i_1,i_2,1)$-cell), then $\fr{C}$ consists of the two $(i_1,i_2,0)$-cells $C_B$ and $C_T$ which project on $C'$ the side-wall $W = \fr{C} \setminus (C_B \cup C_T)$ which consists of points or intervals projecting on the endpoints of $C'$.
If $W$ contains an isolated point above an endpoint $\mathbf{c}$ of $C'$. Then Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2) asserts that it belongs to the boundary of a section bounding $C$ from below or above (i.e., $C_B$ or $C_T$), and we are done.

Finally, suppose that $C$ is a $(1,1,1)$-cell.
By the proof of @lazard10, Theorem 4.4, we only need to consider points in $\fr{C}$ which projects on a bad cell, say $\mathbf{b}$, of $\mathcal{D'}$.
By @lazard10, Lemma 4.3 $\dim(\mathbf{b}) = 0$.
$C_B$ and $C_T$ are $(1,1,0)$-cells, therefore we only need to consider the blow-up subsets $B := (\fr{C} \setminus (\cl{C_B} \cup \cl{C_T})) \cap (\mathbf{b} \times \R)$. By Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2) $B$ is an open interval.
As $C'$ is well-bordered, there is a $1$-dimensional cell $C'_1 \subset \fr{C'}$ such that $\mathbf{b}$ is an endpoint.
The set of points of $\fr{C}$ which project onto $C'_1$ are bounded from below and above by points of $\fr{C_B}$ and $\fr{C_T}$, thus they are $1$-dimensional section cells. The boundaries of these section cells are included in $\fr{C_B}$ and $\fr{C_T}$.
Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2) implies that these sections which project onto $C'_1$ define a (finite and non empty) $2$-dimensional sector cell which projects onto $C'_1$ whose boundary
contains $B$.

As all cases have been considered, this completes the proof.
:::

::: {.proposition #ext-lazard-5-3 }
(Corollary to @lazard10, Theorem 5.3)

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$ of dimension $\le 2$ such that the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$ is strong about $\projop{n-1}(C)$. Then $C$ is well-bordered.
:::

::: {.proof}
If $\dim(C) \le 2$, then it is well-bordered by @lazard10, Lemma 5.1.
If $\dim(C) = 2$ and $C$ is a sector cell, the same argument as in Theorem \@ref(thm:lazard-5-3) (@lazard10, Theorem 5.3) can be applied.

Otherwise, $\dim(C) = 2$ and $C$ is a sector cell. $C' := \projop{n-1}(C)$ is a well-bordered, boundary smooth and boundary coherent $2$-dimensional cell in $\mathcal{D'}$. The same argument as in Theorem \@ref(thm:lazard-5-3) (@lazard10, Theorem 5.3) can be applied to the cells in $\cl{C'} \times \R$, which have dimension $\le 2$ or are sector cells of dimension $3$.
:::

::: {.lemma #ext-lazard-5-13 }
(Extension of Lemma \@ref(lem:lazard-5-13) [@lazard10, Proposition 5.13])

Let $\mathcal{D}$ be a sign-invarient decomposition of $\R^n$ and $C$ be a cell of $\mathcal{D}$ of dimension at most two, such that the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$ is strong about $\projop{n-1}(C)$. Let $D$ be a cell of $\mathcal{D}$ such that $B := D \cap \fr{ C } \neq \emptyset$ and $B \neq D$. Then either

  1. $C$ is a $1$-dimensional section cell whose endpoint, $B$, projects on a bad cell, or

  2. there exists a cell $E$ of $\mathcal{D}$ such that $\dim(E) < \dim(C)$ and $\emptyset \neq D \cap \fr{ E } \neq D$.
:::

::: {.proof}
By the proof of [@lazard10, Theorem 4.4], $D$ will always be a $(0,\ldots,0,1)$-cell in the cylinder above a bad cell $D'$.

We consider each case by cell index.

- $(i_1,\ldots,i_{n-1},1)$-cell, where $\sum_{j=1}^{n-1} i_j = 1$: observe that $C$ (if bounded) is delineated by some $(i_1,\ldots,i_{n-1},0)$-cells (one-dimensional curve intervals). Take $B$ to be the one-dimensional interval delineated by the endpoints of these curves. Since $B \neq C$, at least one of these endpoints is not a $(0,\ldots,0,0)$-cell of $\cal D$. Case 2 applies, taking as $E$ the delineating $(i_1,\ldots,i_{n-1},0)$-cell.

- $(i_1,\ldots,i_{n-1},0)$-cells, where $\sum_{j=1}^{n-1} i_j = 1$: consider the previous case, letting $C = E$.

- $(i_1,\ldots,i_{n-1},0)$-cell, where $\sum_{j=1}^{n-1} i_j = 2$:
$C$ is necessarily the root of a polynomial $f \in \Q[x_1,\ldots,x_n]$ which vanishes identically on $D'$, a $(0,\ldots,0)$ cell in the decomposition induced by $\cal D$ on $\R^{n-1}$.
Let $V_r$ be a small neighbourhood (with radius $r > 0$) centred around $D'$ and consider $V_r'$, the cylinder above the boundary of $V_r$. Since $C$ is a monotone cell, the maximum and minimum values of $x_n$ in this intersection are obtained on the boundary of $C$, for sufficiently small $r$. The limits, as $r$ tends to $0$, of this maximum and minimum clearly belong to the boundary of $B$, if these limits do not tend to infinity. Note that both the maximum and minimum cannot be infinite, since this would imply that either $B$ is empty, or coincides with $D$. Therefore, the non-infinite limits are the endpoints of some $1$-dimensional cell belonging to the boundary of $C$. Case 2 applies, taking $E$ to be this $1$-dimensional cell.

- $(0,\ldots,0,1)$- or $(0,\ldots,0,0)$-cells: do not satisfy the hypothesis, there is nothing to do.
:::

::: {.remark}
Let $C$ be a $(i_1,\ldots,i_{n-1},0)$-cell as described in Lemma \@ref(lem:ext-lazard-5-13) such that $i_1=i_k = 1$ for some $1 \le k \le n$ and all other elements of the index are equal to zero.
The cell $D$, which projects on a bad-cell is necessarily a $(0,\ldots,0,1)$-cell and the cell $E$, which has dimension one, is contained in $\cl{C}$. Hence, $E$ must have index either $(i_1,0\ldots,0)$ or $(0,\ldots,0,i_k,0,\ldots,0)$.
By Proposition \@ref(prp:delete-zero-index) (@bgv15, Lemma 3.3), the images of $C$, $D$ and $E$ under the projection map $\projops{i_1,i_k,i_n}$ are cylindrical cells and satisfy Lemma \@ref(lem:lazard-5-13) (@lazard10, Lemma 5.13).
:::

::: {.conjecture #ext-lazard-5-14}
(Extension of @lazard10, Proposition 5.14)

Let $f \in \Q[x_1,\ldots,x_n]$ be an irreducible polynomial of the kind
$$f = h_dx_n^d + \ldots + h_1x_n + h_0$$
with each $h_i \in \Q[x_1,\ldots,x_{n-1}]$, and
$$\mathbf{p} = (p_1,\ldots,p_{n-1})$$
be a common root of $h_d,\ldots,h_1,h_0$.
Let $g_1,\ldots,g_{n-2}\in \Q[x_1,\ldots,x_{n-1}]$ be irreducible, pairwise relatively prime polynomials having $\mathbf{p}$ as a root.
Then the limits of the common roots of $f$ and $g_{i_1},\ldots,g_{i_{n-2}}$ for $\{i_1,\ldots,i_{n-2}\} = \{1,\ldots,n-1\} \setminus \ell, 1 \le \ell \le n-1$ as $(x_1, \ldots,x_{n-1}) \to \mathbf{p}, (x_1, \ldots, x_{n-1}) \ne \mathbf{p}$ may be computed as the solutions of a system of polynomial equations having dimension zero.
:::

::: {.proof}
Since $f$ is irreducible, it has at least $2$ coefficients, $h_1,h_2 \in \Q[x_1,\ldots,x_{n-1}]$, whose GCD is a constant.
Therefore, any ideal generated by these coefficients has codimension at least two and, since polynomials $g_1,\ldots,g_{n-1}$ are irreducible and pairwise relatively prime, the ideal generated by the coefficients of $f$ and the polynomials, $g_{i_1},\ldots,g_{i_{n-2}}$ has dimension zero.
Any ideal containing these polynomials also contains another element, $g_\ell$, which is not a multiple of any of the $g_{i_1},\ldots,g_{i_{n-2}}$'s.

The saturation by $g_\ell$ of the ideal $\langle f, g_{i_1}, \ldots, g_{i_{n-2}} \rangle$ is defined as the ideal
$$
S := \langle f, g_{i_1}, \ldots, g_{i_{n-2}}, 1 - z g_\ell \rangle \cap \Q[x_1,\ldots,x_n].
$$
The irreducible components of the zero set of $S$ are those of the zero set of $\langle f,g_{i_1},\ldots,i_{n-2} \rangle$ at which $g_\ell$ is not identically zero. It follows that the vertical line $\{ x_1 = p_1, \ldots, x_{n-1} = p_{n-1} \}$ which is part of the zero set of $f$,
$g_{i_1},\ldots,g_{i_{n-2}}$ and $g_\ell$, is not contained in the zero set of $S$.
Meanwhile, the zero set of $S$ contains the limit points we are interested in finding.

Therefore, the ideal generated by $S$, the coefficients $h_0,\ldots,h_d$ of $f$ and the polynomials $g_{i_1},\ldots,g_{i_{n-2}}$ is zero-dimensional and the limits of $\{ f = 0, g_{i_1} = 0, \ldots, g_{i_{n-n}} = 0 \}$ as $(x_1,\ldots,x_{n-1}) \to \mathbf{p}$ can be computed as the solutions of $S$.
:::

::: {.algorithm data-latex="Extension of Lazard's Lifting With Bad Points, for $2$-dimensional cells in $\R^n$"}
[Extension of @lazard10, Algorithm 5.15]

**Input:**
$$({\cal D}, {\cal A})$$

  - $\cal D$: a CAD of $\R^k$, each cell having constant sign on $\mathcal{A}$, A collection of cells $\mathcal{C} := \{ C_1,\ldots,C_m \}$ of $\mathcal{D}$ are marked as being projections of $V_1,\ldots,V_k$.

  - ${\cal A} = {\cal A}_1,\ldots,{\cal A}_k$ is the family of projection polynomials for $\mathcal{D}$, each ${\cal A}_k \subset \Z[x_1,\ldots,x_k]$.

**Output:**

$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} = ( c_1,\ldots,c_t ) \subset \A \mid \mathbf{b} \in \R^{k-1} \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^k \}
$$

A set of refinement points, as described in Section \@ref(sec:monotone-algorithm).

- Let $\cal D'$ be the decomposition induced by $\cal D$ on $\R^{n-1}$.

- For each $(i_1,\ldots,i_{k-1},0)$-cell $E \in \cal{C}$, let $i_{\ell_1} = i_{\ell_2} = 1$, while all other elements in the index are equal to zero.

  - Let $\mathbf{c} := \projop{j_{\ell_1} - 1}(E)$ and compute the set of polynomials for the sub-cad of $\mathcal{D}$ above $\mathbf{c}$.

    I.e., Let $C := \projops{i_\ell,\ldots,i_k}(E)$ be an $(i_{\ell_1},\ldots,i_{k-1},0)$-cell in the sub-cad of $\mathcal{D}$ above $\mathbf{c}$. Compute the substitution of polynomials
    $$
    \mathcal{A'}_{j} := \{ {\mathrm{sub}}_{\mathbf{c}} (f) \in \Z[x_{\ell_1},\ldots,x_j] \mid f \in \mathcal{A}_{i_{\ell_1} - 1 + j} \}
    $$
    for $i_{\ell_1} \le j \le k$.

  - Find, by examining signs of projection polynomials associated to $C$, polynomials
    $$
    (g_{j_1},\ldots,g_{k-3}, f), g_j \in \mathcal{A'}_j, j \in \{\ell_1 + 1,\ldots,k-1\} \setminus \{ \ell_2 \}, f \in \mathcal{A'}_k
    $$
    such that $C \subset \{ \mathbf{x} \in \R^{k-\ell_1 + 1} \mid (g_{j_1}(\mathbf{x}) = 0,\ldots,g_{k-3}(\mathbf{x}) = 0, f(\mathbf{x}) = 0 \}$.

  - Determine whether any point on the frontier of $C$ projects on a bad cell. I.e., check if there is a $(0,\ldots,0,1)$-cell $D$, by examining signs of projection  polynomials, such that $f(\mathbf{x}) = 0$ for all $\mathbf{x} \in D$.

    I.e., all of $g_{j_1},\ldots,g_{j_{k-3}},f$ should be equal to zero on $D$.

  - For each $D$ projecting on a bad cell, let $\mathbf{b} := \projop{k-1}(D)$.

    Since $\mathbf{b}$ is a $(0,\ldots,0)$-cell, polynomials $g_{j_1},\ldots,g_{j_{k-3}}$ are equal to zero on $\mathbf{b}$ and there are two more polynomials $g_{\ell_1} \in \mathcal{A'}_{\ell_1}, g_{\ell_2} \in \mathcal{A'}_{\ell_2}$ which are equal to zero on $\mathbf{b}$.

    - Compute saturations $$
    I_1 := \langle f, g_{j_1}, \ldots, g_{j_{k-3}}, g_{\ell_2}, 1 - z g_{\ell_1} \rangle \cap \Z[x_1,\ldots,x_k]
    $$
    and
    $$
    I_2 := \langle f, g_{j_1}, \ldots, g_{j_{k-3}}, g_{\ell_1}, 1 - z g_{\ell_2} \rangle \cap \Z[x_1,\ldots,x_k],
    $$
    where $z$ is a new variable.

    - Compute generator systems $S_1, S_2$ for $I_1,I_2$ respectively.

      This may be done by computing a Groebner basis eliminating $z$.

    - Finally, to obtain  refinement polynomials for $D$, substitute
    $$
    L := \{ {\mathrm{sub}}_{\mathbf{b}}(f) \in \Q[x_k] \mid f \in S_1 \cup S_2 \}.
    $$

    - Refinement points are the roots
    $$
    (c_1,\ldots,c_t)
    $$
    of polynomials in $L$.

    - Let
    $$
    {\cal R} := {\cal R} \cup \{ {\cal R}_{\mathbf{b}} = (c_1,\ldots,c_t) \}.
    $$

- return $\cal R$.
:::

::: {.example #sphere}
Let $n = 3$ and consider the unit sphere
$$
S := \{ (x,y,z) \in \R^3 \mid x^2 + y^2 + z^2 - 1 = 0 \}.
$$
:::

::: {.example #qanm}
Let $n = 3$ and consider the 2-dimensional section cell
$$
C := \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y > 0, x + y^2 < 1, z = x^2 + y^2 \}.
$$
:::

::: {.example #fr-3-whitney-jhd }
[@jhd20, Example 2.1]

Let $n = 3$ and consider the $(1,1,0)$-cell
$$
C = \{ (x,y,z) \in \R^3 \mid 0 < x < 1, -x < y < x, y^2 - x^2 z = 0 \}.
$$
:::

::: {.example #top-bottom-not-cylindrical}
[@bgv15, Example 3.2]
Let
$$
C' = \{ (x,y) \in \R^2 \mid -1 < x < 1, \vert x\vert < y < 1 \}
$$
be a cylindrical sector cell in $\R^2$ and $C$ be the graph of $\varphi\vert_{C'}$, where
$$
\varphi(x,y) = \vert x/y\vert.
$$
$C$ is a cylindrical section cell in $\R^3$, according to Definition \@ref(def:cells), despite the fact that $\varphi\vert_{C'}$ is not analytic.
Consider the bottom of $C$
$$C_B = \{ (x,y,z) \in \R^3 \mid -1 < x < 1, x \ne 0, y = \vert x\vert, z = 1 \} \cup \{(0,0,z) \mid 0\le z \le 1\}.$$
Due to the blow-up of $\varphi$ at the origin, $C_B$ is not a cylindrical cell.
Note that $C_B$ does not contain all points at which $\varphi$ vanishes.
:::

::: {.theorem #main}
Let $S \subset \R^n$ be a semialgebraic set defined by a QFF $F$ with $s$ different polynomials of maximum degree $d$ in $\R[x_1,\ldots,x_n]$.
There is an algorithm, taking $F$ as input, which outputs a cylindrical decomposition $\mathcal D$ of $\R^n$ compatible with $S$ and
satisfying the frontier condition.
The complexity of this algorithm is $(sd)^{O(1)^{n2^n}}$.
This is also an upper bound on the number of cells in $\mathcal D$, number of polynomials defining cells and their degrees.
:::

::: {.remark}
The algorithm from Theorem \@ref(thm:main) is understood as a Blum-Shub-Smale (BSS) real numbers machine [@blum1998].
A similar statement is also true for the Turing machine model, in which case the complexity bound
depends, in addition, polynomially on maximal bit-size of coefficients (cf. @collins1975).
:::

::: {.theorem #proj}
Let $\mathcal{D}$ be a CAD of $\R^n$ compatible with a semialgebraic set $S\subset \R^n$ and satisfying the frontier condition.
Then the decomposition induced by $\mathcal{D}$ on $\R^{k}$ for all $1\le k < n$ is a cylindrical decomposition of $\R^k$ compatible with $\proj_{\R^k}(S)$ and satisfying the frontier condition.
:::

::: {.lemma #frontier}
Let $S \subset \R^n$ be a semialgebraic set defined by a QFF $F$
containing $s$ different polynomials in $\R [x_1, \ldots ,x_n]$ having maximum degree $d$.
There is an algorithm, taking $F$ as input, which represents the semialgebraic set $\fr{S}$ by a QFF $F'$ with complexity $(sd)^{O(n^2)}$.
This is also an upper bound on the number of polynomials in $F'$ and their degrees.
:::

::: {.proof}
Observe that $\fr{S}$ can be represented by a first-order Boolean formula
\begin{equation}
(\#eq:frontier-first-order)
\fr{S} = \left\{ \mathbf{x} \in (\R^n \setminus S) \mid \forall \varepsilon >0\> \exists \mathbf{y} \in S\> (\Vert \mathbf{x} - \mathbf{y} \Vert < \varepsilon ) \right\}.
\end{equation}
Using singly-exponential quantifier elimination algorithm [@bpr2006, Algorithm 14.21], we represent $\fr{S}$
as a QFF $F'$ with the bounds required in the lemma.
:::

::: {.lemma #fr-lex-less}
Let $\mathcal{D}$ be a CAD of $\R^n$ and let $C$ be a cell of $\mathcal{D}$ with index $M$.
Then $\fr{C}$ is contained in a union of cells of $\mathcal{D}$ with indices lexicographically less than $M$.
:::

::: {.proof}
Proceed by induction on $n$.

When $n=1$, the cell $C$ either has index $M=(0)$ or $M=(1)$.
If $M=(0)$ then $C$ is a single point and its frontier is empty.
If $M=(1)$, $C$ is an open interval. By the definition of CAD, endpoints of $C$ are $(0)$-cells.

Now let $n>1$ and let $C$ have index $M=(i_1,\ldots,i_n)$.
The projection $C'=\proj_{\R^{n-1}}(C)$ is a cell in the induced decomposition $\mathcal{D'}$ of $\R^{n-1}$
with index $(i_1,\ldots,i_{n-1})$.
By the induction hypothesis, $\fr{C'}$ is contained in a union of cells of $\mathcal{D'}$ with indices
$(j_1,\ldots,j_{n-1}) \lex (i_1,\ldots,i_{n-1})$. I.e., by definition we have
\begin{equation}
i_1=j_1,\ldots,i_{k-1} = j_{k-1} \text{ and } i_k < j_k \text{ for some } 1 \le k \le n - 1.
(\#eq:fr-lex-less-hyp)
\end{equation}

If $i_n=0$, then $C$ is a section cell.
Its frontier $\fr{C}$ is contained in $\fr{C'} \times \R$ and, therefore, in a union of
cells of $\mathcal D$ with indices $(j_1,\ldots,j_{n-1}, j_n)$ for some $j_n \in \{ 0,1 \}$.
Since the property in Equation \@ref(eq:fr-lex-less-hyp) still holds, we have shown that $(j_1,\ldots,j_{n-1}, j_n) \lex M$.

If $i_n=1$, then $C$ is a sector cell.
In this case, $\fr{C}$ is contained in $(\fr{C'} \times \R) \cup C_T \cup C_B$, hence in the
union of cells of $\mathcal D$ with indices $(j_1,\ldots,j_{n-1}, j_n)$ for some $j_n \in \{0,1\}$,
and two cells, $C_T$ and $C_B$, having the same index $(i_1,\ldots,i_{n-1},0) \lex (i_1,\ldots,i_{n-1},1)$.
All of these indices are lexicographically less than $M$.
:::

::: {.lemma #section-split}
Let $f: X \to \R$ be a continuous definable function on a set
$X \subset \R^n$ having the graph $F \subset \R^{n+1}$, such that $F$ is a semialgebraic set.
Let $G$ be a semialgebraic subset, closed in $F$, of dimension less than $\dim (F)=n$.
Then $\frt_{F}(F \setminus G) = G$, where $\frt_F$ denotes the frontier in $F$.
:::

::: {.proof}
Let $Y = \proj_{\R^{n}}(G)$ and observe that $X = \proj_{\R^{n}}(F)$ and, since semialgebraic sets are closed under projection, observe that both $X$ and $Y$ are semialgebraic.
We will prove that $\frt_X(X \setminus Y) = Y$.
By the definition of frontier, we have
$$\frt_X(X \setminus Y)=\cls_X(X \setminus Y) \setminus (X \setminus Y),$$
where $\cls_X$ denotes the closure in $X$.

We need to prove that $\cls_X(X \setminus Y) = X$.
Since $Y$ is a semialgebraic set, it is the union of some basic semialgebraic sets
\begin{equation}
S_i = \{ \mathbf{x} \in \R^n \mid f_1(\mathbf{x}) = 0, \ldots, f_k(\mathbf{x}) = 0, g_1(\mathbf{x}) > 0, \ldots, g_\ell(\mathbf{x}) > 0 \}
(\#eq:basic-semialgebraic)
\end{equation}
of dimension $< n$.
Each $S_i$ is contained in a hypersurface $V_i = V(f_{i})$, where $f_i$ is one of the polynomial equations defining $S_i$ in Equation \@ref(eq:basic-semialgebraic).
Let $Z = \bigcup_i V_i = \bigcup_i V(f_{i}) = V(\prod f_i)$ be a closed set which contains $Y$.
We may replace $Y$ with $Z$, and prove that
$$
\cls_X(X \setminus Z) = X \supset Z \cap X
$$
because $(X \setminus Z) \subset (X \setminus Y)$ implies $\cls_X(X \setminus Z) \subset \cls_X(X \setminus Y)$.

When considering $\cls_X$, we view $X$ as a topological space and consider only the points of $Z$ which are contained in $X$.

We prove that
$$
Z \cap \cls_X(X \setminus Z) \supset Z \cap X
$$
and claim that every $\mathbf{x} \in X \cap Z$ is a point of $\cls_X(X \setminus Z)$.
I.e., since we view $X$ as a topological space, even if $X$ is not an open set, by the definition of closure, there is a small real number $r > 0$ such that the open ball $B(\mathbf{x},r)$ is contained in $X \setminus Z$.
Assume for contradiction that this is false. Then $B(\mathbf{x}, r) \cap (X \setminus Z) = \emptyset$.
It follows that $B(\mathbf{x},r)$ must be contained in $Z$, but this is impossible because a set of dimension $< n$ cannot contain an $n$-dimensional open ball.

Finally, since $f$ is a continuous function, and therefore $Y$ and $X$ are homeomorphic to $G$ and $F$
respectively, we obtain the required formula $\frt_{F}(F \setminus G) = G$.
:::

::: {.proof}
(of Theorem \@ref(thm:proj))

Let $\mathcal{D}$ be the cylindrical decomposition of $\R^n$ which satisfies the frontier condition and let $\mathcal{D}'$ be the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$.
Let $C'$ be a cell of $\mathcal{D}'$. We claim that $C'$ satisfies the frontier condition and prove that $\cl{C'}$ is a union of cells of $\mathcal{D'}$.
Consider the cylinder $C' \times \R$.
$\cl{C' \times \R}$ can be written as a first-order Boolean formula
\begin{equation}
(\mathbf{x'},x_n) \in \R^n \mid \forall \varepsilon > 0\> \exists (\mathbf{y'},y_n) \in C' \times \R \> (\Vert (\mathbf{x'},x_n) - (\mathbf{y'},y_n) \Vert < \varepsilon ).
(\#eq:closure-quantifiers)
\end{equation}
Since $C' \times \R$ is a union of cells of $\mathcal{D}$ and $\mathcal{D}$ satisfies the frontier condition,
it follows that every point $(\mathbf{x'},x_n) \in \cl{C' \times \R}$ belongs to $\cl{C}$ for some cell $C$ of $\mathcal{D}$ in $C' \times \R$. Hence, $\cl{C' \times \R}$ is a union of cells of $\mathcal{D}$.

It is clear that, if $(\mathbf{x'}, x_n) \in \cl{C' \times \R}$, then $\proj_{\R^{n-1}}((\mathbf{x'}, x_n)) = \mathbf{x'} \in \proj_{\R^{n-1}}(\cl{C' \times \R})$. Hence $\proj_{\R^{n-1}}(\cl{C' \times \R}) = \cl{C'}$ and, by the cylindrical property, since $\cl{C' \times \R}$ is a union of cells of $\mathcal{D}$, $\cl{C'}$ is a union of cells of $\mathcal{D'}$.

The proof is completed, for decompositions induced by $\mathcal{D}$ on $\R^k, 1 \le k \le n-1$, by iterating this argument for successive projections.
:::

::: {.algorithm #algorithm-main data-latex="CadFC"}
$$
{\mathcal D} := \mathrm{CadFC}(F)
$$

**Input:**
$F$: a QFF representing a semialgebraic set $S \subset \R^n$.

**Output:**
A CAD $\mathcal D$ of $\R^n$ compatible with $S$ and satisfying the frontier condition.

**Complexity:**
$$(sd)^{O(1)^{n2^n}}$$
where $F$ contains $s$ different polynomials of maximum degree $d$ in $\Z[x_1,\ldots,x_n]$.

- Initialise $M = (i_1,\ldots,i_{n-1}) := (1,\ldots,1) \in \{0,1\}^{n-1}$.

- Let $\mathcal{E}_M :=  \bf{true} \ \&\ \{ F \}$, where $\bf{true}$ is the trivial CAD of $\R^n$, be the initial CAD.

- Define the initial pair
$({\mathcal E}_M, \mathcal{F}_M):=({\mathcal E}, \emptyset)$.

  $\mathcal{E}_M$ is a refinement of $\mathcal{E}$ and $\mathcal{F}_M$ is a set of QFFs, each defining a semialgebraic set contained in a union of cells of $\mathcal{E}_M$ with index $\lexeq (i_1,\ldots,i_{n-1},1)$.

- While $(0,\ldots,0) \lex M$, do


  - Let $N := {\rm Decrement} (M)$.

  - Compute $\mathcal{E}_N := \mathcal{E}_M\ \&\ {\mathcal F}_M$.

  - Let $\mathcal{A}_0$ be the family of QFFs defining all cells of $\mathcal{E}_N$ with index $(i_1,\ldots,i_{n-1},0)$

  - and $\mathcal{A}_1$ be the family of QFFs defining all cells of $\mathcal{E}_N$ with index $(i_1,\ldots,i_{n-1},1)$.

  - Compute the set of frontiers
\begin{align*}
{\mathcal F}_{N,0} =\ & \left\{ \fr{F_0} \mid F_0 \in \mathcal{A}_0 \right\}, \\
{\mathcal F}_{N,1} =\ & \left\{ \fr{F_1 \land \neg( F_{1,B} \lor F_{1,T} )} \mid F_1 \in \mathcal{A}_1, F_{1,B}, F_{1,T} \in \mathcal{A}_0 \right\}, \\
{\mathcal F}_N =\ & {\mathcal F}_{N,0} \cup {\mathcal F}_{N,1}, \\
\end{align*}
where $F_{1,B}$ (resp. $F_{1,T}$) is a QFF defining the bottom (resp. top) of the sector cell defined by $F_1$, or $\mathbf{false}$ if the bottom (resp. top) does not exist.

  - Let $M := N$.

- Return ${\mathcal E}_{(0,\ldots,0)}$.
:::

::: {.proof}
(of Theorem \@ref(thm:main))

Let $L=(k_1, \ldots ,k_{n-1})$ be the index immediately prior to $N=(j_1, \ldots ,j_{n-1} )$ with respect to $\lex$.
The algorithm computes ${\mathcal E}_L$ as the refinement of ${\mathcal E}_N$ compatible with each set represented by a formula in $\mathcal{F}_N$. This is the set $X_N$ defined in Equation \@ref(eq:front).
Suppose that the algorithm has computed the final decomposition $\mathcal{D}$, as the refinement of $\mathcal{E}_{\mathbf{0}}$ compatible with $\mathcal{F}_{\mathbf{0}}$ in the sequence \ref{eq:sequence}. Now construct a new sequence of decompositions (from left to right)
\begin{equation}
\mathcal{E}'_{\mathbf{0}} \lex \cdots \lex \mathcal{E}'_L \lex \mathcal{E}'_N \lex \mathcal{E}'_M \lex \cdots \lex \mathcal{E}'_{(1,\ldots,1)}
(\#eq:seq-ind-hyp)
\end{equation}
where the initial element $\mathcal{E}'_{\mathbf{0}}$ is the refinement of $\mathcal{E}_{\mathbf{0}}$ compatible with each cell of $\mathcal{D}$ and each $\mathcal{E}'_I$ is the refinement of $\mathcal{E}_I$ compatible with all cells of $\mathcal{E}'_J$, where $J$ is the index immediately prior to $I$ with respect to $\lex$.
We want to prove that every cell in $\mathcal{E}'_L$ with index $\lexeq (i_1,\ldots,i_{n-1},1)$ satisfies the frontier condition.

If $C$ is a cell in ${\mathcal E}_N$ with index $(i_1, \ldots ,i_{n-1},0)$ (section cell),
then $C$ is a union of cells of ${\mathcal E}_L$ and, hence, of $\mathcal{E}'_L$, with indices $\lexeq (i_1, \ldots ,i_{n-1} ,0)$.
Let $C' \subset C$ be one of the cells in this refinement of $C$ with index $(i_1, \ldots ,i_{n-1} ,0)$ and $B$ be
the union of cells contained in the refinement of $C$ with indices $\lex (i_1, \ldots ,i_{n-1} ,0)$.
Let $B' \subset B$ be a cell of ${\mathcal E}_L$ with index $(m_1,\ldots,m_{n-1},0) \lex (i_1,\ldots,i_{n-1},0)$. We claim that $\dim(B') < \dim(C)$.
Indeed, on the one hand, if $i_k = 0$, for some $1\le k \le n-1$, then $m_k = 0$ as well. Otherwise, $\proj_{\R^k}(C)$ is a section cell which must contain $\proj_{\R^k}(B')$, which is a sector cell, but this is impossible.
On the other hand, by the definition of $\lex$, there exists some $1\le \ell \le n-1$ such that $m_1 = i_1, \ldots, m_{\ell-1} = i_{\ell-1}$ and $m_\ell = 0, i_\ell = 1$. This implies that $\dim(B') = m_1 + \cdots + m_{n-1} < i_1 + \cdots + m_{n-1} = \dim(C)$ as required. It follows that $\dim(B) < \dim(C)$ and $B$ is closed in $C$.
According to Lemma \@ref(lem:section-split), $\frt_C (C \setminus B)=B$ where $\frt_X(Y)$ denotes the frontier of $Y$ in $X$.
Hence, $\frt_C (C') \subset B$.
On the other hand, $\fr{C'} \setminus \frt_C (C')$ is a subset of $\fr{C}$, which is a union of cells of $\mathcal{E}_L$ (and of the refinement $\mathcal{E}'_L$) with index $\lex (i_1,\ldots,i_{n-1},0)$.

By the induction hypothesis, all cells of $\mathcal{E}'_L$ with index $\lex (i_1,\ldots,i_{n-1},0)$ satisfy the frontier condition. In particular, $\fr{C}$ and $\fr{B}\subset \fr{C}$ is a union of cells of $\mathcal{E}'_L$.
It follows from the cylindrical structure of $\mathcal{E}'_L$ that $C'$ satisfies the frontier condition.

If $C$ is a cell in ${\mathcal E}_N$ with index $(i_1, \ldots ,i_{n-1} ,1)$ (sector cell),
then $C$ is a union of cells of ${\mathcal E}_L$ with indices $\lexeq (i_1, \ldots ,i_{n-1} ,1)$.
A similar argument to that used for section cells shows that each cell $C'$ in this union,
having index $(i_1, \ldots ,i_{n-1} ,1)$, satisfies the frontier condition in $\mathcal{E}'_L$. Note that when using
Lemma \@ref(lem:section-split) we consider sector cell $C$ as a graph of a constant function over itself.

Finally, each decomposition $\mathcal{E}'_I$, $I \in \{0,1\}^{n-1}$, in the sequence \ref{eq:seq-ind-hyp} coincides with $\mathcal{D}$. Indeed, $\mathcal{D}$ is a refinement of $\mathcal{E}_I$ and $\mathcal{E}'_I$ is a refinement of $\mathcal{E}_I$ compatible with all cells of $\mathcal{D}$. In other words, no refinement of $\mathcal{D}$ is required to obtain $\mathcal{E}'_{(1,\ldots,1)}$.
It follows that every cell of $\mathcal{D}$ satisfies the frontier condition.
:::

::: {.example #qanm-3-alg }
Let $n = 3$ and consider the 2-dimensional section cell
$$
C := \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y > 0, y - x^2 + 2x < 1, z = x^2 + y^2 \}.
$$
:::

::: {.example #qanm-4-rat }
Let $n = 4$ and consider the semialgebraic set defined by the QFF
$$
F := ( ( 4 w = 7 \lor w^2 = 36 ) \land x > 0 \land x < 1 \land y > 0 \land x + y < 1 \land z = w x^2 + y^2 ).
$$
It has three connected components, $C_1$, $C_2$ and $C_3$, each of which is a cylindrical section cell in a sub-CAD of $\R^3$ above a $0$-dimensional cell ($\mathbf{b}_1$, $\mathbf{b}_2$, $\mathbf{b}_3$ respectively). 
\begin{align}
\mathbf{b}_1 &= 7/4, &C_1 = \{ (x,y,z) \in \R^3 \mid x > 0 ,x < 1 ,y > 0 ,x + y < 1 ,z = 7/4 x^2 + y^2 \}.\\
\mathbf{b}_2 &= -6, &C_3 = \{ (x,y,z) \in \R^3 \mid x > 0 ,x < 1 ,y > 0 ,x + y < 1 ,z = -6 x^2 + y^2 \}.\\
\mathbf{b}_3 &= 6, &C_3 = \{ (x,y,z) \in \R^3 \mid x > 0 ,x < 1 ,y > 0 ,x + y < 1 ,z = 6 x^2 + y^2 \}.
\end{align}

$C_2$ is already monotone. This can be seen by examining the projections of its top and bottom onto $\opspan{x,z}$: 
\begin{align}
C_{2,B} &= \{ -1 < x < 1, z = -6x^2 \},\\
C_{2,T} &= \{ -1 < x < 1, z = -5x - 2x + 1 \}.
\end{align}

$C_1$ and $C_3$ are of the same kind as the cell presented in Example \@ref(exm:qanm) and require refinement. 
:::

::: {.example #qanm-4-above-alg }
Let $n = 4$ and consider the section cell
$$
C := \{ (w,x,y,z) \in \R^4 \mid w > 0, w^2 = 2, 0 < x < 1, y > 0, x + y < 1, z = 3x^2 + 2y^2 \}.
$$
:::

::: {.example #qanm-4-alg }
Let $n = 4$ and consider the section cell
$$
C := \{ (w,x,y,z) \in \R^4 \mid w > 0, w^2 = 3, 0 < x < 1, y > 0, y < (x-1)^2, z = 3x^2 + 2y^2 \}.
$$
:::

::: {.example #qanm-4-multi }
Let $n = 4$ and consider the section cell
$$
C := \{ (w,x,y,z) \in \R^4 \mid  0 < w < 1, x > 0, w + x < 1, y = w^2 + x^2, z = 2 w^2 + x^2 \}.
$$
:::

::: {.example #qanm-5-101 }
Let $n = 5$ and consider the $(1,0,1,0,0)$-cell
$$
C = \{ (w,x,y,z) \in \R^4 \mid 0 < w < 1, x = 1 - w, y > 0, w + y < 1, z = w^2 + x y^2, t = 3 w^2 + x^2 y^2 \}.
$$
:::

::: {.example #fr-4-whitney-multi }
Let $n = 4$ and consider the semialgebraic set defined by the QFF, containing polynomials in $Z[t,x,y,z]$,
$$
F = \{ (t = 0 \lor t = 2) \land 0 < x < 1 \land -x < y < x \land y^2 - x^2 (z - t) = 0 \}.
$$
:::

::: {.example #fr-4-whitney-alg }
Let $n = 4$ and consider the twe $2$-diemnsional subsets of the Whitney whitney umbrella defined by the QFF
$$
F = \{ (t,x,y,z) \in \R^4 \mid t^2 = 0 \land 0 < x < 1 \land -x < y < x \land y^2 - x^2 (z - t) = 0 \}.
$$
:::

::: {.definition}
[@vdd1998, Section 2.19]
We say that a cylindrical cell $C \subset \R^n$ is Van-den-Dries regular if, for all $i \in \{1,\ldots,n\}$, if two distinct points $\mathbf{x},\mathbf{y} \in C$ are such that $x_1 = y_1, \ldots, x_{i-1} = y_{i-1}, x_{i+1}, \ldots, x_n = y_n$, but $x_i < y_i$, then for all $z_i$ such that $x_i < z_i < y_i$, $(x_1,\ldots,x_{n-1},z_i,x_{i+1},\ldots,x_n) \in C$.
:::

::: {.theorem #strat }
Let
$$
X := \{ \mathbf{x} \in \R^n \mid f_1 = 0, \ldots, f_k = 0, g_1 > 0, \ldots, g_\ell > 0 \},
$$
be a semialgebraic set defined by $s = k + \ell$ different polynomials of maximum degree $d$.
Then there is an algorithm, without oracle, which partitions $X$ into a family
$$
{\cal X} = (X_0, \ldots, X_n)
$$
such that, if $X$ is nonsingular, $X_0 = X$ and all other sets are empty.
Otherwise, $X_0 = \emptyset$ and each $X_k, 1 \le k \le n$ is a possibly empty, effectively nonsingular stratum of codimension $k$.
This algorithm has complexity
$$
3^{s}\left(s(d+1)\right)^{O(n)^{2}}.
$$
The number of strata does not exceed $s^{n} (d + 1)^2$, and each stratum is defined by at most $s (d + 1)^2$ polynomial equations and inequalities of maximum degree $(d + 1)^2$.
:::

::: { .proposition #bgv-main }
[@bgv15, Theorem 3.20]

Let $V_1, \ldots, V_k$ be bounded deﬁnable subsets in $\R^n$ with $\dim V_i \le 2$ for each $1 \le i \le k$.
Then there is a cylindrical cell decomposition of $\R^n$ satisfying the frontier condition, and monotone with respect to each $V_1, \ldots, V_k$.
:::

::: { .theorem #bgv-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas containing $s$ different polynomials $\mathbf{F} = \{ f_1,\ldots, f_s \} \in \Z[x_1,\ldots,x_n]$, having maximum degree $d$, such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.

Then there is an algorithm, taking $F_1,\ldots,F_k$ as input, which constructs a cylindrical algebraic decomposition $\mathcal{D}$ of $\R^n$ satisfying the frontier condition, and monotone with respect to each $V_1, \ldots, V_k$.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: { .theorem #bgv-quasi-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas containing $s$ different polynomials $\mathbf{F} = \{ f_1,\ldots, f_s \} \in \Z[x_1,\ldots,x_n]$, having maximum degree $d$, such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.

Then there is an algorithm, taking $F_1,\ldots,F_k$ as input, which constructs an $\mathbf{F}$-invariant CAD $\mathcal{D}$ of $\R^n$, which is obviously compatible with each $V_1,\ldots,V_k$, such that each cell $C \subset V_1\cup \ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: { .theorem #bgv-monotone-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.
Let $\mathbf{F} = \{f_1,\ldots,f_s\}$ be a set of polynomials in $\Z[x_1,\ldots,x_n]$ of maximum degree $d$ and $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ compatible with each $V_1,\ldots,V_k$ and such that each cell $C \subset V_1\cup\ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map.

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ monotone with respect to each $V_1, \ldots, V_k$.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: { .theorem #lazard-rn }
Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$ be a set of $s$ polynomials with maximum degree $d$.
Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$, monotone with respect to each bounded semialgebraic set $V_1,\ldots,V_k$ ($\dim(V_i) \le 2 1\le i \le k$).

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ such that each cell $C \subset V_1\cup\ldots\cup V_k$ of $\mathcal{D'}$ satisfies the frontier condition.
This algorithm has complexity...
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.theorem #main}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula $F$ with $s$ different polynomials of maximum degree $d$ in $\R[x_1,\ldots,x_n]$.
There is an algorithm, taking $F$ as input, which outputs a cylindrical decomposition $\mathcal D$ of $\R^n$ compatible with $S$ and
satisfying the frontier condition.
The complexity of this algorithm is $(sd)^{O(1)^{n2^n}}$.
This is also an upper bound on the number of cells in $\mathcal D$, number of polynomials defining cells and their degrees.
:::

::: {.definition}
[@vdd1998, Section 2.19]
We say that a cylindrical cell $C \subset \R^n$ is Van-den-Dries regular if, for all $i \in \{1,\ldots,n\}$, if two distinct points $\mathbf{x},\mathbf{y} \in C$ are such that $x_1 = y_1, \ldots, x_{i-1} = y_{i-1}, x_{i+1}, \ldots, x_n = y_n$, but $x_i < y_i$, then for all $z_i$ such that $x_i < z_i < y_i$, $(x_1,\ldots,x_{n-1},z_i,x_{i+1},\ldots,x_n) \in C$.
:::

::: {.theorem #strat }
Let
$$
X := \{ \mathbf{x} \in \R^n \mid f_1 = 0, \ldots, f_k = 0, g_1 > 0, \ldots, g_\ell > 0 \},
$$
be a semialgebraic set defined by $s = k + \ell$ different polynomials of maximum degree $d$.
Then there is an algorithm, without oracle, which partitions $X$ into a family
$$
{\cal X} = (X_0, \ldots, X_n)
$$
such that, if $X$ is nonsingular, $X_0 = X$ and all other sets are empty.
Otherwise, $X_0 = \emptyset$ and each $X_k, 1 \le k \le n$ is a possibly empty, effectively nonsingular stratum of codimension $k$.
This algorithm has complexity
$$
3^{s}\left(s(d+1)\right)^{O(n)^{2}}.
$$
The number of strata does not exceed $s^{n} (d + 1)^2$, and each stratum is defined by at most $s (d + 1)^2$ polynomial equations and inequalities of maximum degree $(d + 1)^2$.
:::

::: { .proposition #bgv-main }
[@bgv15, Theorem 3.20]

Let $V_1, \ldots, V_k$ be bounded deﬁnable subsets in $\R^n$ with $\dim V_i \le 2$ for each $1 \le i \le k$.
Then there is a cylindrical cell decomposition of $\R^n$ satisfying the frontier condition, and monotone with respect to each $V_1, \ldots, V_k$.
:::

::: { .theorem #bgv-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas containing $s$ different polynomials $\mathbf{F} = \{ f_1,\ldots, f_s \} \in \Z[x_1,\ldots,x_n]$, having maximum degree $d$, such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.

Then there is an algorithm, taking $F_1,\ldots,F_k$ as input, which constructs a cylindrical algebraic decomposition $\mathcal{D}$ of $\R^n$ satisfying the frontier condition, and monotone with respect to each $V_1, \ldots, V_k$.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: { .theorem #bgv-quasi-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas containing $s$ different polynomials $\mathbf{F} = \{ f_1,\ldots, f_s \} \in \Z[x_1,\ldots,x_n]$, having maximum degree $d$, such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.

Then there is an algorithm, taking $F_1,\ldots,F_k$ as input, which constructs an $\mathbf{F}$-invariant CAD $\mathcal{D}$ of $\R^n$, which is obviously compatible with each $V_1,\ldots,V_k$, such that each cell $C \subset V_1\cup \ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: { .theorem #bgv-monotone-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.
Let $\mathbf{F} = \{f_1,\ldots,f_s\}$ be a set of polynomials in $\Z[x_1,\ldots,x_n]$ of maximum degree $d$ and $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ compatible with each $V_1,\ldots,V_k$ and such that each cell $C \subset V_1\cup\ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map.

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ monotone with respect to each $V_1, \ldots, V_k$.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: { .theorem #lazard-rn }
Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$ be a set of $s$ polynomials with maximum degree $d$.
Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$, monotone with respect to each bounded semialgebraic set $V_1,\ldots,V_k$ ($\dim(V_i) \le 2 1\le i \le k$).

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ such that each cell $C \subset V_1\cup\ldots\cup V_k$ of $\mathcal{D'}$ satisfies the frontier condition.
This algorithm has complexity...
$$
\left(s\left(d+1\right)\right)^{O(1)^n},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.theorem #main}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula $F$ with $s$ different polynomials of maximum degree $d$ in $\R[x_1,\ldots,x_n]$.
There is an algorithm, taking $F$ as input, which outputs a cylindrical decomposition $\mathcal D$ of $\R^n$ compatible with $S$ and
satisfying the frontier condition.
The complexity of this algorithm is $(sd)^{O(1)^{n2^n}}$.
This is also an upper bound on the number of cells in $\mathcal D$, number of polynomials defining cells and their degrees.
:::

::: { .definition #semialgebraic-set }
The semialgebraic subsets of $\R^n$ are the smallest class ${SA}_n$ of subsets of $\R^n$ satisfying the following properties.

1. If $f \in \R[x_1,\ldots,x_n]$, then $\{ \mathbf{x} \in \R^n \mid f(\mathbf{x}) = 0 \}$ and $\{ \mathbf{x} \in \R^n \mid f(\mathbf{x}) > 0 \}$ are elements of ${SA}_n$.
1. If $A, B \in {SA}_n$, then $A \cup B$, $A \cap B$ and $\R^n \setminus A$ are elements of ${SA}_n$.
:::

::: {.definition #graph-def-map }
Let $X \subset \R^n$ and $Y \subset \R^m$ be definable sets. 
Let $f : X \to Y$ be a mapping from $X$ to $Y$. The graph of $f$ is the definable set
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}.
$$
Sometimes, the domain of $f$ is $\R^n$. In this case, we often use the restriction $f\vert_X$ so that only images of $f$ at points in $X$ are considered,
The graph of $f$ on $X$ may be denoted by $f(X)$. 
:::

::: {.definition}
Let $X \subset \R^n$ and $Y \subset \R^m$. A mapping $f : X \to Y$ is called semialgebraic if its graph (see Definition \@ref(def:graph-def-map))
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}
$$
is a semialgebraic set.
:::

::: { .definition #qff }
A quantifier-free Boolean formula is obtained by the following rules:

1. If $f \in \R[x_1\ldots,x_n]$ then $f=0$ and $f>0$ are quantifier-free Boolean formulas,
2. if $F$ and $G$ are quantifier-free Boolean formulas then $F \land G$, $F \lor G$ and $\neg F$ are quantifier-free Boolean formulas.
:::

::: { .definition #first-order-formula }
A first-order Boolean formula is obtained by rules 1 and 2 from Definition \@ref(def:qff) and

3. If $F$ is a first-order Boolean formula and $y$ is a variable ranging over $\R$, then $\exists y\ F$ and $\forall y\ F$ are first-order Boolean formulas.
:::

::: { .theorem #tarski-seinedberg }
[@vdd1988tarski]
Let $S \subset \R^{n+1}$ and $\projop{n} : \R^{n+1} \to \R^n$ be the projection map onto the first $n$ co-ordinates. Then $\projop{n}(S) \subset \R^n$ is a semialgebraic set.
:::

::: { .proposition #bpr-qe }
[@bpr2006, Algorithm 14.21]

Let $y_1 < \ldots < y_k < x_1 < \ldots < x_k$ be an ordered list of variables and $K$ a real closed field. Define a first-order Boolean formula
$$
F := Q_1 (y_1,\ldots,y_{k_1}), Q_2 (y_{k_1 + 1},\ldots,y_{k_1 + k_2}) \ldots Q_\omega (y_{y_1 + \ldots + y_{\omega-1} + 1},\ldots, y_k) G
$$
where $Q_i, 1\le i \le \omega$, is a quantifier $\forall$ or $\exists$, such that $Q_i$ and $Q_{i+1}$ are different and $G$ is a quantifier-free Boolean formula containing $s$ different polynomials of maximum degree $d$ in $K[y_1,\ldots,y_k,x_1,\ldots,x_n]$.
Note that variables $y_1,\ldots,y_k$ are partitioned into $\omega$ "blocks" $Y_1,\ldots,Y_\omega$ such that $Y_i, 1 \le i \le \omega$ contains $k_i$ variables, each of which is bound by the same quantifier $Q_i$.
We say that the formula $F$ contains $\omega$ quantifier alternations.

Let $S \subset \R^n$ be a semialgebraic set defined by $F$. There is a quantifier-free Boolean formula defining $s$ of the form
$$
F' := \lor_{1 \le i \le I} \land_{1 \le j \le J_i} \left( \lor_{1 \le \ell \le L_{i,j}} f_{i,j,\ell}(x_1,\ldots,x_n) \ast_{i,j,\ell} 0 \right)
$$
where each $f_{i,j,n}$ is a polynomial in $K[x_1,\ldots,x_n]$ and $\ast_{i,j,\ell} \in \{<, =, >\}$ determines its sign.
Bounds on this formula are as follows

- $I \le s^{(k_1 + 1)(k_2 + 1) \ldots (k_\omega + 1)(n+1)}d^{O(k_1) O(k_2) \ldots O(k_\omega)}$,
- $J_i \le s^{(k_1 + 1)(k_2 + 1) \ldots (k_\omega + 1)}d^{O(k_1) O(k_2) \ldots O(k_\omega)}$,
- $L_{i,j} \le d^{O(k_1) O(k_2) \ldots O(k_\omega)}$,
- polynomials $f_{i,j,\ell}$ have maximum degree $d^{O(k_1) O(k_2) \ldots O(k_\omega)}$.

There is an algorithm, taking $F$ as input, which computes $F'$ with complexity
$$
s^{(k_1 + 1)(k_2 + 1) \ldots (k_\omega + 1)(n+1)}d^{O(k_1) O(k_2) \ldots O(k_\omega)O(n)}.
$$
:::

::: {.definition #definable-set}
A structure expanding the real closed field $R$ is a collection $$
S := (S^n)_{n \in \N}
$$
where each $S^n$ is a set of subsets of the affine space $R^n$ satisfying the following conditions.

1. All algebraic subsets of $R^n$ are in $S^n$.
2. $S^n$ is a Boolean subalgebra of the powerset of $R^n$.
3. If $A \in S^n$ and $B \in S^m$, then $A \times B \in S^{n+m}$.
4. Let $\proj : R^{n+1} \to R^n$ be the projection onto the first $n$ coordinates. If $X\in R^{n+1}$, then $\proj(X) \in R^n$.

Elements of $S^n$ (satisfying properties 1-4) are called the definable subsets of $R^n$.
If the structure $S$ satisfies properties 1-4 and the following property, it is called an O-minimal structure.


5. The elements of $S^1$ consist of the finite unions of points and open intervals of $R$.


:::

::: {.definition #definable-function}
A map $f : A \to R^m$, where $A \subset R^n$, is called *definable* if its graph $G \subset R^{n+m}$ is a definable set.
:::

::: {.remark}
Since definable sets are closed under projection, it can be easily deduced that $A$ is a definable set.
:::

::: {.remark}
For convenience, we will call a definable map $f : R^n \to R$ a definable function.
:::

::: {.definition}
[@gv04, Definition 2.1]
A Pfaffian chain of order $r \ge 0$ and degree $\alpha \ge 1$ in an open domain $G \subset \R^n$ is a sequence of analytic functions
$$
f_1, \ldots , f_r
$$
in $G$ satisfying the differential equations
$$
{df}_j(\mathbf{x}) = \sum^n_{i=1} g_{ij}(\mathbf{x}, f_1(\mathbf{x}), \ldots, f_j(\mathbf{x})) dx_i
$$
for $1 \le j \le r$, where $g_{ij}(x_1,\ldots,x_n),y_1,\ldots,y_j)$ are polynomials of degree not greater than $\alpha$.

A function $f(\mathbf{x}) = P(\mathbf{x},f_1(\mathbf{x}),\ldots,f_r(\mathbf{x}))$, where $P(\mathbf{x}, f_1(\mathbf{x}), \ldots, f_r(\mathbf{x}))$ is a polynomial of degree not greater than $\beta \ge 1$ is called a Pfaffian function of order $r$ and degree $(\alpha, \beta)$. Note that $f$ is only defined in the domain $G$, where all functions $f_1,\ldots,f_r$ are analytic, even if $f$ itself can be extended as an analytic function in a larger domain.
:::

::: {.definition}
[@gv04, Definition 2.7]
A set $X \subset \R^n$ is called semi-Pfaffian in an open domain
$G \subset \R^n$ if it consists of points in $G$ satisfying a Boolean combination $F$ of some atomic equations and inequalities $f = 0$, $g > 0$, where $f, g$ are Pfaffian functions having a common Pfaffian chain defined in $G$.

$X$ is called restricted in $G$ if $\cl{X}$ is contained in $G$.

$X$ is called basic if the Boolean combination $F$ is a conjunction.
:::

::: {.definition}
[@gv04, Definition 2.8]
A set $X \subset \R^n$ is called sub-Pfaffian in an open domain $G \subset \R^n$ if
$$
X := \projop{n}(Y),
$$
where $Y \subset \R^m$ is a semi-Pfaffian set and $\R^n$ is a subspace of $\R^m$.
:::

::: {.definition}
[@gv04, 2.9]
Let ${\cal I}^k := [-1,1]^k$ be the closed cube in an open domain $G \subset \R^k$.
$X \subset {\cal I}^n$ is called restricted sub-Pfaffian if $X := \projop{n}(Y)$, where $Y \subset {\cal I}^{n+m}$ is a restricted semi-Pfaffian set.
:::

::: {.definition #pfaff-format}
[@gv04, Definition 2.11]

Consider a semi-Pfaffian set
$$
X := \bigcup_{1 \le i \le M} \{ \mathbf{x} \in \R^s \mid f_{i,1} = 0, \ldots, f_{i,I_i} = 0, g_{i,1} > 0, \ldots, g_{i,J_i} > 0 \} \subset G
$$
where $f_{ij}$ and $g_{ij}$ are Pfaffian functions of order $r$ and degree $(\alpha, \beta)$ defined in an open domain $G$
The format of $X$ is a tuple
$$
(r, N, \alpha, \beta, s)
$$
where $N \ge (I_1 + J_1) + \cdots + (I_M + J_M)$.
:::

::: { .definition #affine-coordinate-subspace }
[@bgv15, Definition 2.1]
Let $L_{j,c} := \{ (x_1,\ldots,x_n) \mid x_j = c \}$ for some $1 \le j \le n$ and $c \in \R$.
Each intersection of the kind
$$
S := L_{j_1,c_1} \cap \ldots \cap L_{j_m,c_m}
$$
where $0 \le j \le m$, $1 \le j_1 < \cdots < j_m \le n$ and $c_1,\ldots,c_m \in \R$ is called an affine coordinate subspace of $\R^n$.
:::

::: { .definition #quasi-affine }
[@bgv15, Definition 2.2]
Let $\mathbf{f} = (f_1,\ldots,f_k) : X \to \R^k$ be a bounded continuous map defined on an open, bounded, non-empty subset $X \subset \R^n$ having the graph $Y \subset \R^{n+k}$.

$\mathbf{f}$ is called quasi-affine if, for any coordinate subspace $L \subset \R^{n+k}$, the restriction $\proj_{L}\vert_Y$ is injective if and only if $\proj_{L}(Y)$ is $n$-dimensional.
:::

::: { .definition #monotone-map }
[@bgv15, Definition 2.3]
Let $\mathbf{f} : X \to \R^k$ be a bounded, continuous, quasi-affne map defined on an open, bounded, non-empty subset $X\subset \R^n$ having the graph $Y \subset \R^{n+k}$. $\mathbf{f}$ is called monotone if, for each affine coordinate subspace $S \subset \R^{n+k}$, the intersection $Y \cap S$ is connected.
:::

::: {.definition}
[@bgv15, Notation 2.4]

Let the space $\R^n$ have coordinate functions $x_1,\ldots,x_n$.
Given a subset
$$
I = \{x_{j_1}, \ldots, x_{j_m} \} \subset \{x_1 ,\ldots, x_n \},
$$ let $W$ be the linear subspace of $\R^n$ where all coordinates in $I$ are equal to zero.
We write $\opspan{x_{j_1},\ldots, x_{j_m}}$ to mean the
quotient space $\R^n / W$.
Similarly, for any aﬃne coordinate subspace $L \subset \R^n$ on which all the
functions $x_j \in I$ are constant, we will identify $L$ with its image under the canonical surjection
to $\R^n / W$. We write $\R^k$, where $k \le n$, to mean $\opspan{x_1, \ldots, x_k }$.
:::

::: { .definition #monotone-map-on }
[@bgv15, Definition 2.10]
Let $X \subset \opspan{x_1,\ldots,x_n}$ be a monotone cell and $\mathbf{f} : X \to \opspan{y_1,\ldots,y_k}$ be a continuous map having graph $Y \subset \opspan{x_1,\ldots,x_n,y_1,\ldots,y_k}$. If $Y$ is a monotone cell, then $\mathbf{f}$ is called monotone on $X$.
:::

::: { .definition #monotone-cell }
[@bgv15, Definition 2.5]
$Y \subset \opspan{x_1,\ldots,x_n}$ is called a monotone cell if it is the graph of a monotone map $\mathbf{f} : X \to H$ where $H \subset \opspan{x_1,\ldots,x_n}$ and $X \subset \opspan{x_1,\ldots,x_n} \setminus H$.
:::

::: { .example #monotone-cells }
1. Observe that any quasi-affine map defined on a connected subset and having the graph in $\R^2$ is also monotone. This quasi-affine map will fail to be monotone if the set it is defined on is not connected.

2. Let $\Delta := \{ 0 < x < 1, y > 0, x + y < 1 \} \subset \R^2$ and $\varphi(x,y) = x^2 + y^2$. Let $Y \subset \R^3$ be the graph of function $\phi$ on $\Delta$. Observe that $\phi\vert_Delta$ is a quasi-affine map. However, $y \cap \{ z = 3/4 \}$ is not connected, hence $\phi\vert_\Delta$ is not a monotone function [@bgv15, Example 4.3].
:::

::: { .proposition #monotone-topologically-regular }
[@bgv13, Theorem 1]
Every monotone cell is a topologically regular cell.
:::

::: { .corollary }
[@bgv13, Corollary 7, Theorem 11]
Let $X \subset \R^n$ be a monotone cell, then

1. $X \cap \{ x_i < c \}$, $X \cap \{ x_i = c \}$ and $X \cap \{ x_i > c \}$, for every $1 \le i \le n$ and $c \in \R$, are either empty or monotone cells.
1. Let $Y \subset X$ be a monotone cell such that $\dim(Y) = \dim(X) - 1$ and $\fr{Y} \subset \fr{X}$. Then $X \setminus Y$ is a disjoint union of two monotone cells.
:::

::: { .proposition }
[@bgv13, Theorem 10]
Let $X \subset \R^n$ be a monotone cell. Then $\proj_{L}(X)$, for any affine coordinate subspace $L \subset \R^n$ is also a monotone cell.
:::

::: { .remark #monotone-proj-basis }
[@bgv15, Remark 2.11]
Let $Y \subset \R^n$ be a monotone cell and $L$ be a coordinate subspace such that $\proj_L\vert_Y$ is injective.
Then $Y$ is the graph of a monotone map defined on $\proj_L(Y)$, by [@bgv13, Theorem 7 and Corollary 5].
:::

::: {.definition #big-o }
[@gv2009, Definition 6.1]
Let $f,g,h : \N^\ell \to \N$ be functions and $n \in \N$.

- The expression $f \le O(g)^n$ means that there exists $c \in \N$ such that $f < (cg)^n$ at every point in $\N^\ell$.
- The expression $f \le g^{O(h)}$ means that there exists a $c \in \N$ such that $f \le g^{ch}$ at every point in $\N^\ell$.
:::

::: { .definition #cells }
Cylindrical cells are defined by induction on $n\ge 1$. Each cylindrical cell $C$ is a connected definable subset of $\R^n$ with an *index*
$$
(i_1,\ldots,i_n) \in \{0,1\}^n.
$$

- When $n = 0$, there is a unique cylindrical cell $\mathbf{0} \in \R^0$.

- When $n = 1$, a $(0)$-cell (section cell) is a point $c \in \R$ and a $(1)$-cell (sector cell) is an open interval: $(a,b)$, $(-\infty,b)$, $(a,\infty)$, $(-\infty,\infty)$ where $a,b\in \R$.

- When $n > 1$, suppose that $(i_1,\ldots,i_{n-1})$-cells are already defined and let $C'$ be one of these cells.
An $(i_1,\ldots,i_{n-1},0)$-cell (section cell) is the graph of a continuous definable function $f : C' \to \R$.
An - $(i_1,\ldots,i_{n-1},1)$-cell (sector cell) is a subset of the cylinder $C' \times \R$, either
  $$
\begin{aligned}
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', f(\mathbf{x}) < t < g(\mathbf{x})\},\\
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', -\infty < t < g(\mathbf{x})\},\\
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', f(\mathbf{x}) < t < \infty\},\\
\{ (\mathbf{x},t) &\mid \mathbf{x} \in C', t \in \R \}
\end{aligned}
  $$
  where $f,g : C' \to \R$ are continuous definable functions such that $f(\mathbf{x}) < g(\mathbf{x})$ for all $\mathbf{x} \in C'$.
:::

::: {.definition}
Let $S \subset \R^n$ be a definable subset of $\R^n$ and define the *frontier of $S$*
$$
\fr{S} := \cl{S} \setminus S,
$$
where $\cl{S}$ is the closure of $S$ in the Euclidean topology.
:::

::: {.definition #blow-up-point }
[@bgv15, Definition 9.2]

Let $\varphi : W \to \R$ be a continuous function on a semialgebraic set $W \subset \R^n$, and let $\Phi \subset \R^{n+1}$ be its graph.

A point $\mathbf{x} \in \overline{W} \setminus W$ is called a blow-up point of $\Phi$ if $$\proj^{-1}_{\R^n} (\mathbf{x}) \cap \overline{\Phi}$$ contains an open interval.
:::

::: {.remark #blow-up-codimension }
The closure of the graph of a continuous definable function is the graph of a continuous definable function everywhere
except, possibly, over a subset of codimension at least $2$ (see the proof of @bgv15, Lemma 3.14).
:::

::: { .example #top-bottom-not-cylindrical }
In $\R^3$, let $C' := \{ -1 < x < 1, \vert x \vert < y < 1 \}$ and $\phi(x,y) = \vert x / y \vert$ so that $C$ is the graph of $\phi\vert_{C'}$.
Consider $$
C_B := \{ -1 < x < 1, y = \vert x \vert, z = 1 \} \cup \{ (0,0,z) \mid 0 \le x \le 1 \}.
$$
$C_B$ is not the graph of a continuous function due to the blow-up point of $\phi$ at the origin.
:::

::: {.definition}
A cylindrical decomposition is defined by induction on $n \ge 0$.

- When $n = 0$, the unique cylindrical decomposition of $\R^0$ is the unique point in $\R^0$.

- When $n > 0$: Let $\cal D$ be a partition of $\R^n$ into cylindrical cells.
Define $\cal D'$ to be the set of all projections $C' := \projop{n-1}(C)$ for all $C$ in $\cal D$.
$\cal D$ is a cylindrical decomposition of $\R^n$ if $\cal D'$ is a cylindrical decomposition of $\R^{n-1}$. We call $\cal D'$ the decomposition of $\R^{n-1}$ induced by $\cal D$.
:::

::: {.definition}
Let $S \subset \R^n$ be a definable set. A cylindrical decomposition $\cal D$ is compatible with $S$ if every cell $C$ of $\cal D$ is either a subset of $S$ or disjoint from $S$.
:::

::: {.definition}
A cylindrical decomposition $\cal E$ is called a refinement of $\cal D$ if $\cal E$ is compatible with every cell of $\cal D$. in other words, every cell of $\cal D$ is a union of cells in the refinement $\cal E$.
:::

::: { .remark }
[@bgv15, Remark 3.8]
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cylindrical cell of $\cal D$ such that $c := \projop{1}(C)$ is a single point. Then it follows immediately from the definition that $\cal D$ is compatible with the hyperplane $\{ x_1 = c \}$ and the set of all cells of $\cal D$ contained in this hyperplane form a cylindrical decomposition $\cal E$ of $\R^{n-1}$. Moreover, any refinement of $\cal E$ is also a refinement of $\cal D$.
:::

::: {.definition}
Let $S \subset \R^n$ be a definable set. A cylindrical decomposition $\mathcal{D}$ of $\R^n$, compatible with $S$, is called monotone with respect to $S$ if every cell $C \subset S$ of $\cal D$ is monotone.
:::

::: {.definition #frontier-condition}
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cell of $\cal D$. $C$ satisfies the frontier condition in $\cal D$ is $\fr{C}$ is a union of cells of $\cal D$ of smaller dimension. If it is unambiguous that $C$ is a cell of $\cal D$, then we just say that $C$ satisfies the frontier condition.
If every cell in $\cal D$ satisfies the frontier condition, then the cylindrical decomposition $\cal D$ satisfies the frontier condition.
:::

::: {.example #side-wall}
Consider the two cylindrical cells
$$
V := \{ x > y > 0, z > 0, y = xz \}
$$ and $$
W := \{ x > y > 0, z > 0, y = 2xz \}
$$ in $\R^3$.
Any cylindrical decomposition compatible with $V$ and $W$ is also compatible with the two intervals
$$
I_1 = \{ (0,0,z) \mid 0 \le z \le 1/2 \}, I_2 = \{ (0,0,z) \mid 1/2 \le z \le 1 \}
$$
and the point $$v = (0,0,1/2).$$
Observe that $I = \{ (0,0,z) \mid 0 \le z \le 1 \}$ is the only one-dimensional component of the side-wall of $V$ and $I_1$ is the only one-dimensional component of the side-wall of $W$. In order to obtain the strong frontier condition, we need to partition $V$ into (at least) three cylindrical cells $V',V'',V'''$, one of which, say $V''$, will be one-dimensional. $V''$ should have endpoint $v$ (i.e., $\cl{V''} \cap I = v$).
The tangent at the origin of $c := \projop{2}(V'')$ is $1/2$. The pre-image of the projection map $W' := \projop{2}^-1\vert_{\cl{W}}(c)$ would satisfy the condition $\cl{W'} \cap I = v'$, where $v' = (0,0,1/4)$. However, $v'$ must be a zero-dimensional cell of the decomposition, which means we need to perform another refinement of $I$. An infinite sequence of refinements, introducing a new 0-dimensional cell $(0,0,1/2^k), k \in \N_{> 0}$, will take place. Thus, a decomposition in in which the side-walls of $V$ and $W$ are single 1-dimensional cells cannot exist.
:::

::: { .proposition #delete-zero-index }
[@bgv15, Lemma 3.3]
Let $C$ be an $(i_1,\ldots,i_{k-1},0,i_{k+1},\ldots,i_n)$-cell. Then $C' := \projops{x_1,\ldots,x_{k-1},x_{k+1},\ldots,x_n}(C)$ is a cylindrical $(i_1,\ldots,i_{k-1},i_{k+1},\ldots,i_n)$-cell and $C$ is the graph of a monotone map $f : C' \to \opspan{x_k}$.
:::

::: { .proposition }
[@bgv15, Lemma 3.4]
Let $C \subset \R^n$ be a 2-dimensional cylindrical cell which is the graph of a quasi-affine map. Then the side-wall $W \subset \fr{C}$ has exactly two connected components, each of which is either a point or a closed curve interval.
:::

::: {.remark}
It was proved by @pianomovers1983 that a cylindrical decomposition, compatible with a semialgebraic set and satisfying the frontier condition, can be obtained following a linear rotation of coordinates.
@jhd20 prove that a cylindrical decomposition having constant sign on a set of input polynomials will contain topologically regular cells and satisfy the frontier condition, regardless of the method used to construct it, as long as the input polynomials do not blow up anywhere.
Proposition \@ref(prp:monotone-topologically-regular) (@bgv13, Theorem 1) asserts that every monotone cell is topologically regular, so @bgv15, Theorem 3.20 describes the construction of a CAD, compatible with a family $V_1,\ldots,V_k$ of definable subsets of $\R^n$, each having dimension at most $2$, in the potential presence of blow-up points and without the need to make a change of coordinates.
:::

::: {.remark}
A cylindrical algebraic decomposition (CAD) is a cylindrical decomposition in which every cell is a semialgebraic set. While the results of @bgv15 are proved for the wider class of cylindrical decompositions compatible with definable sets, we will restrict ourselves to CADs, allowing us to take advantage of properties of polynomials.
:::

::: {.definition}
Let $\mathbf{F} := (f_1,\ldots,f_s) \subset \Z[x_1,\ldots,x_n]$ be a set of polynomials with integer coefficients. A cylindrical algebraic decomposition $\cal D$ is called sign-invariant with respect to $\mathbf{F}$  (or simply $\mathbf{F}$-invariant) if each polynomial $f \in \mathbf{F}$ has a constant sign (either $< 0$, $= 0$ or $> 0$) on every cylindrical cell $C$ of $\mathcal{D}$.
:::

::: {.remark}
The fundamental theorem of algebra implies that for the coefficients of $\mathbf{F}$, we may choose any ring $K \subset \R$. $\Z$ has been chosen for convenience, but some authors (e.g., @pianomovers1983) choose $\Q$ instead. It is also common to take polynomials with coefficients over $\R$. However, the choice has been made to avoid this so as to work over the algebraic numbers $\mathcal{A}$, whose elements are easily represented in, and manipulated by, computers.
:::

::: {.proposition #coste-polynomial-to-cell }
[@coste2000, Proposition 2.16]
Let $f \in \Z[x_1,\ldots,x_n]$ and, $C' \subset \R^{n-1}$ be a connected semialgebraic set and $k \le d \in \N$ such that, for every point $\mathbf{x} \in C'$, the univariate polynomial $f(\mathbf{x},x_n) \in \A[x_n]$ has degree $d$ and exactly $k$ distinct (complex) roots in $C'$.
Then there are $\ell \le k$ distinct semialgebraic functions
$$\psi_1,\ldots,\psi_\ell : C' \to \R
$$
such that, for every $\mathbf{x} \in C'$, the set of real roots of $f(\mathbf{x},x_n)$ is exactly
$$\{ \psi_1(\mathbf{x}, \ldots, \psi_\ell(\mathbf{x}) \}.$$
Moreover, the multiplicity of each of these roots is constant.
:::

::: {.proof}
The argument relies on the "continuity of roots":

> Fix $\mathbf{c} \in C'$ and let $z_1,\ldots,z_k$ be the distinct roots of $f(\mathbf{c},x_n)$ with multiplicities $m_1,\ldots,m_k$.
Choose $\varepsilon > 0$ small enough that the open discs $D(z_i,\varepsilon) z_i \in \mathbb{C}$ (center $z_i$, radius $\varepsilon$) are disjoint. If $\mathbf{b} \in C'$ is sufficiently close to $\mathbf{c}$, then the polynomial $f(\mathbf{b}, x_n)$ has exactly $m_i$ roots, counted with multiplicities, in $D(z_i,\varepsilon)$ for $1\le i \le k$.

Since $f(\mathbf{b},x_n)$ has $k$ distinct complex roots, and $d = m_1+ \ldots + m_k$ complex roots counted with multiplicities, it follows that each $D(z_i,\varepsilon)$ contains exactly one root, denoted $\zeta_i$, of $f(\mathbf{b},x_n)$ with multiplicity $m_i$.
If $z_i$ is real, then $\zeta_i$ is real, otherwise the complex conjugate of $\zeta_i$ would be another root of $f(\mathbf{b},x_n)$ in the disc $D(z_i,\varepsilon)$.
If $z_i$ is complex then $\zeta_i$ is also complex, since the conjugation of every point in $D(z_i, \varepsilon)$ lies outside $D(z_i, \varepsilon)$, forming another disc $D(\overline{z_i}, \varepsilon)$.
It follows that, if $\mathbf{b} \in C'$ is close enough to $\mathbf{c}$, then $f(\mathbf{c},x_n)$ has the same number of real roots as $f(\mathbf{b},x_n)$. Since $C'$ is connected, $f(\mathbf{x},x_n)$ has the same number of real roots at every point $\mathbf{x} \in C'$, say $\ell$.
Define $\psi_i(\mathbf{x}) : C' \to \R$ to be the continuous (by making $\varepsilon$ small enough) semialgebraic function sending $\mathbf{x} \in C'$ to the $i$-th (in ascending order) real root of $f(\mathbf{x},x_n)$. It follows from the connectedness of $C'$ that each $\psi_i$ has constant multiplicity.
Observe that the graph of each $\psi_i$ can be expressed by a first-order Boolean formula, using existential quantifiers to express each of the $\ell$ roots of $f(\mathbf{x},x_n)$ and an equality condition to pick out the $i$-th root.
It follows that the graph of each functin $\psi_i$ is a semialgebraic set.
:::

::: {.proposition}
[@coste2000, Proposition 2.18]
Let $f,g \in \Z[x_1,\ldots,x_n]$, $C' \subset \R^{n-1}$ such that, for all $\mathbf{x} \in C'$, the degree and number of roots of $f(\mathbf{x},x_n)$ and $g(\mathbf{x},x_n)$ is constant and the degree of the GCD of $f(\mathbf{x},x_n)$ and $g(\mathbf{x},x_n)$ is constant.
Let $\phi,\psi : C' \to \R$ be continuous semialgebraic functions such that $f(\mathbf{x},\phi(\mathbf{x})) = 0$ and $g(\mathbf{x},\psi(\mathbf{x})) = 0$ for all $\mathbf{x} in C'$.
If there exists $\mathbf{c} \in C'$ such that $\phi(\mathbf{c}) = \psi(\mathbf{c})$, then $\phi(\mathbf{x}) = \psi(\mathbf{x})$ for all $\mathbf{x} \in C'$.
:::

::: {.proof}
We use the same method of proof as in the previous proposition.
For an arbitrary element $\mathbf{c} \in C'$, let $z_1 = \phi(\mathbf{c}) = \psi(\mathbf{c}), \ldots, z_k$ be the distinct roots in $\mathbb{C}$ of the product
$$
f(\mathbf{c},x_n) g(\mathbf{c},x_n)
$$
(recall that $fg = 0$ if either $f=0$ or $g=0$).
Let $m_i$ (resp $p_i$) be the multiplicity of $z_i$ as a root of $f(\mathbf{x},x_n)$ (resp. $g(\mathbf{x}, x_n)$) where multiplicity zero indicates that $z_i$ is not a root.
The degree of $\gcd(f(\mathbf{x}, x_n), g(\mathbf{x}, x_n))$ is $\min(m_1,p_1) + \cdots + \min(m_k,p_k)$ and each $z_i$ has multiplicity $\min(m_i,p_i)$ as a root of this GCD.
Choose $\varepsilon > 0$ small enough that the discs $D(z_i,\varepsilon)$ are disjoint.
For each $\mathbf{b} \in C'$ close enough to $\mathbf{c}$, each disc contains a root of multiplicity $m_i$ of $f(\mathbf{b}, x_n)$ and a root of multiplicity $p_i$ of $g(\mathbf{b}, x_n)$. Since the degree of the GCD of $f$ and $g$ (evaluated at any $\mathbf{x} \in C'$) is equal to $\min(m_1,p_1) + \cdots + \min(m_k,p_k)$, this GCD must have one root of multiplicity $\min(m_i,p_i)$ in each disc $D(z_i,\varepsilon)$ such that $\min(m_i,p_i) > 0$.
In  particular, it follows that $\phi(\mathbf{b}) = \psi(\mathbf{b})$. Since $C'$ is connected, this equality holds for all $\mathbf{x} \in C'$.
:::

::: {.definition}
Let $f,g \in \Z[x_1,\ldots,x_{n-1}][x_n]$ be polynomials, with degrees $d$ and $e$ respectively, such that
\begin{align*}
f(x_n) &= a_d x_n^d + \cdots + a_1 x_n + a_0 \\
g(x_n) &= b_e x_n^e + \cdots + b_1 x_n + b_0. \\
\end{align*}
Then the Sylvester matrix associated to $f$ and $g$ is the $(d + e) \times (d + e)$-matrix defined as follows.
$$
S_{f,g}(f,g) =
\begin{pmatrix}a_{d} & \ldots & a_{0} & 0 & \ldots & \ldots & 0\\
0 & a_{d} & \ldots & a_{0} & 0 & \ldots & 0\\
\ldots & 0 & a_{d} & \ldots & a_{0} & \ldots & 0\\
b_{e} & \ldots & b_{0} & 0 & \ldots & \ldots & 0\\
0 & b_{e} & \ldots & b_{0} & 0 & \ldots & 0\\
\ldots & 0 & b_{e} & \ldots & b_{0} & \ldots & 0
\end{pmatrix}.
$$
:::

::: {.definition}
Let $f,g \in \Z[x_1,\ldots,x_{n-1}][x_n]$ be polynomials with degrees $d$ and $e$ respectively. The principal subresultant coefficient of order $j$ of $f$ and $g$, denoted $\psrc_j(f,g)$, is the determinant of the $(m + n - 2j) \times (m + n - 2j)$-matrix obtained from the Sylvester matrix associated to $f$ and $g$ by deleting the  first and last $j$ rows and columns.
:::

::: {.definition}
Consider $f \in \Z[x_1,\ldots,x_n]$ as a univariate polynomial in $x_n$. I.e.,
$$
f(x_n) = a_d x_n^d + \cdots + a_1 x_n + a_0
$$
where $a_d,\ldots,a_0 \in \Z[x_1,\ldots,x_{n-1}]$.
Let $\lc{f} = a_d$ denote the leading coefficient of $f$ and $\red(f) = a_{d-1}x_n^{d-1} + \cdots + a_1 x_n^1 + a_0$ be the reductum of $f$.

Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$. We define the projection operator, $\proj(\mathbf{F})$ as follows:

- Let $d := \deg(f_i)$. If $d > 1$, then $\proj(f_1,\ldots,f_i,\ldots,f_s)$ contains
$$
\psrc_k(f_i, \partial f_i / \partial x_n)
$$
for all $1\le k \le d$.

- Let $d := \min(\deg(f_i), \deg(f_j))$. If $d > 0$, then $\proj(f_1,\ldots,f_i,\ldots,f_j,\ldots,f_s)$ contains
$$
\psrc_k(f_i, f_j)
$$
for all $1 \le k \le d$.

- If $\deg(f_i) > 0$ and $\lc(f_i)$ is non-constant, then $\proj(f_1,\ldots,f_i,\ldots,f_s)$ contains
$$
\lc(f_i) \text{ and } \proj(f_1,\ldots,\red(f_i),\ldots,f_n).
$$
:::

::: {.theorem #cad-lift}
[@coste2000, Theorem 2.19]
Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$ be a family of polynomials and let $C'$ be a connected $\proj(\mathbf{F})$-invariant semialgebraic subset of $\R^{n-1}$ -- an $(i_1,\ldots,i_{n-1})$-cell.
Then there exist continuous definable functions
$$
\psi_1,\ldots, psi_\ell : C' \to \R
$$
such that for all $\mathbf{x} \in C'$, the set $\{ \psi_i(\mathbf{x}), \ldots, \psi_k(\mathbf{x}) \}$ coincides with the real roots of polynomials in $\mathbf{F}$, defining the $(i_1,\ldots,i_{n-1},0)$-cells in the cylinder $C' \times \R$ and $\{ -\infty < t < \psi_1(\mathbf{x}), \ldots, \psi_i(\mathbf{x}) < t < \psi_{i+1}(\mathbf{x}), \ldots, \psi_k(\mathbf{x}) < t < \infty \}$ are the $(i_1,\ldots, i_{n-1},1)$-cells in the cylinder $C' \times \R$.
:::

::: { .proposition #collins }
[@bpr2006, Algorithm 11.2]
Let $\mathbf{F} := f_1,\ldots,f_s$ be set of polynomials in $\Z[x_1, \ldots ,x_n]$ with maximum degree $d$.
There is an algorithm, taking $\mathbf{F}$ as input, which produces an $\mathbf{F}$-invariant CAD $\cal D$ of $\R^n$.
The complexity of the algorithm is
$$(sd)^{O(1)^{n}}.
$$
This is also an upper bound on the number of cells in $\cal D$, number of polynomials defining cells and their degrees.
:::

::: { .corollary #collins-sets}
Let $S_1,\ldots,S_k$ be a finite collection of semialgebraic subsets of $\R^n$ defined by quantifier-free Boolean formulas $F_1,\ldots,F_k$ respectively. Together, these formulas include $s$ different polynomials in $\Z[x_1,\ldots,x_n]$ with maximum degree $d$.
There is an algorithm, taking $\{F_1,\ldots,F_k\}$ as input, which produces a cylindrical decomposition $\mathcal E$ of $\R^n$ compatible with each set $S_i, 1 \le i \le k$.
Complexity, number of cells, number of polynomials and degrees are the same as in Proposition \@ref(prp:collins) but, in practice, more efficient algorithms exist (see e.g., @collins1991 and @bradford2014).
:::

::: { .proof }
This construction follows immediately from Proposition \@ref(prp:collins), where truth values of $F_1,\ldots,F_k$ associated to each cell.
The complexity upper bound (and bounds on number of cell, polynomials and degrees) is the same as in Proposition \@ref(prp:collins).
:::

::: { .corollary #collins-set }
Let $S\subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula $F$ containing $s$ different polynomials in $\R[x_1,\ldots,x_n]$, having maximum degree $d$.
There is an algorithm, taking $F$ as input, which produces a cylindrical decomposition $\mathcal E$ of $\R^n$ compatible with $S$.
Complexity, number of cells, number of polynomials and degrees are the same as in Proposition \@ref(prp:collins).
:::

::: { .proof }
Immediate, by applying Corollary \@ref(cor:collins-set) to $\{ F \}$.
:::

::: {.definition}
[@mccallum1998, 6.1]
Let $\mathbf{F} \subset \Z[x_1, \ldots, x_n]$ be a set of polynomials and denote by $\prim(\mathbf{F})$ the set of all primitive parts of $\mathbf{F}$
$\mathbf{F}$ is called well-oriented if, when $n > 1$,

- for each element $f \in \prim(A)$, $f(\mathbf{x},y) = 0$ for all $y\in \R$ on a finite number of points $\mathbf{x} \in \R^{n-1}$. [@mccallum1998, condition WO1]

- $\proj(\mathbf{F})$ is well-oriented. [@mccallum1998, condition WO2]
:::

::: {.definition #analytic-submanifold}
$S \subset \R^n$ such that $\dim(S) = k$ is an analytic submanifold if, for every point $\mathbf{x} \in S$, there is an analytic coordinate system about $\mathbf{x}$ with respect to which $S$ is locally the intersection of $n-k$ coordinate hyperplanes.
:::

::: {.proposition #mc-smooth}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula constructed from the set of polynomials $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$, such that $\mathbf{F}$ is well-oriented.
Then a CAD $\cal D$ of $\R^n$ compatible with $S$ and such that every cell $C$ of $\cal D$ is an analytic submanifold of $\R^n$ can be obtained by constructing an $\mathbf{F}$-invariant CAD of $\R^n$ using the McCallum projection operator.
:::

::: {.proposition #lz-smooth}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula constructed from the set of polynomials $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$.
Then a CAD $\cal D$ of $\R^n$ compatible with $S$ and such that every cell $C$ of $\cal D$ is an analytic submanifold of $\R^n$ can be obtained by constructing an $\mathbf{F}$-invariant CAD of $\R^n$ using the McCallum projection operator.
:::

::: {.definition}
Let $C_1$ and $C_2$ be distinct cells in a CAD $\cal D$ of $\R^n$. Each cell $C$ is assigned a truth value $T_C \in \{\tt{True}, \tt{False}, \tt{undet}\}$ and a list $S_C = (S_1,\ldots,S_k)$ where $S_i = (s_{i,1},\ldots,s_{i,s_i}, 1\le i \le k$ is the list of signs of level-$i$ (factorised) projection polynomials $f_1,\ldots,f_{i_s} \in \Z[x_1,\ldots,x_i]$, with $s_{i,j} \in \{-1,0,1\}$.
$(C_1, C_2)$ is called a conflicting pair in $\cal D$ if $T_{C_1}, T_{C_2} \in \{\tt{True}, \tt{False}\}$ and $T_{C_1} = T_{C_2}$ and $S_{C_1} = S_{C_2}$ (equality determined component-wise).
:::

::: {.definition}
[@gv04, Definition 6.2]
A weak stratification of a semi-Pfaffian set $X \subset \R^n$ is a partition of $X$ into a finite number of non-singular manifolds $X_k, 0 \le k \le n$ called strata. Strata need not be connected (or even have a finite number of connected components) and may be empty.

The stratification is called basic if all strata are basic semi-Pfaffian sets which are effectively nonsingular.
I.e., the system of equations and inequalities defining each stratum $X_k$ of codimension $k$ includes a set of $k$ Pfaffian functions
$$
h_{i_1}, \ldots , h_{i_k}
$$ such that the restriction $h_{i_j}\vert_{X_i} = 0$ and $d h_{i_j} \ne 0$ at every point $\mathbf{x} \in X_k$, for each $1 \le j \le k$.
:::

::: {.definition #pdo }
[@gv1995, Definition 2]
Let $f \in \Z[x_1,\ldots,x_n]$ be a polynomial and let $(m_1,\ldots,m_n) \subset \Z_{\ge 0}^n$ be a multi-index associated to one of its partial derivatives.
I.e., we write
$$
\partial f^{(m_1,\ldots,m_n)} =
\dfrac{\partial^{m_1} f}{\partial x_1} \cdots \dfrac{\partial^{m_n} f}{\partial x_n}.
$$
:::

::: {.definition}
[@gv1995, Definition 2]
We define the partial differential operator $\partial_{\mathbf{h}, \mathbf{i}, j} f$ (where the argument $f$ is a polynomial) as the determinant
$$
\det\begin{pmatrix}\dfrac{\partial h_{1}}{\partial x_{i_{1}}} & \cdots & \dfrac{\partial h_{1}}{\partial x_{i_{k}}} & \dfrac{\partial h_{1}}{\partial x_{j}}\\
 & \vdots\\
\dfrac{\partial h_{k}}{\partial x_{i_{1}}} & \cdots & \dfrac{\partial h_{k}}{\partial x_{i_{k}}} & \dfrac{\partial h_{k}}{\partial x_{j}}\\
\dfrac{\partial f}{\partial x_{i_{1}}} & \cdots & \dfrac{\partial f}{\partial x_{i_{k}}} & \dfrac{\partial f}{\partial x_{j}}
\end{pmatrix}.
$$
We write $\partial^m_{\mathbf{h}, \mathbf{i}, j}$ to mean the $m$-th iteration of $\partial_{\mathbf{h}, \mathbf{i}, j}$.
:::

::: {.theorem #strat }
Let
$$
X := \{ \mathbf{x} \in \R^n \mid f_1 = 0, \ldots, f_k = 0, g_1 > 0, \ldots, g_\ell > 0 \},
$$
be a semialgebraic set defined by $s = k + \ell$ different polynomials of maximum degree $d$.
Then there is an algorithm, without oracle, which partitions $X$ into a family
$$
{\cal X} = (X_0, \ldots, X_n)
$$
such that, if $X$ is nonsingular, $X_0 = X$ and all other sets are empty.
Otherwise, $X_0 = \emptyset$ and each $X_k, 1 \le k \le n$ is a possibly empty, effectively nonsingular stratum of codimension $k$.
This algorithm has complexity
$$
3^{s}\left(s(d+1)\right)^{O(n)^{2}}.
$$
The number of strata does not exceed $s^{n} (d + 1)^2$, and each stratum is defined by at most $s (d + 1)^2$ polynomial equations and inequalities of maximum degree $(d + 1)^2$.
:::

::: {.algorithm data-latex="Smooth Stratification"}
$${\cal X} := \rm{Stratify}(k, F, \mathbf{h}, \mathbf{i}, G)$$

**Input:**

  - $0 \le k \le n$,
  - $F = (f_1,\ldots,f_s) \in \Z[x_1,\ldots,z_n]$ is a list of polynomials,
  - $\mathbf{h} = (h_k, \ldots,h_1, h_0) \in \Z[x_1,\ldots,x_n]$ such that $h_0 = 0$,
  - $\mathbf{i} = (i_k, \ldots, i_1,i_0) \in \Z_{\ge 0}$ such that $i_0 = 0$,
  - $G = \{g_1,\ldots,g_t\} \subset \Z[x_1,\ldots,x_n]$.

**Output:**
$$
{\cal X} = (X_{k+1}, \ldots, X_n)
$$
$X_i, k+1 \le i \le n$ is a possibly empty, effectively nonsingular stratum of codimension $i$.
Note that ${\cal X}_{n+1} = ()$.

Proceed by induction on $i_k$.

- Base case: $i_k = n$.

  - Return ${\cal X}_{x+1} = (\emptyset, \ldots, \emptyset)$.

- Otherwise

  - Initialise

    - $X' := X = \{ f_1 = 0,\ldots,f_s = 0, g_1 > 0, \ldots, g_t > 0 \}$,

    - ${\cal F} := \{ ((0,\ldots,0,1), f_1), \ldots, ((0,\ldots,0,s), f_s) \}$
      (the set of input polynomials equipped with initial indices),

    - $X_{k+1} = \emptyset$ be the initial set of strata of codimension $k+1$.

  - For indices $\mathbf{i},\mathbf{j} \in \Z_{\ge 0}^n$,
    - let $\mathbf{i} \prec \mathbf{j}$ mean that $\mathbf{i}$ is lexicographically less than $\mathbf{j}$
    - and $\mathbf{i} \preceq \mathbf{j}$ denote $\mathbf{i}\prec \mathbf{j}$ or $\mathbf{i} = \mathbf{j}$.

  - We will iterate over each index $\mathbf{m} = (i_n,\ldots,i_{k+1},j) \in \Z_{\ge 0}^{n-k+1}$ in ascending lexicographical order, beginning with $(0,\ldots,0,1)$.

  - Partial derivatives $\partial^{(0,\ldots,0,i_{k+1},\ldots,i_n)}$ of functions $f$ in ${\cal F}$ will be computed.

  - For each $f\in {\cal F}$, maximal index $$M := (\deg_n(f), \ldots, \deg_{k+1}(f)).$$

  - Each index $(i_n,\ldots,i_{k+1},j)$ has the property that
  $$
  (0,\ldots,1) \preceq (i_n,\ldots,i_{k+1}) \preceq M_j.
  $$

    - Let $\mathbf{m} = (0,\ldots,0,i_\ell,\ldots,i_{k+1},j)$ be one of these indices and define
    $$
    \mathbf{j} = (0, \ldots, 0, i_{\ell} - 1, i_{\ell - 1}, \ldots, i_{k+1},j).
    $$

    - Let
    $$
    s_{k+1} := \partial_{(h_{1,},\ldots,,h_{k}),(i_{1},\ldots,i_{k}),\ell}^{i_{\ell}}\ldots\partial_{(h_{1,},\ldots,,h_{k}),(i_{1},\ldots,i_{k}),i_{k}+1}^{i_{i}+1}f_{j}
    $$
    where $f_j$ is the polynomial in $\cal F$ with index $(0,\ldots,0,j)$, i.e., the $j$-th input polynomial.

    - In practice, let $h_{k+1}$ be the polynomial in $\cal F$ with index $\mathbf{i}$ and compute
    $$
    s_{k+1} := \partial_{(h_1,\ldots,h_k), (i_1,\ldots,i_k), i_\ell} h_{k+1}.
    $$

    - Define the sets

      - $Y_{k+1} := \{ \mathbf{x} \in X' \mid s_{k+1}(\mathbf{x}) \ne 0 \}$ and

      - $U_{k+1} := \{ \mathbf{x} \in \R^n \mid h_{k+1}(\mathbf{x}) = 0, s_{k+1}(\mathbf{x}) \ne 0, g_1(\mathbf{x}) > 0 , \ldots, g_t(\mathbf{x}) > 0 \}$.

      - Note

        - Clearly $Y_{k+1} \subset X'$ and $Y_{k+1} \subset U_{k+1}$
        - $h_{k+1}(\mathbf{x}) = 0$ for all $\mathbf{x} \in Y_{k+1}$.
        - $U_{k+1}$ is a nonsingular subset of $\R^n$ having codimension $k+1$.

      - If $Y_{k+1}$ is an open subset of $U_{k+1}$, then $Y_{k+1}$ is smooth and has codimension $k+1$.

        - Let $X_{k+1} := X_{k+1} \cup Y$,

      - Otherwise, proceed by induction.

        - Compute
        $$(X^{\mathbf{m}}_{k+2},\ldots,X^{\mathbf{m}}_n) := {\rm Stratify}(k+1, F, (s,:\mathbf{h}), (i_\ell:\mathbf{i}), G)$$
        where $x:L$ denotes the `cons` operator. I.g., add $x$ to the beginning of list $L$.

      - Let $\rm{Empty}(X,s)$ be a subroutine returning *true* if $s \in \Z[x_1,\ldots,x_n]$ is identically zero on the set $X \subset \R^n$.

      - If $\rm{Empty}(X,s)$, we are finished.

        - Return
        $${\cal X}_{k+1} = (X_{k+1}, X_{k+1}, \ldots, X_n).$$
        where $X_i, k+2\le i \le n$ is the union of all strata $X^{\mathbf{m}}_i$ computed in the recursive calls.

      - Otherwise,

        - Let

          - $X' := \{ \mathbf{x} \in \R^n \mid s(\mathbf{x}) = 0 \}$,

          - ${\cal F} := {\cal F} \cup \{ ((0,\ldots,0,i_\ell,\ldots,i_{k+1},j), s) \}$,

        - $F := F:s$ (i.e., append $s$ to the end of list $F$).

      - Then proceed to the index immediately after $\mathbf{m}$ with respect to $\prec$.

      - The algorithm terminates when maximal index $M_j$ for every polynomial $f_j \in F$ has been considered.
:::

::: {.example}
Consider the semialgebraic set
$$
S := \{ (x_1,x_2) \in \R^2 \mid x_1 x_2 = 0 \}
$$
Apply the algorithm.
\begin{align*}
k=0,X':=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid f_{1}:=x_{1}x_{2}=0\right\} \\\left(0,1,1\right)h_{1}=&f_{1}=x_{1}x_{2}\\s_{1}=\partial f_{1}/\partial x_{1}=&x_{2}\\Y_{1}:=&\left\{ \mathbf{x}\in X'\mid y\ne0\right\} \\U_{1}:=&\left\{ \mathbf{x}\in \mathbb{R}^2\mid x_{1}x_{2}=0,x_{2}\ne0\right\} \\&\text{Proceed by induction}\\
k=1,h_{1}=f_{1},i_{1}=1,X'':=&Y_{1},F_{1}=\left\{ f_{1}\right\} \\\left(1,1\right),h_{2}=&f_{1}\\s_{2}=&\begin{pmatrix}\partial f_{1}/\partial x_{1} & \partial f_{1}/\partial x_{2}\\
\partial f_{2}/\partial x_{1} & \partial f_{1}/\partial x_{2}
\end{pmatrix}=0\\&\text{since both columns are equal.}\\\text{Return. }Y_{1}&\text{ is smooth.}\\
\end{align*}

Observe that the formula for $Y_1$ contains one equation, $h_1 = f_1$. Hence $Y_1$ is a smooth stratum in basic representation and we can conclude that it has codimension $1$.

For the next nonzero derivative, with index $(1,0,1)$, we get
\begin{align*}
k=0,X':=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{1}x_{2}=0,y=0\right\} \\\left(1,0,1\right)\ h_{1}=&f_{1}=x_{1}x_{2}\\s_{1}=\partial f_{1}/\partial x_{2}=&x_{1}\\Y_{1}:=&\left\{ \mathbf{x}\in X'\mid x_{1}\ne0\right\} \\U_{1}:=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{1}x_{2}=0,x_{1}\ne0\right\} \\&\text{Proceed by indection.}\\k=1,h_{1}=f_{1},i_{1}=2,X'':=&Y_{1}\ldots\\&\text{No partial derivatives can be computed.}\\\text{Return. }Y_{1}&\text{ is smooth.}
\end{align*}

Notice that the inductive step returns immediately. This is because $i_1=2$, so it is not possible to take further partial derivatives with respect to $j > i_1$. In the formula for
$$
Y_1 := \{ \mathbf{x} \in \R^2 \mid f_1 := x_1 x_2 = 0, h_1 := x_2 = 0, x_1 \ne 0 \},
$$
two different equations, $f_1$ and $h_1$ appear. However, $Y_1$ is not in basic representation. Indeed, the equation $f_1=0$ is redundant, since $f_1$ is equal to zero for all points at which $h_1$ is equal to zero. Thus $f_1$ can be discarded, and we see that only one equation, $h_1$, is required to represent $Y_1$ in basic form. We can conclude that $Y_1$ is smooth and has codimension $1$.

Finally, consider the derivative with index $(1,1,1)$.
\begin{align*}
k=0,X':=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{1}x_{2}=0,x_{2}=0,x_{1}=0\right\} \\\left(1,1,1\right)\ h_{1}=&s_{1}^{\left(0,1,1\right)}=x_{2}\\s_{1}=\partial f_{1}/\partial x_{2}=&1\\Y_{1}:=&\left\{ \mathbf{x}\in X'\mid1\ne0\right\} \\U_{1}:=&\left\{ \mathbf{x}\in\mathbb{R}^{2}\mid x_{2}=0,1\ne0\right\}
\end{align*}
Again, the inductive step returns immediately because $i_1=2$, but this time we can see that $Y_1$ is not an open subset of $U_1$. As mentioned above, the algorithm is unable to determine this without solving a quantifier elimination problem. Instead, we may be able to determine the codimension by looking at the basic representation of $$
Y_1 := \{ (x_1,x_2) \in \mathbb{R}^2 \mid x_1 x_2 = 0, x_1 = 0, x_2 = 0 \}.
$$
(Note that the constraint $1 \ne 0$ is dropped since it is trivial and adds no information.)
We see that three equations appear in the definition of $Y_1$, but the first one, $f_1 := x_1 y_2$ is redundant again. Thus, the two equations $x_2 = 0, x_1 = 0$ define $Y_1$ and we can conclude that $Y_1$ is smooth and has codimension $2$.
:::

::: {.proposition #bgv-quasi }
[@bgv15, Theorem 3.19]

Let $V_1,\ldots,V_k$ be bounded deﬁnable subsets in $\R^n$ with $\dim (V_i) \le 2$ for each
$1 \le i \le k$.
Then there is a cylindrical cell decomposition of $\R^n$, compatible with each $V_i$ such that every cylindrical cell contained in $V := V_1\cup\ldots\cup V_k$ is the graph of a quasi-affine map.
:::

::: { .theorem #bgv-quasi-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas containing $s$ different polynomials $\mathbf{F} = \{ f_1,\ldots, f_s \} \subset \Z[x_1,\ldots,x_n]$, having maximum degree $d$, such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.

Then there is an algorithm, taking $F_1,\ldots,F_k$ as input, which constructs an $\mathbf{F}$-invariant CAD $\mathcal{D}$ of $\R^n$ such that each cell $C \subset V_1\cup\ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map. $\mathcal{D}$ is obviously compatible with each $V_1,\ldots,V_K$. 
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{2^{O(n)}},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.algorithm data-latex="Quasi-Affine CAD"}
**Input:**
$$(F_1,\ldots,F_k)$$

  - $F_1,\ldots,F_k$: a quantifier-free Boolean formula defining
  $$
  V = V_1 \cup \ldots \cup V_k
  $$
  where $V \subset \R^n$ and $\dim(V_i) \le 2, 1 \le i \le k$.

**Output:**
$$
({\cal D})
$$
  - $\cal D$: an $\mathbf{F'}$-invariant CAD of $\R^n$ compatible with each $V_1,\ldots,V_k$ such that each cell $C \subset V$ is the graph of a quasi-affine map, where $\mathbf{F'}  \subset \Z[x_1,\ldots,x_n]$ contains all polynomials from formulas $F_1,\ldots,F_k$ and, possibly, some additional polynomials which are zero at singular points of $V_1\cup \ldots, \cup V_k$ and the critical points of projections of $Y_1 \cup \ldots \cup V_k$ onto one- and two- dimensional coordinate subspaces.

- Let $$
\mathbf{F} \subset \Z[x_1,\ldots,x_n]
$$
be the set of polynomials appearing in the formulas $F_1,\ldots,F_k$.

- Compute $\cal E$, an $\mathbf{F}$-invariant CAD of $\R^n$ (obviously compatible with each $V_1,\ldots,V_k$) using the McCallum projection operator.

- Let ${\cal A} = ({\cal A}_1,\ldots,{\cal A}_{n})$ be the family of projection polynomials for $\cal E$, where each ${\cal A}_k \subset \Z[x_1,\ldots,x_k]$.

- For each cell $C_k \subset V$ with index $(i_1,\ldots,i_n) \in \{0,1\}^n$, such that $i_{j_1} = \ldots = i_{j_k} = 1$ while all other elements of the index are equal to $0$ (since $\dim(V) \le 2$, $k \le 2$ and $\dim(C_k) = k$):

  - Let $f_1,\ldots,f_{n-k}$ be a set of projection polynomials, where $f_i \in \mathcal{A}_i$, which are equal to $0$ on the cell $C_k$.

  - For each $i \in \{1,\ldots,n\} \setminus \{j_1,\ldots,j_k\}$, find a polynomial in ${\cal A}_i$ which is $0$ at every point $\mathbf{x} \in C_k$. This can be done by checking the set of signs of projection factors.

- For each $2$-dimensional cell $C_2 \subset V$ and pair $1 \le i_1 < i_2 \le n$:

  - Find the set of polynomials $f_1,\ldots,f_{n-2}$ defining $C_2$ as described above.

  - Let $\mathbf{m} = \{j_1,\ldots,j_{n-2}\} = \{1\ldots,n\} \setminus \{i_1,i_2\}$.

  - Define
    \begin{equation}
    J_{C_2,\mathbf{m}} :=
\begin{pmatrix}\partial f_{1}/\partial x_{j_{1}} & \ldots & \partial f_{1}/\partial x_{j_{n-2}}\\
\vdots &  & \vdots\\
\partial f_{n-2}/\partial x_{j_{1}} & \ldots & \partial f_{n-2}/\partial x_{j_{n-2}}
\end{pmatrix},
(\#eq:jacobi-two)
    \end{equation}
    an $((n-2)\times (n-2))$ Jacobi matrix.

    $\det(J_{C_2,\mathbf{m}}) = 0$ at the critical points of $\projops{i_1,i_2}$.

- For each $1$-dimensional cell $C_1 \subset V$ and each $1 \le i \le n$:

  - Find the set of polynomials $f_1,\ldots,f_{n-1}$ defining $C_1$.

  - Let $\mathbf{m} = \{j_1,\ldots,j_{n-1}\} = \{1\ldots,n\} \setminus \{i\}$.

  - Define
  \begin{equation}
  J_{C_1,\mathbf{m}} :=
\begin{pmatrix}\partial f_{1}/\partial x_{j_{1}} & \ldots & \partial f_{1}/\partial x_{j_{n-1}}\\
\vdots &  & \vdots\\
\partial f_{n-1}/\partial x_{j_{1}} & \ldots & \partial f_{n-1}/\partial x_{j_{n-1}}
\end{pmatrix},
(\#eq:jacobi-one)
  \end{equation}
  an $((n-1)\times (n-1))$ Jacobi matrix.

  $\det(J_{C_1,\mathbf{m}}) = 0$ at the critical points of $\projops{i}$.

  - Return the CAD $\cal D$, which is sign invariant on
    \begin{align*}
    \mathbf{F}' =\ & & \mathbf{F}\\
    \cup\ & \bigcup_{C_2 \subset V,\dim(C_2) = 2,\mathbf{m} = \{1,\ldots,n\} \setminus \{i_1,i_2\}, 1 \le i_1 < i_2 \le n} & \det\left(J_{C_2,\mathbf{m}}\right)\\
    \cup\ & \bigcup_{C_1 \subset V,\dim(C_1) = 1,\mathbf{m} = \{1,\ldots,n\} \setminus \{i\}, 1 \le i \le n} & \det\left(J_{C_1,\mathbf{m}}\right).\\
    \end{align*}
:::

::: {.example #monotone-cells}
[@bgv15, Example 3.2]

Let
$$
\Delta := \{ (x,y) \in \R^2 \mid 0 < x < 1, y > 0, x + y < 1 \} \subset \R^2
$$ and
$$
\varphi(x,y) = x^2 + y^2.
$$
Let $Y \subset \R^3$ be the graph of function $\phi$ on $\Delta$. Observe that $Y$ is a cylindrical cell and $\varphi\vert_\Delta$ is a quasi-affine map, since it is strictly increasing in both $x$ and $y$.
However, $y \cap \{ z = 3/4 \}$ is not connected, hence $\phi\vert_\Delta$ is not a monotone function and $Y$ is not a monotone cell.
:::

::: {.definition #sub-cad}
Let $\cal D$ be a CAD of $\R^n$ and suppose that $\mathbf{c} = (c_1,\ldots,c_k)$ is a $0$-dimensional section cell in the decomposition induced by $\cal D$ on $\R^k$.
By [@bgv15 Remark 3.8], the set of all cells of $\cal D$ contained in the affine coordinate subspace
$$
\{ x_1=c_1,\dots,x_k=c_k \}
$$
forms a cylindrical decomposition of $\R^{n-k}$. This decomposition will be called the *sub-decomposition* of $\cal D$ above $c$, and $\mathbf{c}$ the *base cell* of the sub-decomposition (or sub-CAD).
:::

::: {.proposition #bgv-monotone}
[@bgv15, Lemma 3.18]

Let $X \subset \R^2$ be an open, bounded set and $f : X \to \R$ be a quasi-affine function.
Then there is a cylindrical decomposition of $\R^2$ compatible with $X$, obtained by intersecting $X$ with straight lines $$\{x_1 = c\}$$ and half-planes $$\{x_1 < c\},\{x_1 > c\}$$ such that the restriction $f\vert_B$ for every cell $B \subset X$ is a monotone function.
:::

::: { .theorem #bgv-monotone-algorithm }
Let
$$
F_1,\ldots,F_k
$$
be quantifier-free Boolean formulas such that $F_i, 1\le i \le k$ defines a bounded semialgebraic set $V_i \subset \R^n$ such that $\dim(V_i) \le 2$.
Let $\mathbf{F} = \{f_1,\ldots,f_s\}$ be a set of polynomials in $\Z[x_1,\ldots,x_n]$ of maximum degree $d$ and $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ compatible with each $V_1,\ldots,V_k$ and such that each cell $C \subset V_1\cup\ldots\cup V_k$ is a smooth manifold and the graph of a quasi-affine map.

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ monotone with respect to each $V_1, \ldots, V_k$.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{{O(1)^n}},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.proof}
Since $C$ is the graph of a quasi-affine map from $X \to \opspan{x_2,\ldots,x_{\alpha - 1}}$, it follows that the projection map $\projops{x_1,x_\alpha}\vert_C$ is injective. This proves the first claim. The second claim follows by iteratively applying the projection defined in @bgv15, Lemma 3.3 to obtain the $2$-dimensional cylindrical sector cell $X$.
By definition, $$
X := \{ (x_1,t) \in \R^2 \mid x_1 \in X', \varphi(x_1) < t < \psi(x_1) \}
$$
where $\varphi,\psi : X' \to \R$ are continuous definable functions such that $\varphi(x_1) < \psi(x_1)$ for all $x_1 \in X'$.
Note that $X$ may not be bounded from below (resp. above). In this case, we take $\varphi(x_1) = -\infty$ (resp. $\psi(x_1) = \infty$) for all $\mathbf{x} \in X'$. Functions $\varphi$ and $\psi$ are either infinite or finite at every point in $X'$, otherwise, new one-dimensional section cells would exist whose projections onto $\R^1$ form a proper subset of $X'$. This would contradict the cylindrical property.
It is clear from this definition that ${\cal I}(c)$ contains a single open interval $(\varphi(c), \psi(c))$, proving the third claim. It follows that $\gamma$, which consists of the endpoints of intervals in ${\cal I}(c)$, consists of one-dimensional curve intervals which are the graphs of $\varphi$ and $\psi$ (if finite).

The proof of the final claim is completed by defining the functions $\varphi$ and $\psi$.

Since $C' := \projop{\alpha - 1}(C)$ is a $(1,\ldots,0,0)$-cell, it is the graph of a continuous definable map $\mathbf{h} = (h_1,\ldots,h_{\alpha - 2}) : X' \to \R^{\alpha - 2}$ and $$
C = \{ (\mathbf{x},t) \mid \mathbf{x} \in C', f(\mathbf{x}) < t < g(\mathbf{x})\}
$$
where $f,g : \R^{\alpha - 1} \to \R$ are continuous definable functions such that $f(\mathbf{x}) < g(\mathbf{x})$ for all $\mathbf{x} \in C'$.
Again, if not bounded from above (resp. below), $f$ (resp. $g$) are taken to be $-\infty$ (resp. $\infty$) at every point.
Observe that the graph of $f$ (if finite) is the bottom of $C$ and the graph of $g$ (if finite) is the top of $C$.

Writing $C$ in terms of $x_1 \in X'$, $f$, $g$ and $\mathbf{h}$, we obtain the functions
\begin{align}
\varphi &:\> C'' \to \R & \psi &:\> C'' \to \R\\
\varphi(x_1) &= f(x_1,\mathbf{h}(x_1)) & \psi(x_1) &= g(x_1,\mathbf{h}(x_1))
(\#eq:phi-psi)
\end{align}
:::

::: {.proposition #lagrange-multipliers}
Let $f : \R^n \to \R$ and $g_1,\ldots,g_k : \R^n \to \R$ be continuous functions with continuous first partial derivatives.
Local maxima and minima of $f$, subject to the constraints $g_1=0,\ldots,g_k=0$ can be found by computing the critical points of the function
$$
\mathcal{L}(\mathbf{x}, \lambda_1,\ldots,\lambda_k) = f(\mathbf{x}) - \lambda_1 g_1(\mathbf{x}) - \cdots - \lambda_k g_k(\mathbf{x}),
$$
where $\mathbf{x} \in \R^n$ and $(\lambda_1,\ldots,\lambda_k) \in \R^k$ are new variables.

Critical points can be found by solving the system of equations
\begin{equation}
\dfrac{\partial f}{\partial x_i} - \lambda_1 \dfrac{\partial g_1}{\partial x_i} - \cdots - \lambda_k \dfrac{\partial g_k}{\partial x_i}= 0,
(\#eq:lagrange)
\end{equation}
where $1\le i \le n-1$,

for $\lambda_1,\ldots,\lambda_k$.
:::

::: {.remark #lagrange-solve}
Using variables $(x_1,\ldots,x_{\alpha-1})$, constraints $g_2,\ldots,g_{\alpha - 1}$ and function $h$ from Equation \@ref(eq:c-alpha-top), the system from Equation \@ref(eq:lagrange) can be written in matrix form as follows.
$$
\begin{pmatrix}\dfrac{\partial g_{2}}{\partial x_{1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{1}}\\
\vdots &  & \vdots\\
\dfrac{\partial g_{2}}{\partial x_{\alpha-1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{\alpha-1}}
\end{pmatrix}\begin{pmatrix}\lambda_{1}\\
\vdots\\
\lambda_{\alpha-2}
\end{pmatrix}=\begin{pmatrix}\dfrac{\partial h}{\partial x_{1}}\\
\vdots\\
\dfrac{\partial h}{\partial x_{\alpha-1}}
\end{pmatrix}
$$

It is clear that, if a solution exists, then the last column
$\left(\tfrac{\partial h}{\partial x_{1}},\ldots, \tfrac{\partial h}{\partial x_{\alpha-1}}\right)^T$
will be a linear combination of the first $\alpha - 1$ columns (in $g_2,\ldots,g_{\alpha - 1}$).
Hence, optimal values for $(x_1,\ldots,x_{\alpha-1})$ exist and satisfy the equation
\begin{equation}
\det\begin{pmatrix}\dfrac{\partial g_{2}}{\partial x_{1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{1}} & \dfrac{\partial h}{\partial x_{1}}\\
\vdots &  &  & \vdots\\
\dfrac{\partial g_{2}}{\partial x_{\alpha-1}} & \cdots & \dfrac{\partial g_{\alpha-1}}{\partial x_{\alpha-1}} & \dfrac{\partial h}{\partial x_{\alpha-1}}
\end{pmatrix}=0.
(\#eq:jacobi-det)
\end{equation}
:::

::: {.proposition #monotone-sector-algorithm }
Let $\mathcal{D}$ be a sign-invariant CAD of $\R^n$ compatible with each set $V_1,\ldots,V_k \subset \R^n$ with $\dim(V_i) \le 2$ and such that each cell $C \subset V_i$ is the graph of a quasi-affine map, for $1\le i \le k$. Let
$$
{\cal A} = ({\cal A}_1,\ldots,{\cal A}_n),
$$
where ${\cal A}_k \subset \Z[x_1,\ldots,x_k], 1 \le k \le n$, be the projection polynomials defining $\cal D$.
Let $C$ be a $(1,0,\ldots,0,1)$-cell of the decomposition induced by $\cal D$ on $\R^{\alpha}$ such that $\projop{\alpha}^{-1}(C)$ is a cell of $\mathcal{D}$ contained in $V_1,\ldots,V_k$.

Then there is an algorithm, taking $\mathcal{D}$ and $\mathcal{A}$ as input, which produces a set of algebraic numbers $(c_1,\ldots,c_t)$ such that $C \cap \{ c_i < x_1 < c_{i+1} \}$ is monotone. Each $c_i, 1 \le i < t$ is represented by a pair $(m_i, J_i) \in \Z[x_1] \times \Q$ (see Equation \@ref(eq:algebraic-number).
:::

::: {.remark}
Let $f \in \Q[x_1,\ldots,x_n]$ be a polynomial such that
$$
f(x_1,\ldots,x_n) = \dfrac{a_1}{b_1} m_1 + \cdots + \dfrac{a_k}{b_k} m_k
$$
where $m_i = x_1^{d_{i,1}} \cdots x_n^{d_{i,n}}$ for $1 \le i \le k$ is a monomial in $x_1,\ldots,x_n$.

Let $M := \lcm(b_1, \ldots, b_k)$ be the least common multiple of denominators and construct
$$
g(x_1,\ldots,x_n) = M f(x_1,\ldots,x_n) = \dfrac{M a_1}{b_1} m_1 + \cdots + \dfrac{M a_k}{b_k} m_k.
$$
Each coefficient in $g$ will be an integer number since $M$ is divisible by all $b_1,\ldots,b_k$ and polynomials $f$ and $g$ have the same roots.
:::

::: {.definition #norm}
Let $K$ be a field and $L$ a finite (algebraic) extension of $K$.
The field $L$ can be thought of as a finite dimensional vector space over $K$.

Consider $f$ and $m$ be polynomials in $L[x_1,\ldots,x_n]$, viewed as polynomials in $K[x_1,\ldots,x_n,x_\alpha]$.
The norm, in $L[x_1,\ldots,x_n]$ of $f$ can be found by computing the resultant of $f$ and $m$.
:::

::: {.remark}
Let $f \in \A[x_1,\ldots,x_n]$ be a polynomial such that
$$
f(x_1,\ldots,x_n) = a_1 m_1 + \cdots + a_k m_k
$$
where $m_i = x_1^{d_{i,1}} \cdots x_n^{d_{i,n}}$ is a monomial in variables $x_1,\ldots,x_n$ and $a_i$ is an element of the algebraic extension of the rational numbers $\Q(\alpha)$ for $1 \le i \le k$.

Let $m \in \Z[\alpha]$ be the minimal polynomial for $\Q(\alpha)$. $f$ can be written as a polynomial in $\Q[x_1,\ldots,x_n,x_\alpha]$ and $m$ can be viewed as a polynomial in $\Q[x_1,\ldots,x_n,x_\alpha]$ which is independent of all $x_1,\ldots,x_n$. Compute
$$
g := \res_\alpha (f,m)
$$
to obtain a polynomial in $\Q[x_1,\ldots,x_n]$. The property that $f(\mathbf{x}) = 0$ if and only if $g(\mathbf{x}) = 0$ follows from a property of resultants:

> Let $I = \langle f, m \rangle$ be the ideal generated by polynomials $f, m \in K[x_1,\ldots,x_n][\alpha]$, where $K$ is an algebraically closed field.
If at least one of $f$ and $m$ is monic, then
>$$
\res_\alpha (f,m) \in I \cap R.
$$

It follows that $\mathbf{x} \in K^n$ is a common zero of the elements of $I \cap R$ if and only if it is a zero of $\res_\alpha(f,m)$.

<!-- TODO this property came from the wiki page on resultants. does it need proving? -->
:::

::: {.lemma #one-dim-qa-is-monotone}
Let $Y \subset \R^n$ be the graph of a quasi-affine map
$$
\mathbf{f} : (a,b) \to \R^{n-1}
$$
such that $(a,b) \subset \R$. Then $Y$ is a monotone cell.
:::

::: {.proof}
Consider a quasi-affine component $f_j : (a,b) \to \R$ of the map $\mathbf{f}$. By definition, $f_j$ is either strictly increasing in, strictly decreasing in, or independent of $x_i$. Assume for contradiction that $Y$ is not monotone and the intersection $Z := Y \cap \{ x_i = c \}, c \in \R$ is not connected. Since $Y$ itself is connected, $Z$ would consist of two isolated points. It is clear that the projection map $\projops{x_i}\vert_Y$ is not injective and its image would be one-dimensional (if not, $f_j$ would be constant and equal to $c$ and Z would have one connected component).

The proof is completed by applying this argument to each component of the map $\mathbf{f}$.
:::

::: {.proposition #monotone-section-algorithm}
Let $\mathcal{D}$ be a CAD of $\R^n$ compatible with each set $V_1,\ldots,V_k \subset \R^n$ with $\dim(V_i) \le 2$ and such that each cell $C \subset V_i$ is the graph of a quasi-affine map, for $1\le i \le k$. Let
$$
{\cal A} = ({\cal A}_1,\ldots,{\cal A}_n),
$$
where ${\cal A}_k \subset \Z[x_1,\ldots,x_k], 1 \le k \le n$, be the projection polynomials defining $\cal D$.
Let $C$ be a $2$-dimensional section cell of the decomposition induced by $\cal D$ on $\R^{j}$ such that $\projop{j}^{-1}(C)$ is a cell of $\mathcal{D}$ contained in $V_1,\ldots,V_k$ and $\projop{j-1}(C)$ is monotone.

Then there is an algorithm, taking $\mathcal{D}$ and $\mathcal{A}$ as input, which produces a set of algebraic numbers $(c_1,\ldots,c_r)$ such that $C \cap \{ c_i < x_1 < c_{i+1} \}$ is monotone. Each $c_i, 1 \le i \le r$ is represented by a pair $(m_i, J_i) \in \Z[x_1] \times \Q$ (see Equation \@ref(eq:algebraic-number).
:::

::: {.Remark #monotone-sub-cad }
propositions \@ref(prp:monotone-sector-algorithm) and \@ref(prp:monotone-section-algorithm) can also be applied to two-dimensional $(0,\ldots,0,1,i_{k+1},\ldots,i_n)$-cells by working in a sub-cad of $\R^{n-k+1}$ above a zero-cell, as described in Section \@ref(sec:sub-cad).
:::

::: {.algorithm data-latex="Monotone CAD"}
**Input:**
$$({\cal E}, {\cal A})$$

  - $\cal E$: a cylindrical algebraic decomposition of $\R^{k+n}$, such that each cell is the graph of a quasi-affine map. Each cell $C$ of $\cal E$ has a truth-value (*true* or *false* attached.

  - ${\cal A} = {\cal A}_1,\ldots,{\cal A}_{k+n}$ is the family of projection polynomials where each ${\cal A}_i \subset \Z[x_1,\ldots,x_i]$.

**Output:**
$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} = \{ c_1,\ldots,c_t \} \subset \A \mid \mathbf{b} \in \R^{k-1} \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^k \}
$$
such that, for each ${\cal R}_\mathbf{b}$, intersecting the sub-cad $\cal D$ above $\mathbf{b}$ with straight lines and half-planes of the kind $\{x_1 < c_i \}, \{x_1 = c_i \}, \{x_1 > c_i\}, 1 \le i \le t$ results in a refinement of $\cal D$ such that each true cell of $\cal D$ with dimension at most $2$ is monotone.

First, define a subroutine
$${\rm sub}_{\mathbf{y}} (g) \mid g \in \Z[y_1,\ldots,y_m,x_1,\ldots,x_n], \mathbf{y} \in \A^m, n > 0,$$
which computes $h := g(\mathbf{y}) \in \A[x_{1},\ldots,x_m]$ and returns the normalised polynomial of $h$, in $\Z[x_{m+1},\ldots,x_n]$ (see Section \@ref(sec:sub-cad)).

It will be convenient to overload this operator and write ${\rm sub}_{\mathbf{y}} (L)$, where $L$ is a set (or list) of polynomials to mean $\{ {\rm sub}_{\mathbf{y}} (g) \mid g \in L \}$.

Now define a structure to store refinement polynomials
$$
{\cal F} := \{ {\cal F}_{\mathbf{b}} := \emptyset \mid \mathbf{b} \in \R^{k-1}, k > 0 \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^{k-1} \}
$$
and a similar structure to store refinement points
$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} := \emptyset \mid \mathbf{b} \in \R^{k-1}, k > 0 \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^{k-1} \}
$$
*(Note: for each $(0,\ldots,0)$-cell $\mathbf{b}$, ${\cal F}_\mathbf{b}$ is a set of univariate polynomials, ${\cal R}_{\mathbf{b}}$ is the set of roots of polynomials ${\cal F}_\mathbf{b}$. When $k=1$, then the CAD of $\R^0$ consisting of the unique point of $\R^0$ is used -- practically speaking, we work directly with the CAD $\cal E$.)*

Let $\mathbf{b}$ be a $(0,\ldots,0)$-cell of the decomposition induced by $\cal E$ on $\R^{k-1}, k > 0$. Let $\cal D$ be the sub-decomposition of $\R^n$ of $\cal E$ above $\mathbf{b}$.

Consider each cell $C$ of $\cal D$ with truth value *true*. Let $C$ have index
$$
(0,\ldots,0,1,i_{k+1},\ldots,i_{k+n})
$$
in $\cal E$. If $i_{k+1} + \cdots + i_n > 2$, then $\dim(C) > 2$ and the algorithm will fail. Otherwise, let $\alpha$ be the smallest among $x+1,\ldots,k+n$ such that $i_{k+1} = \ldots = i_{\alpha - 1} = 0$ and $i_\alpha = 1$.
Then:

- Let

  - $\mathbf{b} := \projop{k-1}(C)$,

    *(Note: observe that $\mathbf{b} \in A^{k-1}$. If $k = 1$, then $\mathbf{b}$ is the unique cell, $\mathbf{0}$, in the CAD of $\R^0$. In this case, it is clear that ${\rm sub}_\mathbf{0} (g) \equiv g$.)*

  - $C'' \subset \A := \projop{k}(C)$ ($(1)$-cell), and let $(C''_B, C''_T)$ be $(0)$-cells which are the endpoints of $C''$,

  - ${\cal G} := {\rm sub}_{\mathbf{b}} \{ g_i \mid k+1 \le i \le \alpha - 1, g_i \in {\cal A}_i, g_i(\mathbf{x}) = 0 \ \forall \mathbf{x} \in \projop{\alpha-1}(C) \}$,

  - $C' := \projop{\alpha}(C)$.

- $C'_T$ and $C'_B$ be the top and bottom, respectively, $C'$.

(*Note: If $C'$ is not bounded from above (resp. below) by a continuous definable function, i.e., there is no section above (resp. below) $C'$, then let $C'_T := \emptyset$ (resp $C'_B$) and skip any computations involving $C'_T$ (resp $C'_B$).)*

- Let $j = \alpha$ and do:

  - **(*)** For $\delta \in \{B, T\}$, if $C_\delta$ is not empty, do:

    - Let $\rm{sub}_{\mathbf{b}} (g_j) \in \Z[x_{k+1,\ldots,x_j}]$ be such that $g_\alpha(\mathbf{x}) = 0$ for all $\mathbf{x} \in C'_\delta$.

    - Compute
    $$
f_\delta := \det\begin{pmatrix}\dfrac{\partial g_{k+1}}{\partial x_{k}} & \cdots & \dfrac{\partial g_{j-1}}{\partial x_{k}} & \dfrac{\partial g_{j}}{\partial x_{k}}\\
\vdots &  &  & \vdots\\
\dfrac{\partial g_{k+1}}{\partial x_{j-1}} & \cdots & \dfrac{\partial g_{j-1}}{\partial x_{j-1}} & \dfrac{\partial g_{j}}{\partial x_{j-1}}
\end{pmatrix},
    $$
from Equation \@ref(eq:jacobi-det), using constraints $g_{k+1},\ldots,g_{\alpha+1}$, and discarding denominators $\partial g_\alpha / \partial x_\alpha$ of the total derivatives in the last column.

  - Let $${\cal H} := \{ g_{k+1},\ldots,g_{j-1}, f_B, f_T \}$$
be a set of polynomials and compute
$$
{\cal F}_{\mathbf{b}} := {\cal F}_{\mathbf{b}} \cup \projop{1}({\cal H}) \subset \Z[x_k].
$$

  - If $j < n$, then

    - Add $g_j$ to $\cal G$, i.e., let
      $$
      {\cal G} := {\cal G} \cup \{ g_j \}.
      $$

    - Let $j := j+1$.

    - Let
      $$
      C' := \projop{j}(C)
      $$
      $C'$ is a section cell, and its top and bottom may not be graphs of continuous functions. Use QE to compute
      $$
      ...
      $$

- For each $(0,\ldots,0)$-cell $\mathbf{b} \in \A^k$, consider
$$
{\cal F}_{\mathbf{b}} \in {\cal F} \in \Z[k],
$$
compute
$$
{\cal R}_{\mathbf{b}} := (c_1,\ldots,c_t)
$$
by isolating the real roots of polynomials in ${\cal F}_{\mathbf{b}}$.

- Return the family ${\cal R}$ of refinement points.
:::

::: { .example #whitney-jhd }
[@jhd20, Example 2.1]

Let $f := y^2 - x^2 z$ and observe that $f(0,0,z) = 0, z \in \R$, i.e., $f$ "blows up" above the origin. Let $\Delta := \{(x,y) \in \R^2 \mid 0 < x < 1, -x < y < x \} \subset \R^2$ and let
$$
W := \{ (x,y,z) \in \R^3 \mid (x,y) \in \Delta, f(x,y,z) = 0 \}.
$$
Consider $\fr{W}$, which can be expressed as the disjoint union of four basic semialgebraic sets:
\begin{align}
\fr{W} =&\ \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y = x, z = 1 \} \\
\cup&\ \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y = -x, z = 1 \} \\
\cup&\ \{ (x,y,z) \in \R^3 \mid x = 1, -1 < y < 1, z = y^2 \} \\
\cup&\ \{ (0,0,z) \in \R^3 \mid 0 \le z \le 1 \}.
(\#eq:jhd-whitney-blow-up)
\end{align}
Due to the blow-up point above the origin, $\fr{W}$ contains the subset $B := \{ (0,0,z) \in \R^3 \mid 0 \le z \le 1 \}$ (from Equation \@ref(eq:jhd-whitney-blow-up)).

A CAD having constant sign on the polynomials
$$
\{ x, x - 1, x + y, x - y, y^2 - x^2 z \}
$$ defining $W$ will not contain the blow-up subset $B$, because two additional polynomials, $z$ and $z-1$, are needed to define it.
:::

::: {.lemma #frontier}
Let $S \subset \R^n$ be a semialgebraic set defined by a quantifier-free Boolean formula $F$
containing $s$ different polynomials in $\R [x_1, \ldots ,x_n]$ having maximum degree $d$.
There is an algorithm, taking $F$ as input, which represents the semialgebraic set $\fr{ S }$ by a quantifier-free Boolean formula $F'$ with complexity
$$(sd)^{O(n^2)}.
$$
This is also an upper bound on the number of polynomials in $F'$ and their degrees.
:::

::: { .theorem #lazard-rn }
Let $\mathbf{F} \subset \Z[x_1,\ldots,x_n]$ be a set of $s$ polynomials with maximum degree $d$.
Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$, compatible with some bounded definable semialgebraic sets $V_1,\ldots,V_k$, which $\dim(V_i) \le 2$ and such that each cell $C \subset V_i$ is monotone.

Then there is an algorithm, taking $\mathcal{D}$ as input, which produces a refinement $\mathcal{D'}$ of $\mathcal{D}$ such that each cell $C \subset V_1\cup\ldots\cup V_k$ of $\mathcal{D'}$ satisfies the frontier condition.
This algorithm has complexity
$$
\left(s\left(d+1\right)\right)^{2^{O(n)}},
$$
which is also an upper bound on the number of cells in the CAD, number of polynomials and their degrees.
:::

::: {.definition #laz-properties }
[@lazard10, Definition 2.7]

1. A cylindrical cell $C$ is boundary smooth if the intersection with $C$ of every small open ball centred on the boundary of $C$ is connected
2. A $k$-dimensional cylindrical cell is well-bordered if $\fr{C}$ is the closure of some $k-1$-dimensional cylindrical cells.
3. A cylindrical cell $C$ is boundary coherent if $\fr{C}$ is a union of cells.
:::

::: {.remark}
[@lazard10, Definition 2.7]

These properties can be extended from cells to the whole CAD. I.e., a CAD $\mathcal{D}$ is called well-bordered (resp. boundary coherent, boundary smooth) if every cell in $\mathcal{D}$ is well-bordered (resp. boundary coherent, boundary smooth).
:::

::: {.remark}
If a cylindrical cell satisfies Property 2 of Definition \@ref(def:laz-properties) (boundary smooth) then it is a topologically regular cell.

Property 3 of Definition \@ref(def:laz-properties) (boundary coherent) is the frontier condition (see Definition \@ref(def:frontier-condition)).
@jhd20 call this property closure finiteness.
:::

::: {.definition}
[@lazard10, Definition 2.7]

A CAD is called "strong" if every cell is boundary smooth, well-bordered and boundary coherent.
:::

::: {.definition}
[@lazard10, Definition 4.1]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ and $\mathcal{D'}$ be the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$. A cell $C'$ of $\mathcal{D'}$ is called "bad" if there is a polynomial $f \in \mathbf{F} \subset \Q[x_1,\ldots,x_n]$ such that $f$ is primitive and has positive degree in $x_n$ and $f(\mathbf{x})$, for all $\mathbf{x} \in C'$ vanishes over an open interval. Every point $\mathbf{x}$ in the bad cell $C'$ is a blow-up point of the polynomial $f$ (see Definition \@ref(def:blow-up-point)).
:::

::: {.corollary #lazard-5-4}
[@lazard10, Corollary 5.4]

Every $\mathbf{F}$-invariant CAD of $\R^n, n \le 3$ is well-bordered.
:::

::: {.lemma #lazard-5-2}
[@lazard10, Proposition 5,2]

Let $\cal D$ be a CAD of $\R^n$ and $\cal D'$ the decomposition induced by $\cal D$ on $\R^{n-1}$. Let $C$ be a cell of $\cal D$ and $C' := \projop{n-1} (C)$ such that $C'$ is well-bordered.
If $p \in \fr{C'}$, then $I := (p \times \R) \cap \fr{C}$ is connected.
$I$ is therefore a point or a closed segment, either bounded or unbounded.
Furthermore, if $C$ is a sector cell, then the set of points of $I$ which do not belong to the boundaries of the section cells delineating $C$ is either empty or an open interval.
:::

::: { .lemma #only-bad-zero-cells }
[@lazard10, Lemma 4.3]

A sign-invariant CAD of $\R^2$ contains no bad cells.

For an $\mathbf{F} \subset \Q[x_1,x_2,x_3]$-invariant CAD $\mathcal{D}$ of $\R^3$, if the decomposition induced by $\mathcal{D}$ on $\R^2$ contains a bad cell, then it is a $(0,0)$-cell.
:::

::: { .lemma #no-blow-up }
[@lazard10, Theorem 4.4]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$ with $C' := \proj_{\R^{n-1}}(C)$. If the decomposition induced by $\cal D$ on $\R^{n-1}$ is strong and none of $C'$ and any cell $D'$ such that $D' \cap \fr{C'} \ne \emptyset$ is bad, $C$ is well-bordered, boundary smooth and $\fr{C}$ is a union of some cells of $\mathcal{D}$.
:::

::: {.proof}
This result follows from the following fact about roots of multivariate polynomials: given a polynomial $f  \in \Q[x_1,\ldots,x_{n-1}][x_n]$, i.e., considered as a univariate polynomial with polynomial coefficients, its complex roots depend continuously on the parameters in the region of the parameter space where the polynomial does not vanish identically. In fact, this is only true in the projective closure of $\mathbb{C}$ as some roots may pass through the point at infinity if the leading coefficient is zero.

First suppose that $C$ is a section cell. I.e., it is a root of some polynomial $f$ and $\fr{C}$ is defined as the limit of this root over the boundary of $C'$. Thus $\projop{n-1}$ is a continuous, injective map from $\fr{C}$ to $\fr{C'}$. This follows from the assumption that the decomposition induced by $\cal D$ on $\R^{n-1}$ is strong and that if the root defining the section $C$ is infinite over some cell $C'' \subset \fr{C'}$, then it is also infinite over $\fr{C''}$.

Now suppose that $C$ is a sector cell. If nonempty, the top $C_T$ and bottom $C_B$ of $C$ are section cells. We complete the proof by describing $W := \fr{C} \setminus (C_T \cup C_B)$.
We will only consider the case where $C \cap \{ \mathbf{x} \times \R \}$ is an open interval bounded from below by a point in $C_B$ and above by a point in $C_T$.

Let $\dim(C) = d + 1$. $\fr{C}$ consists of

- the cells in $\fr{C_B}$ and $\fr{C_T}$, which have dimension $< d$ and are contained in $\fr{C'} \times \R$,
- the intervals (which may be empty) bounded by the points in $\fr{C_B}$ and $\fr{C_T}$, contained in $C' \times \R$. Since $C_B$ and $C_T$ are section cells, they are roots of polynomials $f$ and $g$ and, if finite, the points in $\fr{C_B}$ and $\fr{C_T}$ are also roots of $f$ and $g$ (respectively). Therefore, these intervals are contained in some cells of $\cal D$. More precisely, the cells with dimension $d$ contained in $\fr{C'} \times \R$ are exactly those lying over a cell $C'' \subset \fr{C'}$ with dimension $d-1$.

A cell of dimension $< d$ either belongs to $\fr{C_B}$ or $\fr{C_T}$, or is a sector over a cell $D \subset \fr{C'}$ having dimension less than $d-1$.
As $C'$ is well-bordered, $D$ belongs to the boundary of some cell $E \subset \fr{C'}$ having dimension $d-1$.
Thus, the sector above $D$ is contained in the boundary of the sector above $E$, which has dimension $d$

This proves that, if the decomposition induced by $D$ on $\R^{n-1}$ is strong, then $C$ is well-bordered and also satisfies the frontier condition. In addition, this proves that $C$ is a topologically regular cell as $C$ and $\fr{C}$ are either homeomorphic to $C'$ and $\fr{C'}$, if $C$ is a sector cell, or to an open cylinder, either bounded or unbounded, and its boundary. It is clear that an open cylinder contained in $C' \times \R$, where $C'$ is topologically regular, is also topologically regular.

The other cases are deduced by omitting the cells defined from $C_B$ and $C_T$ as appropriate.
:::

::: {.lemma #lazard-5-13}
[@lazard10 Proposition 5.13]
Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^3$ and $C$ be a well-bordered, boundary smooth cell of $\mathcal{D}$.
Suppose that $D$ is a cell of $\mathcal{D}$ such that $B := D \cap \fr{ C } \neq \emptyset$ and $B \neq D$. Then either

  1. $C$ is a $1$-dimensional section cell whose endpoint, $B$, projects on a bad cell, or
  2. there exists a cell $E$ of $\mathcal{D}$ such that $\dim(E) < \dim(C)$ and $\emptyset \neq D \cap \fr{ E } \neq D$.
:::

::: {.proof}
By the proof of @lazard10, Theorem 4.4, $D$ will always be a $(0,0,1)$-cell in the cylinder above a bad cell $D'$.

Consider each case for $C$ by cell index.

- $(1,1,1)$-cell: since $C$ is well-bordered, its boundary is the closure of some 2-dimensional cells of $\cal D$ and $B$ is contained in the union of the boundaries of the 2-cells. Thus, case 2 applies and we can choose an appropriate 2-dimensional cell in $\fr{C}$ for $E$.

- $(1,0,1)$- or $(0,1,1)$-cell, we write $(i,j,1)$-cell where $i+j=1$: observe that $C$ (if bounded) is delineated by some $(i,j,0)$-cells (one-dimensional curve intervals). Take $B$ to be the one-dimensional interval delineated by the endpoints of these cells. Since $B \neq C$, at least one of these endpoints is not a $(0,0,0)$-cell of $\cal D$. Case 2 applies, taking as $E$ the delineating $(i,j,0)$-cell.

- $(1,0,0)$- or $(0,1,0)$-cells: consider the previous case, letting $C = E$.

- $(1,1,0)$-cell: these are necessarily the root of a polynomial $f \in \Q[x_1,x_2,x_3]$ which vanishes identically on $D'$, a $(0,0)$ cell in the decomposition induced by $\cal D$ on $\R^2$.
Let $V_r$ be a small neighbourhood (with radius $r > 0$) centred around $D'$ and consider $V_r'$, the cylinder above the boundary of $V_r$. Since $C$ is a monotone cell, the maximum and minimum values of $x_3$ in this intersection are reached on the boundary of $C$, for sufficiently small $r$. The limits, as $r$ tends to $0$, of this maximum and minimum clearly belong to the boundary of $B$, if these limits do not tend to infinity. Note that both the maximum and minimum cannot be infinite, since this would imply that either $B$ is empty, or coincides with $D$. Therefore, the non-infinite limits are the endpoints of some $1$-dimensional cell belonging to the boundary of $C$. Case 2 applies, taking $E$ to be this $1$-dimensional cell.

- $(0,0,1)$- or $(0,0,0)$-cells: don't satisfy the hypothesis, there is nothing to do.
:::

::: { .proposition #lazard-5-14 }
[@lazard10, Proposition 5.14]
Let $f \in \Q[x_1,x_2,x_3]$ be an irreducible polynomial of the kind
$$f = g_dx_3^d + \ldots + g_1x_3 + g_0$$
with each $g_i \in \Q[x_1,x_2]$, and
$$\mathbf{p} = (p_1,p_2)$$
be a common root of $g_d,\ldots,g_1,g_0$.
Let $g\in \Q[x_1,x_2]$ be an irreducible polynomial having $\mathbf{p}$ as a root.
The limits of the common roots of $f$ and $g$ as $(x_1, x_2) \to \mathbf{p}, (x_1, x_2) \ne \mathbf{p}$ may be computed as solutions of a zero-dimensional
polynomial system.
:::

::: {.proof}
Since $f$ is irreducible, it has at least two coefficients, $g_i,g_j \in \Q[x_1,x_2]$, whose GCD is a constant.
Therefore, any ideal generated by these coefficients has dimension zero. Any ideal containing these coefficients also contains another element, $h$, which is not a multiple of $g$.

The saturation by $h$ of the ideal $\langle f,g \rangle$ is defined as the ideal
$$
S := \langle f, g, 1 - zh \rangle \cap \Q[x_1,x_2,x_3].
$$
The irreducible components of the zero set of $S$ are those of the zero set of $\langle f,g \rangle$ at which $h$ is not identically zero. It follows that the vertical line $\{ x_1 = p_1, x_2 = p_2 \}$ which is part of the zero set of $f$ ,$g$ and $h$, is not contained in the zero set of $S$. Meanwhile, the zero set of $S$ contains the limit points we are interested in finding.

Therefore, the ideal generated by $S$ and the coefficients $g_0,\ldots,g_d$ of $f$ is zero-dimensional and the limits of $\{ f=0,g=0 \}$ as $(x_1,x_2) \to \mathbf{p}$ can be computed as the zeros of $S$.
:::

::: {.proposition #cox-zariski}
[@cox2013 p203, part of Theorem 10]
Let $I,J \subset K[x_1,\ldots,x_n]$ be ideals, then
$\cl{ V(I) \setminus V(J) } \subset V(I : J^\infty)$,
:::

::: {.proof}
We claim that $I \subset I:J \subset I:J^\infty \subset I(V(i0) \setminus V(J))$. We have $I \subset I:J \subset I:J^2 \subset \cdots \subset I:J^\infty$ by the ascending chain condition.
Suppose that $f \in I:J\infty$ and $a \in V(I) \setminus V(J)$. Then $fg^N \in I$ for all $g \in J$ and a suitable (large enough) $N\ge 0$. Since $a \in V(I)$, $f(a)g^N(a) = 0$ (for all $g\in J$ and large enough $N$). Since $a \not \in V(J)$, there exists $f \in J$ and $N \ge 0$ such that $g(a) \ne 0$. Hence $f(a) = 0$ for all $a \in V(I) \setminus V(J)$. We have $f \in I(V(I) \setminus V(J))$. Transitivity of $\subset$ proves the claim. Since $V$ reverses inclusion, we have $= \cl{ V(i) \setminus V(J) } = V(I(V(i) \setminus V(J))) \subset V(I:J^\infty)$.
:::

::: {.algorithm data-latex="Lazard Lifting With Bad Points in $\R^3$"}
[@lazard10, Algorithm 5.15]

**Input:**
$$({\cal A}, {\cal D})$$

  - ${\cal A} = {\cal A}_1,{\cal A}_2,{\cal A}_3$ is the family of projection polynomials, each $\mathcal{A}_k \subset \Q[x_1,\ldots,x_k]$,

  - $\cal D$: is an $\mathcal{A}$-invariant CAD of $\R^3$ such that every cell of $\mathcal{D}$ is a topologically regular cell.

**Output:**

$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} = \{ c_1,\ldots,c_t \} \subset \A \mid \mathbf{b} \in \R^{2} \text{ is a } (0,0) \text{-cell in the decomposition induced by } {\cal D} \text{ on } \R^2 \}
$$

A set of refinement points, as described in Section \@ref(sec:monotone-algorithm).

- Let ${\cal R} = \emptyset$.

- Let $\cal D'$ be the decomposition induced by $\cal D$ on $\R^2$.

- For each $(0,0)$-cell $\mathbf{b}$ of $\cal D'$, determine whether it is a bad cell.

  $\mathbf{b}$ is a bad cell if there exists a polynomial $f \in {\cal A}_3$ such that $f$ has constant sign on a $(0,0,1)$-cell $C$ of $\cal D$ such that $\mathbf{b} = \projop{2}(C)$.

  (Note: this is an easy check -- simply look at the signs of polynomials in $\mathcal{A}_3$ on $C$. This is part of the information stored about $C$.)

- If $\mathbf{b}$ is bad:

  - Let $g_1 \in {\cal A}_1, g_2 \in {\cal A}_2$ such that $g_1(\mathbf{b}) = 0$ and $g_2(\mathbf{b}) = 0$ (find $g_1$ and $g_2$ using signs of projection polynomials on $\mathbf{b}$).

  - Let ${\cal A'} := {\cal A}_1 \cup {\cal A}_2$.

  - For each $g \in {\cal A'}$, do

    - If $g \in \Q[x_1]$, then $h := g_2$. Otherwise, $g \in \Q[x_1,x_2]$ and $h := g_1$.

    - Define the saturation
    $$
    I := \langle f, g, 1 - z h \rangle \cap \Q[x_1,x_2,x_3],
    $$
    where $z$ is a new variable.

    - Compute a generator system $S$, i.e., a Groebner basis for the ideal $I$.

    - Compute
    $$
    L := \{ {\mathrm{sub}}_{\mathbf{b}}(f') \in \Q[x_3] \mid f' \in S \}
    $$
    and find the real roots
    $$
    (c_1,\ldots,c_t)
    $$
    of $L$.

    - Let
    $$
    {\cal R} := {\cal R} \cup \{ {\cal R}_{\mathbf{b}} = (c_1,\ldots,c_t) \}.
    $$

- return $\cal R$.
:::

::: {.definition #strong-about-c }
Let $\mathcal{D}$ be a CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$. $\mathcal{D}$ will be called strong about $C$ if $C$ is well-bordered, boundary coherent and every cell contained in $\cl(C)$ is boundary smooth.
:::

::: {.theorem #lazard-5-3}
[@lazard10, Theorem 5.3]

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^3$ such that the decomposition induced by $\mathcal{D}$ on $\R^2$ is strong. Then every cell $C$ of $\mathcal{D}$ is well-bordered.
:::

::: {.proof}
If $\dim(C) < 2$, then $C$ is well-bordered by @lazard10, Lemma 5.1.

If $\dim(C) = 2$ and $C$ is a $(1,1,0)$-cell, then its boundary consists of some section cells which project onto one-dimensional cells in $\mathcal{D}$ and which are contained in $\fr{C'}$ and points or intervals projecting on some $0$-cells in $\fr{C'}$ by Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2).
We need to prove that these points belong to the boundary of some of the $1$-cells contained in $\fr{C}$.
Let $\mathbf{c}$ be a $0$-cell of $\mathcal{D'}$ contained in $\fr{C'}$ such that $\mathbf{c}$ is the projection of exactly one point, $\mathbf{p}$, in $\fr{C}$.
Since $C'$ is well-bordered (as $\mathcal{D'}$ is strong), there is a $1$-dimensional cell $C'_1 \subset \fr{C'}$ such that $\mathbf{c}$ is an endpoint.
If $C'_1$ is the projection of a $1$-dimensional cell contained in $\fr{C}$, we are done -- the boundary of this one-dimensional cell consists of some isolated points including $\mathbf{p}$.
$C'_1$ is not the projection of a section cell, then the limits of the sequences of points in $C$, whose projections tend to $C'_1$, tend to $-\infty$ or $\infty$. Therefore $\mathbf{p}$ is either $-\infty$ or $\infty$, being an endpoint of the interval $I$ associated to $C$ by Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2). This contradicts the assumption that $\projop{2}^{-1}(\mathbf{c}) \cap \fr{C}$ contains only $\mathbf{p}$.

If $\dim(C) = 2$ and it is a sector ($(i_1,i_2,1)$-cell), then $\fr{C}$ consists of the two $(i_1,i_2,0)$-cells $C_B$ and $C_T$ which project on $C'$ the side-wall $W = \fr{C} \setminus (C_B \cup C_T)$ which consists of points or intervals projecting on the endpoints of $C'$.
If $W$ contains an isolated point above an endpoint $\mathbf{c}$ of $C'$. Then Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2) asserts that it belongs to the boundary of a section bounding $C$ from below or above (i.e., $C_B$ or $C_T$), and we are done.

Finally, suppose that $C$ is a $(1,1,1)$-cell.
By the proof of @lazard10, Theorem 4.4, we only need to consider points in $\fr{C}$ which projects on a bad cell, say $\mathbf{b}$, of $\mathcal{D'}$.
By @lazard10, Lemma 4.3 $\dim(\mathbf{b}) = 0$.
$C_B$ and $C_T$ are $(1,1,0)$-cells, therefore we only need to consider the blow-up subsets $B := (\fr{C} \setminus (\cl{C_B} \cup \cl{C_T})) \cap (\mathbf{b} \times \R)$. By Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2) $B$ is an open interval.
As $C'$ is well-bordered, there is a $1$-dimensional cell $C'_1 \subset \fr{C'}$ such that $\mathbf{b}$ is an endpoint.
The set of points of $\fr{C}$ which project onto $C'_1$ are bounded from below and above by points of $\fr{C_B}$ and $\fr{C_T}$, thus they are $1$-dimensional section cells. The boundaries of these section cells are included in $\fr{C_B}$ and $\fr{C_T}$.
Lemma \@ref(lem:lazard-5-2) (@lazard10, Proposition 5.2) implies that these sections which project onto $C'_1$ define a (finite and non empty) $2$-dimensional sector cell which projects onto $C'_1$ whose boundary
contains $B$.

As all cases have been considered, this completes the proof.
:::

::: {.proposition #ext-lazard-5-3 }
(Corollary to @lazard10, Theorem 5.3)

Let $\mathcal{D}$ be an $\mathbf{F}$-invariant CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$ of dimension $\le 2$ such that the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$ is strong about $\projop{n-1}(C)$. Then $C$ is well-bordered.
:::

::: {.proof}
If $\dim(C) \le 2$, then it is well-bordered by @lazard10, Lemma 5.1.
If $\dim(C) = 2$ and $C$ is a sector cell, the same argument as in Theorem \@ref(thm:lazard-5-3) (@lazard10, Theorem 5.3) can be applied.

Otherwise, $\dim(C) = 2$ and $C$ is a sector cell. $C' := \projop{n-1}(C)$ is a well-bordered, boundary smooth and boundary coherent $2$-dimensional cell in $\mathcal{D'}$. The same argument as in Theorem \@ref(thm:lazard-5-3) (@lazard10, Theorem 5.3) can be applied to the cells in $\cl{C'} \times \R$, which have dimension $\le 2$ or are sector cells of dimension $3$.
:::

::: {.lemma #ext-lazard-5-13 }
(Extension of Lemma \@ref(lem:lazard-5-13) [@lazard10, Proposition 5.13])

Let $\mathcal{D}$ be a sign-invarient decomposition of $\R^n$ and $C$ be a cell of $\mathcal{D}$ of dimension at most two, such that the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$ is strong about $\projop{n-1}(C)$. Let $D$ be a cell of $\mathcal{D}$ such that $B := D \cap \fr{ C } \neq \emptyset$ and $B \neq D$. Then either

  1. $C$ is a $1$-dimensional section cell whose endpoint, $B$, projects on a bad cell, or

  2. there exists a cell $E$ of $\mathcal{D}$ such that $\dim(E) < \dim(C)$ and $\emptyset \neq D \cap \fr{ E } \neq D$.
:::

::: {.proof}
By the proof of [@lazard10, Theorem 4.4], $D$ will always be a $(0,\ldots,0,1)$-cell in the cylinder above a bad cell $D'$.

We consider each case by cell index.

- $(i_1,\ldots,i_{n-1},1)$-cell, where $\sum_{j=1}^{n-1} i_j = 1$: observe that $C$ (if bounded) is delineated by some $(i_1,\ldots,i_{n-1},0)$-cells (one-dimensional curve intervals). Take $B$ to be the one-dimensional interval delineated by the endpoints of these curves. Since $B \neq C$, at least one of these endpoints is not a $(0,\ldots,0,0)$-cell of $\cal D$. Case 2 applies, taking as $E$ the delineating $(i_1,\ldots,i_{n-1},0)$-cell.

- $(i_1,\ldots,i_{n-1},0)$-cells, where $\sum_{j=1}^{n-1} i_j = 1$: consider the previous case, letting $C = E$.

- $(i_1,\ldots,i_{n-1},0)$-cell, where $\sum_{j=1}^{n-1} i_j = 2$:
$C$ is necessarily the root of a polynomial $f \in \Q[x_1,\ldots,x_n]$ which vanishes identically on $D'$, a $(0,\ldots,0)$ cell in the decomposition induced by $\cal D$ on $\R^{n-1}$.
Let $V_r$ be a small neighbourhood (with radius $r > 0$) centred around $D'$ and consider $V_r'$, the cylinder above the boundary of $V_r$. Since $C$ is a monotone cell, the maximum and minimum values of $x_n$ in this intersection are obtained on the boundary of $C$, for sufficiently small $r$. The limits, as $r$ tends to $0$, of this maximum and minimum clearly belong to the boundary of $B$, if these limits do not tend to infinity. Note that both the maximum and minimum cannot be infinite, since this would imply that either $B$ is empty, or coincides with $D$. Therefore, the non-infinite limits are the endpoints of some $1$-dimensional cell belonging to the boundary of $C$. Case 2 applies, taking $E$ to be this $1$-dimensional cell.

- $(0,\ldots,0,1)$- or $(0,\ldots,0,0)$-cells: do not satisfy the hypothesis, there is nothing to do.
:::

::: {.remark}
Let $C$ be a $(i_1,\ldots,i_{n-1},0)$-cell as described in Lemma \@ref(lem:ext-lazard-5-13) such that $i_1=i_k = 1$ for some $1 \le k \le n$ and all other elements of the index are equal to zero.
The cell $D$, which projects on a bad-cell is necessarily a $(0,\ldots,0,1)$-cell and the cell $E$, which has dimension one, is contained in $\cl{C}$. Hence, $E$ must have index either $(i_1,0\ldots,0)$ or $(0,\ldots,0,i_k,0,\ldots,0)$.
By Proposition \@ref(prp:delete-zero-index) (@bgv15, Lemma 3.3), the images of $C$, $D$ and $E$ under the projection map $\projops{i_1,i_k,i_n}$ are cylindrical cells and satisfy Lemma \@ref(lem:lazard-5-13) (@lazard10, Lemma 5.13).
:::

::: {.conjecture #ext-lazard-5-14}
(Extension of @lazard10, Proposition 5.14)

Let $f \in \Q[x_1,\ldots,x_n]$ be an irreducible polynomial of the kind
$$f = h_dx_n^d + \ldots + h_1x_n + h_0$$
with each $h_i \in \Q[x_1,\ldots,x_{n-1}]$, and
$$\mathbf{p} = (p_1,\ldots,p_{n-1})$$
be a common root of $h_d,\ldots,h_1,h_0$.
Let $g_1,\ldots,g_{n-2}\in \Q[x_1,\ldots,x_{n-1}]$ be irreducible, pairwise relatively prime polynomials having $\mathbf{p}$ as a root.
Then the limits of the common roots of $f$ and $g_{i_1},\ldots,g_{i_{n-2}}$ for $\{i_1,\ldots,i_{n-2}\} = \{1,\ldots,n-1\} \setminus \ell, 1 \le \ell \le n-1$ as $(x_1, \ldots,x_{n-1}) \to \mathbf{p}, (x_1, \ldots, x_{n-1}) \ne \mathbf{p}$ may be computed as the solutions of a system of polynomial equations having dimension zero.
:::

::: {.proof}
Since $f$ is irreducible, it has at least $2$ coefficients, $h_1,h_2 \in \Q[x_1,\ldots,x_{n-1}]$, whose GCD is a constant.
Therefore, any ideal generated by these coefficients has codimension at least two and, since polynomials $g_1,\ldots,g_{n-1}$ are irreducible and pairwise relatively prime, the ideal generated by the coefficients of $f$ and the polynomials, $g_{i_1},\ldots,g_{i_{n-2}}$ has dimension zero.
Any ideal containing these polynomials also contains another element, $g_\ell$, which is not a multiple of any of the $g_{i_1},\ldots,g_{i_{n-2}}$'s.

The saturation by $g_\ell$ of the ideal $\langle f, g_{i_1}, \ldots, g_{i_{n-2}} \rangle$ is defined as the ideal
$$
S := \langle f, g_{i_1}, \ldots, g_{i_{n-2}}, 1 - z g_\ell \rangle \cap \Q[x_1,\ldots,x_n].
$$
The irreducible components of the zero set of $S$ are those of the zero set of $\langle f,g_{i_1},\ldots,i_{n-2} \rangle$ at which $g_\ell$ is not identically zero. It follows that the vertical line $\{ x_1 = p_1, \ldots, x_{n-1} = p_{n-1} \}$ which is part of the zero set of $f$,
$g_{i_1},\ldots,g_{i_{n-2}}$ and $g_\ell$, is not contained in the zero set of $S$.
Meanwhile, the zero set of $S$ contains the limit points we are interested in finding.

Therefore, the ideal generated by $S$, the coefficients $h_0,\ldots,h_d$ of $f$ and the polynomials $g_{i_1},\ldots,g_{i_{n-2}}$ is zero-dimensional and the limits of $\{ f = 0, g_{i_1} = 0, \ldots, g_{i_{n-n}} = 0 \}$ as $(x_1,\ldots,x_{n-1}) \to \mathbf{p}$ can be computed as the solutions of $S$.
:::

::: {.algorithm data-latex="Extension of Lazard's Lifting With Bad Points, for $2$-dimensional cells in $\R^n$"}
[Extension of @lazard10, Algorithm 5.15]

**Input:**
$$({\cal D}, {\cal A})$$

  - $\cal D$: a CAD of $\R^k$, each cell having constant sign on $\mathcal{A}$, A collection of cells $\mathcal{C} := \{ C_1,\ldots,C_m \}$ of $\mathcal{D}$ are marked as being projections of $V_1,\ldots,V_k$.

  - ${\cal A} = {\cal A}_1,\ldots,{\cal A}_k$ is the family of projection polynomials for $\mathcal{D}$, each ${\cal A}_k \subset \Z[x_1,\ldots,x_k]$.

**Output:**

$$
{\cal R} := \{ {\cal R}_{\mathbf{b}} = ( c_1,\ldots,c_t ) \subset \A \mid \mathbf{b} \in \R^{k-1} \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \R^k \}
$$

A set of refinement points, as described in Section \@ref(sec:monotone-algorithm).

- Let $\cal D'$ be the decomposition induced by $\cal D$ on $\R^{n-1}$.

- For each $(i_1,\ldots,i_{k-1},0)$-cell $E \in \cal{C}$, let $i_{\ell_1} = i_{\ell_2} = 1$, while all other elements in the index are equal to zero.

  - Let $\mathbf{c} := \projop{j_{\ell_1} - 1}(E)$ and compute the set of polynomials for the sub-cad of $\mathcal{D}$ above $\mathbf{c}$.

    I.e., Let $C := \projops{i_\ell,\ldots,i_k}(E)$ be an $(i_{\ell_1},\ldots,i_{k-1},0)$-cell in the sub-cad of $\mathcal{D}$ above $\mathbf{c}$. Compute the substitution of polynomials
    $$
    \mathcal{A'}_{j} := \{ {\mathrm{sub}}_{\mathbf{c}} (f) \in \Z[x_{\ell_1},\ldots,x_j] \mid f \in \mathcal{A}_{i_{\ell_1} - 1 + j} \}
    $$
    for $i_{\ell_1} \le j \le k$.

  - Find, by examining signs of projection polynomials associated to $C$, polynomials
    $$
    (g_{j_1},\ldots,g_{k-3}, f), g_j \in \mathcal{A'}_j, j \in \{\ell_1 + 1,\ldots,k-1\} \setminus \{ \ell_2 \}, f \in \mathcal{A'}_k
    $$
    such that $C \subset \{ \mathbf{x} \in \R^{k-\ell_1 + 1} \mid (g_{j_1}(\mathbf{x}) = 0,\ldots,g_{k-3}(\mathbf{x}) = 0, f(\mathbf{x}) = 0 \}$.

  - Determine whether any point on the frontier of $C$ projects on a bad cell. I.e., check if there is a $(0,\ldots,0,1)$-cell $D$, by examining signs of projection  polynomials, such that $f(\mathbf{x}) = 0$ for all $\mathbf{x} \in D$.

    I.e., all of $g_{j_1},\ldots,g_{j_{k-3}},f$ should be equal to zero on $D$.

  - For each $D$ projecting on a bad cell, let $\mathbf{b} := \projop{k-1}(D)$.

    Since $\mathbf{b}$ is a $(0,\ldots,0)$-cell, polynomials $g_{j_1},\ldots,g_{j_{k-3}}$ are equal to zero on $\mathbf{b}$ and there are two more polynomials $g_{\ell_1} \in \mathcal{A'}_{\ell_1}, g_{\ell_2} \in \mathcal{A'}_{\ell_2}$ which are equal to zero on $\mathbf{b}$.

    - Compute saturations $$
    I_1 := \langle f, g_{j_1}, \ldots, g_{j_{k-3}}, g_{\ell_2}, 1 - z g_{\ell_1} \rangle \cap \Z[x_1,\ldots,x_k]
    $$
    and
    $$
    I_2 := \langle f, g_{j_1}, \ldots, g_{j_{k-3}}, g_{\ell_1}, 1 - z g_{\ell_2} \rangle \cap \Z[x_1,\ldots,x_k],
    $$
    where $z$ is a new variable.

    - Compute generator systems $S_1, S_2$ for $I_1,I_2$ respectively.

      This may be done by computing a Groebner basis eliminating $z$.

    - Finally, to obtain  refinement polynomials for $D$, substitute
    $$
    L := \{ {\mathrm{sub}}_{\mathbf{b}}(f) \in \Q[x_k] \mid f \in S_1 \cup S_2 \}.
    $$

    - Refinement points are the roots
    $$
    (c_1,\ldots,c_t)
    $$
    of polynomials in $L$.

    - Let
    $$
    {\cal R} := {\cal R} \cup \{ {\cal R}_{\mathbf{b}} = (c_1,\ldots,c_t) \}.
    $$

- return $\cal R$.
:::

::: {.example #sphere}
Let $n = 3$ and consider the unit sphere
$$
S := \{ (x,y,z) \in \R^3 \mid x^2 + y^2 + z^2 - 1 = 0 \}.
$$
:::

::: {.example #qanm}
Let $n = 3$ and consider the 2-dimensional section cell
$$
C := \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y > 0, x + y^2 < 1, z = x^2 + y^2 \}.
$$
:::

::: {.example #fr-3-whitney-jhd }
[@jhd20, Example 2.1]

Let $n = 3$ and consider the $(1,1,0)$-cell
$$
C = \{ (x,y,z) \in \R^3 \mid 0 < x < 1, -x < y < x, y^2 - x^2 z = 0 \}.
$$
:::

::: {.example #top-bottom-not-cylindrical}
[@bgv15, Example 3.2]
Let
$$
C' = \{ (x,y) \in \R^2 \mid -1 < x < 1, \vert x\vert < y < 1 \}
$$
be a cylindrical sector cell in $\R^2$ and $C$ be the graph of $\varphi\vert_{C'}$, where
$$
\varphi(x,y) = \vert x/y\vert.
$$
$C$ is a cylindrical section cell in $\R^3$, according to Definition \@ref(def:cells), despite the fact that $\varphi\vert_{C'}$ is not analytic.
Consider the bottom of $C$
$$C_B = \{ (x,y,z) \in \R^3 \mid -1 < x < 1, x \ne 0, y = \vert x\vert, z = 1 \} \cup \{(0,0,z) \mid 0\le z \le 1\}.$$
Due to the blow-up of $\varphi$ at the origin, $C_B$ is not a cylindrical cell.
Note that $C_B$ does not contain all points at which $\varphi$ vanishes.
:::

::: {.theorem #main}
Let $S \subset \R^n$ be a semialgebraic set defined by a QFF $F$ with $s$ different polynomials of maximum degree $d$ in $\R[x_1,\ldots,x_n]$.
There is an algorithm, taking $F$ as input, which outputs a cylindrical decomposition $\mathcal D$ of $\R^n$ compatible with $S$ and
satisfying the frontier condition.
The complexity of this algorithm is $(sd)^{O(1)^{n2^n}}$.
This is also an upper bound on the number of cells in $\mathcal D$, number of polynomials defining cells and their degrees.
:::

::: {.remark}
The algorithm from Theorem \@ref(thm:main) is understood as a Blum-Shub-Smale (BSS) real numbers machine [@blum1998].
A similar statement is also true for the Turing machine model, in which case the complexity bound
depends, in addition, polynomially on maximal bit-size of coefficients (cf. @collins1975).
:::

::: {.theorem #proj}
Let $\mathcal{D}$ be a CAD of $\R^n$ compatible with a semialgebraic set $S\subset \R^n$ and satisfying the frontier condition.
Then the decomposition induced by $\mathcal{D}$ on $\R^{k}$ for all $1\le k < n$ is a cylindrical decomposition of $\R^k$ compatible with $\proj_{\R^k}(S)$ and satisfying the frontier condition.
:::

::: {.lemma #frontier}
Let $S \subset \R^n$ be a semialgebraic set defined by a QFF $F$
containing $s$ different polynomials in $\R [x_1, \ldots ,x_n]$ having maximum degree $d$.
There is an algorithm, taking $F$ as input, which represents the semialgebraic set $\fr{S}$ by a QFF $F'$ with complexity $(sd)^{O(n^2)}$.
This is also an upper bound on the number of polynomials in $F'$ and their degrees.
:::

::: {.proof}
Observe that $\fr{S}$ can be represented by a first-order Boolean formula
\begin{equation}
(\#eq:frontier-first-order)
\fr{S} = \left\{ \mathbf{x} \in (\R^n \setminus S) \mid \forall \varepsilon >0\> \exists \mathbf{y} \in S\> (\Vert \mathbf{x} - \mathbf{y} \Vert < \varepsilon ) \right\}.
\end{equation}
Using singly-exponential quantifier elimination algorithm [@bpr2006, Algorithm 14.21], we represent $\fr{S}$
as a QFF $F'$ with the bounds required in the lemma.
:::

::: {.lemma #fr-lex-less}
Let $\mathcal{D}$ be a CAD of $\R^n$ and let $C$ be a cell of $\mathcal{D}$ with index $M$.
Then $\fr{C}$ is contained in a union of cells of $\mathcal{D}$ with indices lexicographically less than $M$.
:::

::: {.proof}
Proceed by induction on $n$.

When $n=1$, the cell $C$ either has index $M=(0)$ or $M=(1)$.
If $M=(0)$ then $C$ is a single point and its frontier is empty.
If $M=(1)$, $C$ is an open interval. By the definition of CAD, endpoints of $C$ are $(0)$-cells.

Now let $n>1$ and let $C$ have index $M=(i_1,\ldots,i_n)$.
The projection $C'=\proj_{\R^{n-1}}(C)$ is a cell in the induced decomposition $\mathcal{D'}$ of $\R^{n-1}$
with index $(i_1,\ldots,i_{n-1})$.
By the induction hypothesis, $\fr{C'}$ is contained in a union of cells of $\mathcal{D'}$ with indices
$(j_1,\ldots,j_{n-1}) \lex (i_1,\ldots,i_{n-1})$. I.e., by definition we have
\begin{equation}
i_1=j_1,\ldots,i_{k-1} = j_{k-1} \text{ and } i_k < j_k \text{ for some } 1 \le k \le n - 1.
(\#eq:fr-lex-less-hyp)
\end{equation}

If $i_n=0$, then $C$ is a section cell.
Its frontier $\fr{C}$ is contained in $\fr{C'} \times \R$ and, therefore, in a union of
cells of $\mathcal D$ with indices $(j_1,\ldots,j_{n-1}, j_n)$ for some $j_n \in \{ 0,1 \}$.
Since the property in Equation \@ref(eq:fr-lex-less-hyp) still holds, we have shown that $(j_1,\ldots,j_{n-1}, j_n) \lex M$.

If $i_n=1$, then $C$ is a sector cell.
In this case, $\fr{C}$ is contained in $(\fr{C'} \times \R) \cup C_T \cup C_B$, hence in the
union of cells of $\mathcal D$ with indices $(j_1,\ldots,j_{n-1}, j_n)$ for some $j_n \in \{0,1\}$,
and two cells, $C_T$ and $C_B$, having the same index $(i_1,\ldots,i_{n-1},0) \lex (i_1,\ldots,i_{n-1},1)$.
All of these indices are lexicographically less than $M$.
:::

::: {.lemma #section-split}
Let $f: X \to \R$ be a continuous definable function on a set
$X \subset \R^n$ having the graph $F \subset \R^{n+1}$, such that $F$ is a semialgebraic set.
Let $G$ be a semialgebraic subset, closed in $F$, of dimension less than $\dim (F)=n$.
Then $\frt_{F}(F \setminus G) = G$, where $\frt_F$ denotes the frontier in $F$.
:::

::: {.proof}
Let $Y = \proj_{\R^{n}}(G)$ and observe that $X = \proj_{\R^{n}}(F)$ and, since semialgebraic sets are closed under projection, observe that both $X$ and $Y$ are semialgebraic.
We will prove that $\frt_X(X \setminus Y) = Y$.
By the definition of frontier, we have
$$\frt_X(X \setminus Y)=\cls_X(X \setminus Y) \setminus (X \setminus Y),$$
where $\cls_X$ denotes the closure in $X$.

We need to prove that $\cls_X(X \setminus Y) = X$.
Since $Y$ is a semialgebraic set, it is the union of some basic semialgebraic sets
\begin{equation}
S_i = \{ \mathbf{x} \in \R^n \mid f_1(\mathbf{x}) = 0, \ldots, f_k(\mathbf{x}) = 0, g_1(\mathbf{x}) > 0, \ldots, g_\ell(\mathbf{x}) > 0 \}
(\#eq:basic-semialgebraic)
\end{equation}
of dimension $< n$.
Each $S_i$ is contained in a hypersurface $V_i = V(f_{i})$, where $f_i$ is one of the polynomial equations defining $S_i$ in Equation \@ref(eq:basic-semialgebraic).
Let $Z = \bigcup_i V_i = \bigcup_i V(f_{i}) = V(\prod f_i)$ be a closed set which contains $Y$.
We may replace $Y$ with $Z$, and prove that
$$
\cls_X(X \setminus Z) = X \supset Z \cap X
$$
because $(X \setminus Z) \subset (X \setminus Y)$ implies $\cls_X(X \setminus Z) \subset \cls_X(X \setminus Y)$.

When considering $\cls_X$, we view $X$ as a topological space and consider only the points of $Z$ which are contained in $X$.

We prove that
$$
Z \cap \cls_X(X \setminus Z) \supset Z \cap X
$$
and claim that every $\mathbf{x} \in X \cap Z$ is a point of $\cls_X(X \setminus Z)$.
I.e., since we view $X$ as a topological space, even if $X$ is not an open set, by the definition of closure, there is a small real number $r > 0$ such that the open ball $B(\mathbf{x},r)$ is contained in $X \setminus Z$.
Assume for contradiction that this is false. Then $B(\mathbf{x}, r) \cap (X \setminus Z) = \emptyset$.
It follows that $B(\mathbf{x},r)$ must be contained in $Z$, but this is impossible because a set of dimension $< n$ cannot contain an $n$-dimensional open ball.

Finally, since $f$ is a continuous function, and therefore $Y$ and $X$ are homeomorphic to $G$ and $F$
respectively, we obtain the required formula $\frt_{F}(F \setminus G) = G$.
:::

::: {.proof}
(of Theorem \@ref(thm:proj))

Let $\mathcal{D}$ be the cylindrical decomposition of $\R^n$ which satisfies the frontier condition and let $\mathcal{D}'$ be the decomposition induced by $\mathcal{D}$ on $\R^{n-1}$.
Let $C'$ be a cell of $\mathcal{D}'$. We claim that $C'$ satisfies the frontier condition and prove that $\cl{C'}$ is a union of cells of $\mathcal{D'}$.
Consider the cylinder $C' \times \R$.
$\cl{C' \times \R}$ can be written as a first-order Boolean formula
\begin{equation}
(\mathbf{x'},x_n) \in \R^n \mid \forall \varepsilon > 0\> \exists (\mathbf{y'},y_n) \in C' \times \R \> (\Vert (\mathbf{x'},x_n) - (\mathbf{y'},y_n) \Vert < \varepsilon ).
(\#eq:closure-quantifiers)
\end{equation}
Since $C' \times \R$ is a union of cells of $\mathcal{D}$ and $\mathcal{D}$ satisfies the frontier condition,
it follows that every point $(\mathbf{x'},x_n) \in \cl{C' \times \R}$ belongs to $\cl{C}$ for some cell $C$ of $\mathcal{D}$ in $C' \times \R$. Hence, $\cl{C' \times \R}$ is a union of cells of $\mathcal{D}$.

It is clear that, if $(\mathbf{x'}, x_n) \in \cl{C' \times \R}$, then $\proj_{\R^{n-1}}((\mathbf{x'}, x_n)) = \mathbf{x'} \in \proj_{\R^{n-1}}(\cl{C' \times \R})$. Hence $\proj_{\R^{n-1}}(\cl{C' \times \R}) = \cl{C'}$ and, by the cylindrical property, since $\cl{C' \times \R}$ is a union of cells of $\mathcal{D}$, $\cl{C'}$ is a union of cells of $\mathcal{D'}$.

The proof is completed, for decompositions induced by $\mathcal{D}$ on $\R^k, 1 \le k \le n-1$, by iterating this argument for successive projections.
:::

::: {.algorithm #algorithm-main data-latex="CadFC"}
$$
{\mathcal D} := \mathrm{CadFC}(F)
$$

**Input:**
$F$: a QFF representing a semialgebraic set $S \subset \R^n$.

**Output:**
A CAD $\mathcal D$ of $\R^n$ compatible with $S$ and satisfying the frontier condition.

**Complexity:**
$$(sd)^{O(1)^{n2^n}}$$
where $F$ contains $s$ different polynomials of maximum degree $d$ in $\Z[x_1,\ldots,x_n]$.

- Initialise $M = (i_1,\ldots,i_{n-1}) := (1,\ldots,1) \in \{0,1\}^{n-1}$.

- Let $\mathcal{E}_M :=  \bf{true} \ \&\ \{ F \}$, where $\bf{true}$ is the trivial CAD of $\R^n$, be the initial CAD.

- Define the initial pair
$({\mathcal E}_M, \mathcal{F}_M):=({\mathcal E}, \emptyset)$.

  $\mathcal{E}_M$ is a refinement of $\mathcal{E}$ and $\mathcal{F}_M$ is a set of QFFs, each defining a semialgebraic set contained in a union of cells of $\mathcal{E}_M$ with index $\lexeq (i_1,\ldots,i_{n-1},1)$.

- While $(0,\ldots,0) \lex M$, do


  - Let $N := {\rm Decrement} (M)$.

  - Compute $\mathcal{E}_N := \mathcal{E}_M\ \&\ {\mathcal F}_M$.

  - Let $\mathcal{A}_0$ be the family of QFFs defining all cells of $\mathcal{E}_N$ with index $(i_1,\ldots,i_{n-1},0)$

  - and $\mathcal{A}_1$ be the family of QFFs defining all cells of $\mathcal{E}_N$ with index $(i_1,\ldots,i_{n-1},1)$.

  - Compute the set of frontiers
\begin{align*}
{\mathcal F}_{N,0} =\ & \left\{ \fr{F_0} \mid F_0 \in \mathcal{A}_0 \right\}, \\
{\mathcal F}_{N,1} =\ & \left\{ \fr{F_1 \land \neg( F_{1,B} \lor F_{1,T} )} \mid F_1 \in \mathcal{A}_1, F_{1,B}, F_{1,T} \in \mathcal{A}_0 \right\}, \\
{\mathcal F}_N =\ & {\mathcal F}_{N,0} \cup {\mathcal F}_{N,1}, \\
\end{align*}
where $F_{1,B}$ (resp. $F_{1,T}$) is a QFF defining the bottom (resp. top) of the sector cell defined by $F_1$, or $\mathbf{false}$ if the bottom (resp. top) does not exist.

  - Let $M := N$.

- Return ${\mathcal E}_{(0,\ldots,0)}$.
:::

::: {.proof}
(of Theorem \@ref(thm:main))

Let $L=(k_1, \ldots ,k_{n-1})$ be the index immediately prior to $N=(j_1, \ldots ,j_{n-1} )$ with respect to $\lex$.
The algorithm computes ${\mathcal E}_L$ as the refinement of ${\mathcal E}_N$ compatible with each set represented by a formula in $\mathcal{F}_N$. This is the set $X_N$ defined in Equation \@ref(eq:front).
Suppose that the algorithm has computed the final decomposition $\mathcal{D}$, as the refinement of $\mathcal{E}_{\mathbf{0}}$ compatible with $\mathcal{F}_{\mathbf{0}}$ in the sequence \ref{eq:sequence}. Now construct a new sequence of decompositions (from left to right)
\begin{equation}
\mathcal{E}'_{\mathbf{0}} \lex \cdots \lex \mathcal{E}'_L \lex \mathcal{E}'_N \lex \mathcal{E}'_M \lex \cdots \lex \mathcal{E}'_{(1,\ldots,1)}
(\#eq:seq-ind-hyp)
\end{equation}
where the initial element $\mathcal{E}'_{\mathbf{0}}$ is the refinement of $\mathcal{E}_{\mathbf{0}}$ compatible with each cell of $\mathcal{D}$ and each $\mathcal{E}'_I$ is the refinement of $\mathcal{E}_I$ compatible with all cells of $\mathcal{E}'_J$, where $J$ is the index immediately prior to $I$ with respect to $\lex$.
We want to prove that every cell in $\mathcal{E}'_L$ with index $\lexeq (i_1,\ldots,i_{n-1},1)$ satisfies the frontier condition.

If $C$ is a cell in ${\mathcal E}_N$ with index $(i_1, \ldots ,i_{n-1},0)$ (section cell),
then $C$ is a union of cells of ${\mathcal E}_L$ and, hence, of $\mathcal{E}'_L$, with indices $\lexeq (i_1, \ldots ,i_{n-1} ,0)$.
Let $C' \subset C$ be one of the cells in this refinement of $C$ with index $(i_1, \ldots ,i_{n-1} ,0)$ and $B$ be
the union of cells contained in the refinement of $C$ with indices $\lex (i_1, \ldots ,i_{n-1} ,0)$.
Let $B' \subset B$ be a cell of ${\mathcal E}_L$ with index $(m_1,\ldots,m_{n-1},0) \lex (i_1,\ldots,i_{n-1},0)$. We claim that $\dim(B') < \dim(C)$.
Indeed, on the one hand, if $i_k = 0$, for some $1\le k \le n-1$, then $m_k = 0$ as well. Otherwise, $\proj_{\R^k}(C)$ is a section cell which must contain $\proj_{\R^k}(B')$, which is a sector cell, but this is impossible.
On the other hand, by the definition of $\lex$, there exists some $1\le \ell \le n-1$ such that $m_1 = i_1, \ldots, m_{\ell-1} = i_{\ell-1}$ and $m_\ell = 0, i_\ell = 1$. This implies that $\dim(B') = m_1 + \cdots + m_{n-1} < i_1 + \cdots + m_{n-1} = \dim(C)$ as required. It follows that $\dim(B) < \dim(C)$ and $B$ is closed in $C$.
According to Lemma \@ref(lem:section-split), $\frt_C (C \setminus B)=B$ where $\frt_X(Y)$ denotes the frontier of $Y$ in $X$.
Hence, $\frt_C (C') \subset B$.
On the other hand, $\fr{C'} \setminus \frt_C (C')$ is a subset of $\fr{C}$, which is a union of cells of $\mathcal{E}_L$ (and of the refinement $\mathcal{E}'_L$) with index $\lex (i_1,\ldots,i_{n-1},0)$.

By the induction hypothesis, all cells of $\mathcal{E}'_L$ with index $\lex (i_1,\ldots,i_{n-1},0)$ satisfy the frontier condition. In particular, $\fr{C}$ and $\fr{B}\subset \fr{C}$ is a union of cells of $\mathcal{E}'_L$.
It follows from the cylindrical structure of $\mathcal{E}'_L$ that $C'$ satisfies the frontier condition.

If $C$ is a cell in ${\mathcal E}_N$ with index $(i_1, \ldots ,i_{n-1} ,1)$ (sector cell),
then $C$ is a union of cells of ${\mathcal E}_L$ with indices $\lexeq (i_1, \ldots ,i_{n-1} ,1)$.
A similar argument to that used for section cells shows that each cell $C'$ in this union,
having index $(i_1, \ldots ,i_{n-1} ,1)$, satisfies the frontier condition in $\mathcal{E}'_L$. Note that when using
Lemma \@ref(lem:section-split) we consider sector cell $C$ as a graph of a constant function over itself.

Finally, each decomposition $\mathcal{E}'_I$, $I \in \{0,1\}^{n-1}$, in the sequence \ref{eq:seq-ind-hyp} coincides with $\mathcal{D}$. Indeed, $\mathcal{D}$ is a refinement of $\mathcal{E}_I$ and $\mathcal{E}'_I$ is a refinement of $\mathcal{E}_I$ compatible with all cells of $\mathcal{D}$. In other words, no refinement of $\mathcal{D}$ is required to obtain $\mathcal{E}'_{(1,\ldots,1)}$.
It follows that every cell of $\mathcal{D}$ satisfies the frontier condition.
:::

::: {.example #qanm-3-alg }
Let $n = 3$ and consider the 2-dimensional section cell
$$
C := \{ (x,y,z) \in \R^3 \mid 0 < x < 1, y > 0, y - x^2 + 2x < 1, z = x^2 + y^2 \}.
$$
:::

::: {.example #qanm-4-rat }
Let $n = 4$ and consider the semialgebraic set defined by the QFF
$$
F := ( ( 4 w = 7 \lor w^2 = 36 ) \land x > 0 \land x < 1 \land y > 0 \land x + y < 1 \land z = w x^2 + y^2 ).
$$
It has three connected components, $C_1$, $C_2$ and $C_3$, each of which is a cylindrical section cell in a sub-CAD of $\R^3$ above a $0$-dimensional cell ($\mathbf{b}_1$, $\mathbf{b}_2$, $\mathbf{b}_3$ respectively). 
\begin{align}
\mathbf{b}_1 &= 7/4, &C_1 = \{ (x,y,z) \in \R^3 \mid x > 0 ,x < 1 ,y > 0 ,x + y < 1 ,z = 7/4 x^2 + y^2 \}.\\
\mathbf{b}_2 &= -6, &C_3 = \{ (x,y,z) \in \R^3 \mid x > 0 ,x < 1 ,y > 0 ,x + y < 1 ,z = -6 x^2 + y^2 \}.\\
\mathbf{b}_3 &= 6, &C_3 = \{ (x,y,z) \in \R^3 \mid x > 0 ,x < 1 ,y > 0 ,x + y < 1 ,z = 6 x^2 + y^2 \}.
\end{align}

$C_2$ is already monotone. This can be seen by examining the projections of its top and bottom onto $\opspan{x,z}$: 
\begin{align}
C_{2,B} &= \{ -1 < x < 1, z = -6x^2 \},\\
C_{2,T} &= \{ -1 < x < 1, z = -5x - 2x + 1 \}.
\end{align}

$C_1$ and $C_3$ are of the same kind as the cell presented in Example \@ref(exm:qanm) and require refinement. 
:::

::: {.example #qanm-4-above-alg }
Let $n = 4$ and consider the section cell
$$
C := \{ (w,x,y,z) \in \R^4 \mid w > 0, w^2 = 2, 0 < x < 1, y > 0, x + y < 1, z = 3x^2 + 2y^2 \}.
$$
:::

::: {.example #qanm-4-alg }
Let $n = 4$ and consider the section cell
$$
C := \{ (w,x,y,z) \in \R^4 \mid w > 0, w^2 = 3, 0 < x < 1, y > 0, y < (x-1)^2, z = 3x^2 + 2y^2 \}.
$$
:::

::: {.example #qanm-4-multi }
Let $n = 4$ and consider the section cell
$$
C := \{ (w,x,y,z) \in \R^4 \mid  0 < w < 1, x > 0, w + x < 1, y = w^2 + x^2, z = 2 w^2 + x^2 \}.
$$
:::

::: {.example #qanm-5-101 }
Let $n = 5$ and consider the $(1,0,1,0,0)$-cell
$$
C = \{ (w,x,y,z) \in \R^4 \mid 0 < w < 1, x = 1 - w, y > 0, w + y < 1, z = w^2 + x y^2, t = 3 w^2 + x^2 y^2 \}.
$$
:::

::: {.example #fr-4-whitney-multi }
Let $n = 4$ and consider the semialgebraic set defined by the QFF, containing polynomials in $Z[t,x,y,z]$,
$$
F = \{ (t = 0 \lor t = 2) \land 0 < x < 1 \land -x < y < x \land y^2 - x^2 (z - t) = 0 \}.
$$
:::

::: {.example #fr-4-whitney-alg }
Let $n = 4$ and consider the twe $2$-diemnsional subsets of the Whitney whitney umbrella defined by the QFF
$$
F = \{ (t,x,y,z) \in \R^4 \mid t^2 = 0 \land 0 < x < 1 \land -x < y < x \land y^2 - x^2 (z - t) = 0 \}.
$$
:::

::: {.definition #graph-def-map }
Let $X \subset \R^n$ and $Y \subset \R^m$ be definable sets. 
Let $f : X \to Y$ be a mapping from $X$ to $Y$. The graph of $f$ is the definable set
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}.
$$
Sometimes, the domain of $f$ is $\R^n$. In this case, we often use the restriction $f\vert_X$ so that only images of $f$ at points in $X$ are considered,
The graph of $f$ on $X$ may be denoted by $f(X)$. 
:::

::: {.definition #definable-set}
A structure expanding the real closed field $R$ is a collection $$
S := (S^n)_{n \in \N}
$$
where each $S^n$ is a set of subsets of the affine space $R^n$ satisfying the following conditions.

1. All algebraic subsets of $R^n$ are in $S^n$.
2. $S^n$ is a Boolean subalgebra of the powerset of $R^n$.
3. If $A \in S^n$ and $B \in S^m$, then $A \times B \in S^{n+m}$.
4. Let $\proj : R^{n+1} \to R^n$ be the projection onto the first $n$ coordinates. If $X\in R^{n+1}$, then $\proj(X) \in R^n$.

Elements of $S^n$ (satisfying properties 1-4) are called the definable subsets of $R^n$.
If the structure $S$ satisfies properties 1-4 and the following property, it is called an O-minimal structure.


5. The elements of $S^1$ consist of the finite unions of points and open intervals of $R$.


:::

::: {.definition #definable-function}
A map $f : A \to R^m$, where $A \subset R^n$, is called *definable* if its graph $G \subset R^{n+m}$ is a definable set.
:::

::: {.definition #pfaff-format}
[@gv04, Definition 2.11]

Consider a semi-Pfaffian set
$$
X := \bigcup_{1 \le i \le M} \{ \mathbf{x} \in \R^s \mid f_{i,1} = 0, \ldots, f_{i,I_i} = 0, g_{i,1} > 0, \ldots, g_{i,J_i} > 0 \} \subset G
$$
where $f_{ij}$ and $g_{ij}$ are Pfaffian functions of order $r$ and degree $(\alpha, \beta)$ defined in an open domain $G$
The format of $X$ is a tuple
$$
(r, N, \alpha, \beta, s)
$$
where $N \ge (I_1 + J_1) + \cdots + (I_M + J_M)$.
:::

::: {.definition #big-o }
[@gv2009, Definition 6.1]
Let $f,g,h : \N^\ell \to \N$ be functions and $n \in \N$.

- The expression $f \le O(g)^n$ means that there exists $c \in \N$ such that $f < (cg)^n$ at every point in $\N^\ell$.
- The expression $f \le g^{O(h)}$ means that there exists a $c \in \N$ such that $f \le g^{ch}$ at every point in $\N^\ell$.
:::

::: {.definition #blow-up-point }
[@bgv15, Definition 9.2]

Let $\varphi : W \to \R$ be a continuous function on a semialgebraic set $W \subset \R^n$, and let $\Phi \subset \R^{n+1}$ be its graph.

A point $\mathbf{x} \in \overline{W} \setminus W$ is called a blow-up point of $\Phi$ if $$\proj^{-1}_{\R^n} (\mathbf{x}) \cap \overline{\Phi}$$ contains an open interval.
:::

::: {.definition #frontier-condition}
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cell of $\cal D$. $C$ satisfies the frontier condition in $\cal D$ is $\fr{C}$ is a union of cells of $\cal D$ of smaller dimension. If it is unambiguous that $C$ is a cell of $\cal D$, then we just say that $C$ satisfies the frontier condition.
If every cell in $\cal D$ satisfies the frontier condition, then the cylindrical decomposition $\cal D$ satisfies the frontier condition.
:::

::: {.definition #analytic-submanifold}
$S \subset \R^n$ such that $\dim(S) = k$ is an analytic submanifold if, for every point $\mathbf{x} \in S$, there is an analytic coordinate system about $\mathbf{x}$ with respect to which $S$ is locally the intersection of $n-k$ coordinate hyperplanes.
:::

::: {.definition #pdo }
[@gv1995, Definition 2]
Let $f \in \Z[x_1,\ldots,x_n]$ be a polynomial and let $(m_1,\ldots,m_n) \subset \Z_{\ge 0}^n$ be a multi-index associated to one of its partial derivatives.
I.e., we write
$$
\partial f^{(m_1,\ldots,m_n)} =
\dfrac{\partial^{m_1} f}{\partial x_1} \cdots \dfrac{\partial^{m_n} f}{\partial x_n}.
$$
:::

::: {.definition #sub-cad}
Let $\cal D$ be a CAD of $\R^n$ and suppose that $\mathbf{c} = (c_1,\ldots,c_k)$ is a $0$-dimensional section cell in the decomposition induced by $\cal D$ on $\R^k$.
By [@bgv15 Remark 3.8], the set of all cells of $\cal D$ contained in the affine coordinate subspace
$$
\{ x_1=c_1,\dots,x_k=c_k \}
$$
forms a cylindrical decomposition of $\R^{n-k}$. This decomposition will be called the *sub-decomposition* of $\cal D$ above $c$, and $\mathbf{c}$ the *base cell* of the sub-decomposition (or sub-CAD).
:::

::: {.definition #norm}
Let $K$ be a field and $L$ a finite (algebraic) extension of $K$.
The field $L$ can be thought of as a finite dimensional vector space over $K$.

Consider $f$ and $m$ be polynomials in $L[x_1,\ldots,x_n]$, viewed as polynomials in $K[x_1,\ldots,x_n,x_\alpha]$.
The norm, in $L[x_1,\ldots,x_n]$ of $f$ can be found by computing the resultant of $f$ and $m$.
:::

::: {.definition #laz-properties }
[@lazard10, Definition 2.7]

1. A cylindrical cell $C$ is boundary smooth if the intersection with $C$ of every small open ball centred on the boundary of $C$ is connected
2. A $k$-dimensional cylindrical cell is well-bordered if $\fr{C}$ is the closure of some $k-1$-dimensional cylindrical cells.
3. A cylindrical cell $C$ is boundary coherent if $\fr{C}$ is a union of cells.
:::

::: {.definition #strong-about-c }
Let $\mathcal{D}$ be a CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$. $\mathcal{D}$ will be called strong about $C$ if $C$ is well-bordered, boundary coherent and every cell contained in $\cl(C)$ is boundary smooth.
:::

::: {.definition #graph-def-map }
Let $X \subset \R^n$ and $Y \subset \R^m$ be definable sets. 
Let $f : X \to Y$ be a mapping from $X$ to $Y$. The graph of $f$ is the definable set
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}.
$$
Sometimes, the domain of $f$ is $\R^n$. In this case, we often use the restriction $f\vert_X$ so that only images of $f$ at points in $X$ are considered,
The graph of $f$ on $X$ may be denoted by $f(X)$. 
:::

::: {.definition #definable-set}
:::

::: {.definition #definable-function}
A map $f : A \to R^m$, where $A \subset R^n$, is called *definable* if its graph $G \subset R^{n+m}$ is a definable set.
:::

::: {.definition #pfaff-format}
:::

::: {.definition #big-o }
[@gv2009, Definition 6.1]
Let $f,g,h : \N^\ell \to \N$ be functions and $n \in \N$.

- The expression $f \le O(g)^n$ means that there exists $c \in \N$ such that $f < (cg)^n$ at every point in $\N^\ell$.
- The expression $f \le g^{O(h)}$ means that there exists a $c \in \N$ such that $f \le g^{ch}$ at every point in $\N^\ell$.
:::

::: {.definition #blow-up-point }
:::

::: {.definition #frontier-condition}
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cell of $\cal D$. $C$ satisfies the frontier condition in $\cal D$ is $\fr{C}$ is a union of cells of $\cal D$ of smaller dimension. If it is unambiguous that $C$ is a cell of $\cal D$, then we just say that $C$ satisfies the frontier condition.
If every cell in $\cal D$ satisfies the frontier condition, then the cylindrical decomposition $\cal D$ satisfies the frontier condition.
:::

::: {.definition #analytic-submanifold}
:::

::: {.definition #pdo }
[@gv1995, Definition 2]
Let $f \in \Z[x_1,\ldots,x_n]$ be a polynomial and let $(m_1,\ldots,m_n) \subset \Z_{\ge 0}^n$ be a multi-index associated to one of its partial derivatives.
I.e., we write
$$
\partial f^{(m_1,\ldots,m_n)} =
\dfrac{\partial^{m_1} f}{\partial x_1} \cdots \dfrac{\partial^{m_n} f}{\partial x_n}.
$$
:::

::: {.definition #sub-cad}
:::

::: {.definition #graph-def-map }
Let $X \subset \R^n$ and $Y \subset \R^m$ be definable sets. 
Let $f : X \to Y$ be a mapping from $X$ to $Y$. The graph of $f$ is the definable set
$$
\{ (\mathbf{x},f(\mathbf{x})) \in \R^{n+m} \mid \mathbf{x} \in X \}.
$$
Sometimes, the domain of $f$ is $\R^n$. In this case, we often use the restriction $f\vert_X$ so that only images of $f$ at points in $X$ are considered,
The graph of $f$ on $X$ may be denoted by $f(X)$. 
:::

::: {.definition #definable-set}
A structure expanding the real closed field $R$ is a collection $$
S := (S^n)_{n \in \N}
$$
where each $S^n$ is a set of subsets of the affine space $R^n$ satisfying the following conditions.

1. All algebraic subsets of $R^n$ are in $S^n$.
2. $S^n$ is a Boolean subalgebra of the powerset of $R^n$.
3. If $A \in S^n$ and $B \in S^m$, then $A \times B \in S^{n+m}$.
4. Let $\proj : R^{n+1} \to R^n$ be the projection onto the first $n$ coordinates. If $X\in R^{n+1}$, then $\proj(X) \in R^n$.

Elements of $S^n$ (satisfying properties 1-4) are called the definable subsets of $R^n$.
If the structure $S$ satisfies properties 1-4 and the following property, it is called an O-minimal structure.


5. The elements of $S^1$ consist of the finite unions of points and open intervals of $R$.


:::

::: {.definition #definable-function}
A map $f : A \to R^m$, where $A \subset R^n$, is called *definable* if its graph $G \subset R^{n+m}$ is a definable set.
:::

::: {.definition #pfaff-format}
[@gv04, Definition 2.11]

Consider a semi-Pfaffian set
$$
X := \bigcup_{1 \le i \le M} \{ \mathbf{x} \in \R^s \mid f_{i,1} = 0, \ldots, f_{i,I_i} = 0, g_{i,1} > 0, \ldots, g_{i,J_i} > 0 \} \subset G
$$
where $f_{ij}$ and $g_{ij}$ are Pfaffian functions of order $r$ and degree $(\alpha, \beta)$ defined in an open domain $G$
The format of $X$ is a tuple
$$
(r, N, \alpha, \beta, s)
$$
where $N \ge (I_1 + J_1) + \cdots + (I_M + J_M)$.
:::

::: {.definition #big-o }
[@gv2009, Definition 6.1]
Let $f,g,h : \N^\ell \to \N$ be functions and $n \in \N$.

- The expression $f \le O(g)^n$ means that there exists $c \in \N$ such that $f < (cg)^n$ at every point in $\N^\ell$.
- The expression $f \le g^{O(h)}$ means that there exists a $c \in \N$ such that $f \le g^{ch}$ at every point in $\N^\ell$.
:::

::: {.definition #blow-up-point }
[@bgv15, Definition 9.2]

Let $\varphi : W \to \R$ be a continuous function on a semialgebraic set $W \subset \R^n$, and let $\Phi \subset \R^{n+1}$ be its graph.

A point $\mathbf{x} \in \overline{W} \setminus W$ is called a blow-up point of $\Phi$ if $$\proj^{-1}_{\R^n} (\mathbf{x}) \cap \overline{\Phi}$$ contains an open interval.
:::

::: {.definition #frontier-condition}
Let $\cal D$ be a cylindrical decomposition of $\R^n$ and $C$ be a cell of $\cal D$. $C$ satisfies the frontier condition in $\cal D$ is $\fr{C}$ is a union of cells of $\cal D$ of smaller dimension. If it is unambiguous that $C$ is a cell of $\cal D$, then we just say that $C$ satisfies the frontier condition.
If every cell in $\cal D$ satisfies the frontier condition, then the cylindrical decomposition $\cal D$ satisfies the frontier condition.
:::

::: {.definition #analytic-submanifold}
$S \subset \R^n$ such that $\dim(S) = k$ is an analytic submanifold if, for every point $\mathbf{x} \in S$, there is an analytic coordinate system about $\mathbf{x}$ with respect to which $S$ is locally the intersection of $n-k$ coordinate hyperplanes.
:::

::: {.definition #pdo }
[@gv1995, Definition 2]
Let $f \in \Z[x_1,\ldots,x_n]$ be a polynomial and let $(m_1,\ldots,m_n) \subset \Z_{\ge 0}^n$ be a multi-index associated to one of its partial derivatives.
I.e., we write
$$
\partial f^{(m_1,\ldots,m_n)} =
\dfrac{\partial^{m_1} f}{\partial x_1} \cdots \dfrac{\partial^{m_n} f}{\partial x_n}.
$$
:::

::: {.definition #sub-cad}
Let $\cal D$ be a CAD of $\R^n$ and suppose that $\mathbf{c} = (c_1,\ldots,c_k)$ is a $0$-dimensional section cell in the decomposition induced by $\cal D$ on $\R^k$.
By [@bgv15 Remark 3.8], the set of all cells of $\cal D$ contained in the affine coordinate subspace
$$
\{ x_1=c_1,\dots,x_k=c_k \}
$$
forms a cylindrical decomposition of $\R^{n-k}$. This decomposition will be called the *sub-decomposition* of $\cal D$ above $c$, and $\mathbf{c}$ the *base cell* of the sub-decomposition (or sub-CAD).
:::

::: {.definition #norm}
Let $K$ be a field and $L$ a finite (algebraic) extension of $K$.
The field $L$ can be thought of as a finite dimensional vector space over $K$.

Consider $f$ and $m$ be polynomials in $L[x_1,\ldots,x_n]$, viewed as polynomials in $K[x_1,\ldots,x_n,x_\alpha]$.
The norm, in $L[x_1,\ldots,x_n]$ of $f$ can be found by computing the resultant of $f$ and $m$.
:::

::: {.definition #laz-properties }
[@lazard10, Definition 2.7]

1. A cylindrical cell $C$ is boundary smooth if the intersection with $C$ of every small open ball centred on the boundary of $C$ is connected
2. A $k$-dimensional cylindrical cell is well-bordered if $\fr{C}$ is the closure of some $k-1$-dimensional cylindrical cells.
3. A cylindrical cell $C$ is boundary coherent if $\fr{C}$ is a union of cells.
:::

::: {.definition #strong-about-c }
Let $\mathcal{D}$ be a CAD of $\R^n$ and $C$ be a cell of $\mathcal{D}$. $\mathcal{D}$ will be called strong about $C$ if $C$ is well-bordered, boundary coherent and every cell contained in $\cl(C)$ is boundary smooth.
:::
